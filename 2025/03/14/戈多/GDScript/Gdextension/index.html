<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Gdextension | Hexo</title><meta name="author" content="John Doe"><meta name="copyright" content="John Doe"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="源码模板123456789101112131415161718192021222324#ifndef THREEN_H#define THREEN_H#include &lt;godot_cpp&#x2F;classes&#x2F;node.hpp&gt;&#x2F;&#x2F;#include &lt;godot_cpp&#x2F;core&#x2F;class_db.hpp&gt;#include &lt;godot_cpp&#x2F;variant&#x2F;utili">
<meta property="og:type" content="article">
<meta property="og:title" content="Gdextension">
<meta property="og:url" content="https://luojiangbao015.github.io/2025/03/14/%E6%88%88%E5%A4%9A/GDScript/Gdextension/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="源码模板123456789101112131415161718192021222324#ifndef THREEN_H#define THREEN_H#include &lt;godot_cpp&#x2F;classes&#x2F;node.hpp&gt;&#x2F;&#x2F;#include &lt;godot_cpp&#x2F;core&#x2F;class_db.hpp&gt;#include &lt;godot_cpp&#x2F;variant&#x2F;utili">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://luojiangbao015.github.io/img/ww/D003.png">
<meta property="article:published_time" content="2025-03-14T11:39:30.280Z">
<meta property="article:modified_time" content="2025-02-07T15:33:22.022Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="学习">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://luojiangbao015.github.io/img/ww/D003.png"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Gdextension",
  "url": "https://luojiangbao015.github.io/2025/03/14/%E6%88%88%E5%A4%9A/GDScript/Gdextension/",
  "image": "https://luojiangbao015.github.io/img/ww/D003.png",
  "datePublished": "2025-03-14T11:39:30.280Z",
  "dateModified": "2025-02-07T15:33:22.022Z",
  "author": [
    {
      "@type": "Person",
      "name": "John Doe",
      "url": "https://luojiangbao015.github.io/"
    }
  ]
}</script><link rel="shortcut icon" href="/auraea/img/favicon.png"><link rel="canonical" href="https://luojiangbao015.github.io/2025/03/14/%E6%88%88%E5%A4%9A/GDScript/Gdextension/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/auraea/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/auraea/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Gdextension',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(img/ww/D003.png);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/auraea/"><span class="site-name">Hexo</span></a><a class="nav-page-title" href="/auraea/"><span class="site-name">Gdextension</span></a></span><div id="menus"></div></nav><div id="post-info"><h1 class="post-title">Gdextension</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2025-03-14T11:39:30.280Z" title="Created 2025-03-14 19:39:30">2025-03-14</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-02-07T15:33:22.022Z" title="Updated 2025-02-07 23:33:22">2025-02-07</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/auraea/categories/godot/">godot</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="源码"><a href="#源码" class="headerlink" title="源码"></a>源码</h1><h2 id="模板"><a href="#模板" class="headerlink" title="模板"></a>模板</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> THREEN_H</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> THREEN_H</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;godot_cpp/classes/node.hpp&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">//#include &lt;godot_cpp/core/class_db.hpp&gt;</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;godot_cpp/variant/utility_functions.hpp&gt;</span>  <span class="comment">//输出字符串用</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> godot;</span><br><span class="line"></span><br><span class="line"><span class="comment">//#define VARIANT_ARG_MAX 8</span></span><br><span class="line"><span class="comment">//#define VARIANT_ARG_DECLARE const Variant &amp;p_arg1, const Variant &amp;p_arg2, const Variant &amp;p_arg3, const Variant &amp;p_arg4, const //Variant &amp;p_arg5, const Variant &amp;p_arg6, const Variant &amp;p_arg7, const Variant &amp;p_arg8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Myclass</span> : <span class="keyword">public</span> Node</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">GDCLASS</span>(Myclass, Node);</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">    <span class="type">static</span> <span class="type">void</span> _bind_methods();</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">GAME</span>();</span><br><span class="line">    ~<span class="built_in">GAME</span>();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span> <span class="comment">// THREEN_H</span></span></span><br></pre></td></tr></table></figure>

<h2 id="bind-methods"><a href="#bind-methods" class="headerlink" title="_bind_methods()"></a>_bind_methods()</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> Player::_bind_methods()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//注册方法</span></span><br><span class="line">    ClassDB::<span class="built_in">bind_method</span>(<span class="built_in">D_METHOD</span>(<span class="string">&quot;cout_property&quot;</span>), &amp;Player::cout_property);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//注册属性方法</span></span><br><span class="line">    ClassDB::<span class="built_in">bind_method</span>(<span class="built_in">D_METHOD</span>(<span class="string">&quot;set_array&quot;</span>, <span class="string">&quot;GBarray&quot;</span>), &amp;Player::set_array);</span><br><span class="line">    ClassDB::<span class="built_in">bind_method</span>(<span class="built_in">D_METHOD</span>(<span class="string">&quot;get_array&quot;</span>), &amp;Player::get_array);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//注册属性</span></span><br><span class="line">    <span class="built_in">ADD_PROPERTY</span>(<span class="built_in">PropertyInfo</span>(Variant::FLOAT, <span class="string">&quot;speed&quot;</span>, PROPERTY_HINT_RANGE<span class="string">&quot;    -99999,99999,0.001,or_less,or_greater,hide_slider,suffix:px&quot;</span>), <span class="string">&quot;set_speed&quot;</span>, <span class="string">&quot;get_speed&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//注册信号</span></span><br><span class="line">    <span class="built_in">ADD_SIGNAL</span>(<span class="built_in">MethodInfo</span>(<span class="string">&quot;palyer_sig&quot;</span>,<span class="built_in">PropertyInfo</span>(Variant::OBJECT, <span class="string">&quot;key1&quot;</span>),  <span class="built_in">PropertyInfo</span>(Variant::OBJECT, <span class="string">&quot;key2&quot;</span>)));</span><br><span class="line"></span><br><span class="line">    <span class="comment">//注册枚举</span></span><br><span class="line">    <span class="built_in">BIND_ENUM_CONSTANT</span>(MON);</span><br><span class="line">    <span class="comment">//注册flag</span></span><br><span class="line">    <span class="built_in">BIND_BITFIELD_FLAG</span>(Run);</span><br><span class="line">    <span class="comment">//注册常量</span></span><br><span class="line">    <span class="built_in">BIND_CONSTANT</span>(MAX_HEALTH);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="注册属性"><a href="#注册属性" class="headerlink" title="注册属性"></a>注册属性</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">bool</span> br = <span class="literal">true</span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">set_br</span><span class="params">(<span class="type">bool</span> key)</span></span>;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">get_br</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">bool</span> <span class="title">AbilitySystem::get_br</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> br;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">AbilitySystem::set_br</span><span class="params">(<span class="type">bool</span> key)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	br = key;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> AbilitySystem::_bind_methods()</span><br><span class="line">&#123;</span><br><span class="line">	ClassDB::<span class="built_in">bind_method</span>(<span class="built_in">D_METHOD</span>(<span class="string">&quot;set_br&quot;</span>,<span class="string">&quot;br&quot;</span>), &amp;AbilitySystem::set_br);</span><br><span class="line">	ClassDB::<span class="built_in">bind_method</span>(<span class="built_in">D_METHOD</span>(<span class="string">&quot;get_br&quot;</span>), &amp;AbilitySystem::get_br);</span><br><span class="line"></span><br><span class="line">	ClassDB::<span class="built_in">add_property</span>(<span class="string">&quot;AbilitySystem&quot;</span>,</span><br><span class="line">		<span class="built_in">PropertyInfo</span>(Variant::BOOL, <span class="string">&quot;br&quot;</span>),</span><br><span class="line">		<span class="string">&quot;set_br&quot;</span>,</span><br><span class="line">		<span class="string">&quot;get_br&quot;</span></span><br><span class="line">	);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="声明-枚举-Flag-常量"><a href="#声明-枚举-Flag-常量" class="headerlink" title="声明:枚举,Flag,常量"></a>声明:枚举,Flag,常量</h2><ul>
<li>枚举</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> <span class="title class_">testEnum</span> &#123;</span><br><span class="line">MON,</span><br><span class="line">TUE,</span><br><span class="line">WED = <span class="number">7</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//底下</span></span><br><span class="line">    <span class="built_in">VARIANT_ENUM_CAST</span>(Test::testEnum);</span><br></pre></td></tr></table></figure>

<ul>
<li>flag</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> <span class="title class_">testFlag</span> </span><br><span class="line">&#123;</span><br><span class="line">Run,</span><br><span class="line">Idle</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//低下</span></span><br><span class="line"><span class="built_in">VARIANT_BITFIELD_CAST</span>(Test::testFlag);</span><br></pre></td></tr></table></figure>

<ul>
<li>常量</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//常量声明</span></span><br><span class="line"><span class="keyword">enum</span> &#123;</span><br><span class="line">MAX_HEALTH = <span class="number">100</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="信号"><a href="#信号" class="headerlink" title="信号"></a>信号</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//发送</span></span><br><span class="line"><span class="built_in">emit_signal</span>(<span class="string">&quot;position_changed&quot;</span>, <span class="keyword">this</span>, new_position);</span><br><span class="line"><span class="comment">//接受信号</span></span><br><span class="line"><span class="built_in">connect</span>(<span class="string">&quot;visibility_changed&quot;</span>, <span class="built_in">Callable</span>(<span class="keyword">this</span>, <span class="string">&quot;cout_sig&quot;</span>));</span><br></pre></td></tr></table></figure>

<h2 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h2><ul>
<li>普通数组</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Array _array;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">set_array</span><span class="params">(Array p_array)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    _array=p_array;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">Array <span class="title">get_array</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> _array;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>特定数组</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">PackedVector2Array polygon;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">set_polygon</span><span class="params">(<span class="type">const</span> PackedVector2Array&amp; p_polygon)</span> </span>&#123;</span><br><span class="line">    polygon = p_polygon;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">PackedVector2Array <span class="title">get_polygon</span><span class="params">()</span> <span class="type">const</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> polygon;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//注册</span></span><br><span class="line">    ClassDB::<span class="built_in">bind_method</span>(<span class="built_in">D_METHOD</span>(<span class="string">&quot;set_polygon&quot;</span>, <span class="string">&quot;polygon&quot;</span>), &amp;Player::set_polygon);</span><br><span class="line">    ClassDB::<span class="built_in">bind_method</span>(<span class="built_in">D_METHOD</span>(<span class="string">&quot;get_polygon&quot;</span>), &amp;Player::get_polygon);</span><br><span class="line">    <span class="built_in">ADD_PROPERTY</span>(<span class="built_in">PropertyInfo</span>(Variant::PACKED_VECTOR2_ARRAY, <span class="string">&quot;polygon&quot;</span>), <span class="string">&quot;set_polygon&quot;</span>, <span class="string">&quot;get_polygon&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>GDVIRTUAL_BIND(_process, “delta”);</p>
<h2 id="实例对象"><a href="#实例对象" class="headerlink" title="实例对象"></a>实例对象</h2><ul>
<li>注意:在实例化GODOT对象时应该使用memnew来实例化,不应该用new,因为GODOT没法释放new可能导致内存泄漏</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Node node=<span class="built_in">memnew</span>(Node);</span><br></pre></td></tr></table></figure>

<h2 id="调用单例"><a href="#调用单例" class="headerlink" title="调用单例"></a>调用单例</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Input单例     需要包含头文件</span></span><br><span class="line">Input::<span class="built_in">get_singleton</span>()-&gt;<span class="built_in">get_vector</span>(<span class="string">&quot;ui_left&quot;</span>, <span class="string">&quot;ui_right&quot;</span>, <span class="string">&quot;ui_up&quot;</span>, <span class="string">&quot;ui_down&quot;</span>);</span><br></pre></td></tr></table></figure>

<h2 id="重写虚函数"><a href="#重写虚函数" class="headerlink" title="重写虚函数"></a>重写虚函数</h2><ul>
<li>虚函数声明</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//开始时调用</span></span><br><span class="line"><span class="type">void</span> _ready();</span><br><span class="line"><span class="type">void</span> Player::_ready()</span><br><span class="line">&#123;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//物理帧循环</span></span><br><span class="line"><span class="type">void</span> _physics_process(<span class="type">float</span> delta);</span><br><span class="line"><span class="type">void</span> Player::_physics_process(<span class="type">float</span> delta)</span><br><span class="line">&#123;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//检测输入</span></span><br><span class="line"><span class="type">void</span> _input(<span class="type">const</span> Ref&lt;InputEvent&gt;&amp; event);  <span class="comment">//需要头文件 #include &lt;godot_cpp/classes/input_event.hpp&gt;</span></span><br><span class="line"><span class="type">void</span> Player::_input(<span class="type">const</span> Ref&lt;InputEvent&gt;&amp; event)</span><br><span class="line">&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>node虚函数源码</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">virtual</span> <span class="type">void</span> _process(<span class="type">double</span> delta);</span><br><span class="line"><span class="keyword">virtual</span> <span class="type">void</span> _physics_process(<span class="type">double</span> delta);</span><br><span class="line"><span class="keyword">virtual</span> <span class="type">void</span> _enter_tree();</span><br><span class="line"><span class="keyword">virtual</span> <span class="type">void</span> _exit_tree();</span><br><span class="line"><span class="keyword">virtual</span> <span class="type">void</span> _ready();</span><br><span class="line"><span class="keyword">virtual</span> PackedStringArray _get_configuration_warnings() <span class="type">const</span>;</span><br><span class="line"><span class="keyword">virtual</span> <span class="type">void</span> _input(<span class="type">const</span> Ref&lt;InputEvent&gt; &amp;event);</span><br><span class="line"><span class="keyword">virtual</span> <span class="type">void</span> _shortcut_input(<span class="type">const</span> Ref&lt;InputEvent&gt; &amp;event);</span><br><span class="line"><span class="keyword">virtual</span> <span class="type">void</span> _unhandled_input(<span class="type">const</span> Ref&lt;InputEvent&gt; &amp;event);</span><br><span class="line"><span class="keyword">virtual</span> <span class="type">void</span> _unhandled_key_input(<span class="type">const</span> Ref&lt;InputEvent&gt; &amp;event);</span><br></pre></td></tr></table></figure>

<h2 id="ADD-PROPERTY的用法"><a href="#ADD-PROPERTY的用法" class="headerlink" title="ADD_PROPERTY的用法"></a>ADD_PROPERTY的用法</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//检查器仅显示特定资源</span></span><br><span class="line"><span class="built_in">ADD_PROPERTY</span>(<span class="built_in">PropertyInfo</span>(Variant::OBJECT, <span class="string">&quot;_resource&quot;</span>,PROPERTY_HINT_RESOURCE_TYPE, <span class="string">&quot;ReleStats&quot;</span>), <span class="string">&quot;set_resource&quot;</span>, <span class="string">&quot;get_resource&quot;</span>);</span><br></pre></td></tr></table></figure>

<h4 id="enum-PropertyHint"><a href="#enum-PropertyHint" class="headerlink" title="enum PropertyHint"></a>enum PropertyHint</h4><ol>
<li><strong>PROPERTY_HINT_NONE</strong>：没有特定的提示。</li>
<li><strong>PROPERTY_HINT_RANGE</strong>：表示属性是一个范围值（例如，一个滑动条）。</li>
<li><strong>PROPERTY_HINT_ENUM</strong>：表示属性是一个枚举类型，可以从预定义的值中选择。</li>
<li><strong>PROPERTY_HINT_ENUM_SUGGESTION</strong>：与 <code>PROPERTY_HINT_ENUM</code> 类似，但可能提供建议的值。</li>
<li><strong>PROPERTY_HINT_EXP_EASING</strong>：可能与动画的缓动（easing）相关，特别是指数缓动。</li>
<li><strong>PROPERTY_HINT_LINK</strong>：表示属性可以链接到另一个属性或资源。</li>
<li><strong>PROPERTY_HINT_FLAGS</strong>：表示属性是一个标志位集合。</li>
<li><strong>PROPERTY_HINT_LAYERS_</strong>（如 <code>PROPERTY_HINT_LAYERS_2D_RENDER</code>）：与图层相关的提示，用于 2D 或 3D 渲染、物理或导航。</li>
<li><strong>PROPERTY_HINT_FILE</strong>：提示用户选择文件。</li>
<li><strong>PROPERTY_HINT_DIR</strong>：提示用户选择目录。</li>
<li><strong>PROPERTY_HINT_GLOBAL_FILE&#x2F;DIR</strong>：与 <code>PROPERTY_HINT_FILE/DIR</code> 类似，但可能指向全局路径或资源。</li>
<li><strong>PROPERTY_HINT_RESOURCE_TYPE</strong>：提示用户选择特定类型的资源。</li>
<li><strong>PROPERTY_HINT_MULTILINE_TEXT</strong>：表示属性是一个多行文本字段。</li>
<li><strong>PROPERTY_HINT_EXPRESSION</strong>：可能与表达式求值或编写表达式相关。</li>
<li><strong>PROPERTY_HINT_PLACEHOLDER_TEXT</strong>：在文本字段中显示占位符文本。</li>
<li><strong>PROPERTY_HINT_COLOR_NO_ALPHA</strong>：颜色选择器不显示 alpha 通道。</li>
<li><strong>PROPERTY_HINT_OBJECT_ID</strong>：表示属性是一个对象 ID。</li>
<li><strong>PROPERTY_HINT_TYPE_STRING</strong>：属性是一个表示类型的字符串。</li>
<li><strong>PROPERTY_HINT_NODE_PATH_TO_EDITED_NODE</strong>：表示属性是一个节点路径，指向正在编辑的节点。</li>
<li><strong>PROPERTY_HINT_OBJECT_TOO_BIG</strong>：可能用于警告用户对象太大或复杂。</li>
<li><strong>PROPERTY_HINT_NODE_PATH_VALID_TYPES</strong>：提示用户选择特定类型的节点路径。</li>
<li><strong>PROPERTY_HINT_SAVE_FILE&#x2F;GLOBAL_SAVE_FILE</strong>：提示用户保存文件，可能是全局的。</li>
<li><strong>PROPERTY_HINT_INT_IS_OBJECTID&#x2F;POINTER</strong>：整数属性实际上是对象 ID 或指针。</li>
<li><strong>PROPERTY_HINT_ARRAY_TYPE</strong>：提示用户选择数组的元素类型。</li>
<li><strong>PROPERTY_HINT_LOCALE_ID</strong>：表示属性是区域设置（locale）ID。</li>
<li><strong>PROPERTY_HINT_LOCALIZABLE_STRING</strong>：表示属性是一个可以本地化的字符串。</li>
<li><strong>PROPERTY_HINT_NODE_TYPE</strong>：提示用户选择特定类型的节点。</li>
<li><strong>PROPERTY_HINT_HIDE_QUATERNION_EDIT</strong>：在编辑器中隐藏四元数编辑（可能是笔误，应为“quaternion”）。</li>
<li><strong>PROPERTY_HINT_PASSWORD</strong>：属性是一个密码字段，应该隐藏输入。</li>
<li><strong>PROPERTY_HINT_MAX</strong>：枚举中的最大值，通常用于范围检查。</li>
</ol>
<p>这些提示为编辑器和开发者提供了关于如何解释和编辑属性的上下文信息，从而提高了工作效率和用户体验。</p>
<h4 id="enum-Type"><a href="#enum-Type" class="headerlink" title="enum Type"></a>enum Type</h4><ol>
<li><strong>NIL</strong>：表示无或空值。</li>
<li><strong>原子类型 (atomic types)</strong>：<ul>
<li><strong>BOOL</strong>：布尔值（真&#x2F;假）。</li>
<li><strong>INT</strong>：整数。</li>
<li><strong>FLOAT</strong>：浮点数。</li>
<li><strong>STRING</strong>：字符串。</li>
</ul>
</li>
<li><strong>数学类型 (math types)</strong>：<ul>
<li><strong>VECTOR2, VECTOR2I</strong>：二维向量，前者为浮点数，后者为整数。</li>
<li><strong>RECT2, RECT2I</strong>：二维矩形，同样有浮点数和整数版本。</li>
<li><strong>VECTOR3, VECTOR3I</strong>：三维向量，浮点数和整数版本。</li>
<li><strong>TRANSFORM2D</strong>：二维变换矩阵。</li>
<li><strong>VECTOR4, VECTOR4I</strong>：四维向量，浮点数和整数版本。</li>
<li><strong>PLANE</strong>：平面（在数学中通常表示为点法式）。</li>
<li><strong>QUATERNION</strong>：四元数，用于表示3D旋转。</li>
<li><strong>AABB</strong>：Axis-Aligned Bounding Box，轴对齐包围盒，常用于碰撞检测。</li>
<li><strong>BASIS</strong>：基础矩阵，通常用于3D变换。</li>
<li><strong>TRANSFORM3D</strong>：三维变换矩阵。</li>
<li><strong>PROJECTION</strong>：投影矩阵，可能用于图形渲染。</li>
</ul>
</li>
<li><strong>其他类型 (misc types)</strong>：<ul>
<li><strong>COLOR</strong>：颜色值。</li>
<li><strong>STRING_NAME</strong>：字符串名称，可能是优化后的字符串类型，用于快速比较和哈希。</li>
<li><strong>NODE_PATH</strong>：节点路径，在场景图中定位节点。</li>
<li><strong>RID</strong>：Resource ID，资源标识符，用于标识资源。</li>
<li><strong>OBJECT</strong>：对象引用。</li>
<li><strong>CALLABLE</strong>：可调用的函数、方法或信号。</li>
<li><strong>SIGNAL</strong>：信号，用于在对象之间通信。</li>
<li><strong>DICTIONARY</strong>：字典或映射，存储键值对。</li>
<li><strong>ARRAY</strong>：数组，可以存储任何类型的元素。</li>
</ul>
</li>
<li><strong>类型化数组 (typed arrays)</strong>：<ul>
<li>这些是固定类型的数组，存储特定类型的元素，如字节、整数、浮点数、向量等。它们可能用于优化性能或内存使用。</li>
</ul>
</li>
<li><strong>VARIANT_MAX</strong>：枚举中的最大值，通常用于范围检查或其他需要枚举最大值的情况。</li>
</ol>
<h1 id="Scons"><a href="#Scons" class="headerlink" title="Scons"></a>Scons</h1><h2 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"></span><br><span class="line">libname = <span class="string">&quot;libmyts&quot;</span></span><br><span class="line"></span><br><span class="line">env = SConscript(<span class="string">&quot;godot-cpp/SConstruct&quot;</span>)</span><br><span class="line"></span><br><span class="line">env.Append(CPPPATH=[<span class="string">&quot;src/&quot;</span>,<span class="string">&quot;src/store/&quot;</span>,<span class="string">&quot;src/player/&quot;</span>])  <span class="comment">#指定头文件位置</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sources = Glob(<span class="string">&quot;#src/*.cpp&quot;</span>)  <span class="comment"># 匹配源文件位置</span></span><br><span class="line">sources+=Glob(<span class="string">&quot;#src/store/*.cpp&quot;</span>)</span><br><span class="line">sources+=Glob(<span class="string">&quot;#src/player/*.cpp&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> editor_builders</span><br><span class="line"></span><br><span class="line">docs_xml = []  <span class="comment">#声明一个之</span></span><br><span class="line">docs_xml += Glob(<span class="string">&quot;#src/doc_classes/*.xml&quot;</span>)  <span class="comment">#将右边的值加到左边的值</span></span><br><span class="line">docs_xml = <span class="built_in">sorted</span>(docs_xml)  <span class="comment">#排序</span></span><br><span class="line">docs_header = <span class="string">&quot;#src/doc_data_&#123;&#125;.gen.h&quot;</span>.<span class="built_in">format</span>(libname)  <span class="comment">#名字</span></span><br><span class="line">env.Command(docs_header, docs_xml, env.Action(editor_builders.make_doc_header, <span class="string">&quot;Generating documentation header.&quot;</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> env[<span class="string">&#x27;platform&#x27;</span>] == <span class="string">&#x27;linux&#x27;</span>: </span><br><span class="line">    <span class="keyword">pass</span> </span><br><span class="line"><span class="keyword">elif</span> env[<span class="string">&#x27;platform&#x27;</span>] == <span class="string">&#x27;windows&#x27;</span>:</span><br><span class="line">    libpath = <span class="string">&quot;F:/AGodot/GDE/godotGED4.3/bin/libtest&#123;&#125;&#123;&#125;&quot;</span>.<span class="built_in">format</span>(env[<span class="string">&quot;suffix&quot;</span>], env[<span class="string">&quot;SHLIBSUFFIX&quot;</span>]) <span class="comment">#文件名及生成路径</span></span><br><span class="line">    sharedlib = env.SharedLibrary(libpath,sources)      <span class="comment">#生成动态库(文件名,构建的cpp路径)</span></span><br><span class="line"><span class="comment">#env.Depends(sharedlib,docs_header)       #依赖                                    </span></span><br><span class="line">Default(sharedlib)        <span class="comment">#构建文件</span></span><br></pre></td></tr></table></figure>

<h1 id="Gdextension"><a href="#Gdextension" class="headerlink" title="Gdextension"></a>Gdextension</h1><h2 id="配置文件-1"><a href="#配置文件-1" class="headerlink" title="配置文件"></a>配置文件</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[configuration]</span><br><span class="line"></span><br><span class="line">entry_symbol = <span class="string">&quot;myts_library_init&quot;</span></span><br><span class="line">compatibility_minimum = <span class="number">4.1</span></span><br><span class="line"></span><br><span class="line">[libraries]</span><br><span class="line"></span><br><span class="line">[icons]</span><br><span class="line">GDExample = <span class="string">&quot;res://icons/gd_example.svg&quot;</span></span><br><span class="line"></span><br><span class="line">windows.x86_64.debug = <span class="string">&quot;res://bin/libtest.windows.template_debug.x86_64.dll&quot;</span></span><br></pre></td></tr></table></figure>

<h1 id="实现源码"><a href="#实现源码" class="headerlink" title="实现源码"></a>实现源码</h1><h2 id="2D"><a href="#2D" class="headerlink" title="2D"></a>2D</h2><h3 id="基础移动"><a href="#基础移动" class="headerlink" title="基础移动"></a>基础移动</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">Player::move_role</span><span class="params">(<span class="type">float</span> delta)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">    Vector2 direction = Input::<span class="built_in">get_singleton</span>()-&gt;<span class="built_in">get_vector</span>(<span class="string">&quot;ui_left&quot;</span>, <span class="string">&quot;ui_right&quot;</span>, <span class="string">&quot;ui_up&quot;</span>, <span class="string">&quot;ui_down&quot;</span>);</span><br><span class="line">    Vector2 velovty = <span class="built_in">get_velocity</span>();</span><br><span class="line">    <span class="keyword">if</span> (direction != <span class="built_in">Vector2</span>(<span class="number">0</span>,<span class="number">0</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        velovty = direction * speed;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        velovty=velovty.<span class="built_in">move_toward</span>(<span class="built_in">Vector2</span>(<span class="number">0</span>, <span class="number">0</span>), speed);</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="built_in">set_velocity</span>(velovty);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="怪物追踪玩家"><a href="#怪物追踪玩家" class="headerlink" title="怪物追踪玩家"></a>怪物追踪玩家</h3><ul>
<li>怪物移动向量&#x3D;(玩家位置-怪物全局位置)*速度</li>
<li>怪物位置&#x3D;怪物移动向量</li>
</ul>
<h3 id="暴击公式"><a href="#暴击公式" class="headerlink" title="暴击公式"></a>暴击公式</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">暴击随机率=<span class="number">100</span>-暴击面板</span><br><span class="line">var 暴击率=randi_range(暴击随机率,<span class="number">0</span>)</span><br><span class="line"><span class="keyword">if</span> 暴击率==<span class="number">0</span>:</span><br><span class="line">    //暴击伤害加成</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    暴击伤害为<span class="number">1</span></span><br></pre></td></tr></table></figure>

<h2 id="3D"><a href="#3D" class="headerlink" title="3D"></a>3D</h2><h3 id="基础移动-1"><a href="#基础移动-1" class="headerlink" title="基础移动"></a>基础移动</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//暂时没有</span></span><br></pre></td></tr></table></figure>

<h2 id="单例"><a href="#单例" class="headerlink" title="单例"></a>单例</h2><h3 id="存储系统"><a href="#存储系统" class="headerlink" title="存储系统"></a>存储系统</h3><ul>
<li>头文件</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//返回单例</span></span><br><span class="line"><span class="function"><span class="type">static</span> Store* <span class="title">Store_static</span><span class="params">()</span></span>;</span><br><span class="line"><span class="comment">//数据写入</span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">store_write</span><span class="params">(Variant content,String path)</span></span>;</span><br><span class="line"><span class="comment">//数据读取</span></span><br><span class="line"><span class="function">Variant <span class="title">store_read</span><span class="params">(String path)</span></span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>源文件</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Store* <span class="title">Store::Store_static</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">static</span> Store store;</span><br><span class="line">    <span class="keyword">return</span> &amp;store;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">Store::store_write</span><span class="params">(Variant content, String path)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Ref&lt;FileAccess&gt; write = FileAccess::<span class="built_in">open</span>(path,FileAccess::WRITE);</span><br><span class="line">    write-&gt;<span class="built_in">store_string</span>(content);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function">Variant <span class="title">Store::store_read</span><span class="params">(String path)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Ref&lt;FileAccess&gt; read = FileAccess::<span class="built_in">open</span>(path, FileAccess::READ);</span><br><span class="line">    Variant variant=read-&gt;<span class="built_in">get_as_text</span>();</span><br><span class="line">    Variant js = JSON::<span class="built_in">parse_string</span>(variant);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> js;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="GUI"><a href="#GUI" class="headerlink" title="GUI"></a>GUI</h2><h3 id="按钮"><a href="#按钮" class="headerlink" title="按钮"></a>按钮</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//暂时没有</span></span><br></pre></td></tr></table></figure>

<h2 id="插件"><a href="#插件" class="headerlink" title="插件"></a>插件</h2><h3 id="背包"><a href="#背包" class="headerlink" title="背包"></a>背包</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//暂时没有</span></span><br></pre></td></tr></table></figure>

<h1 id="设计模式"><a href="#设计模式" class="headerlink" title="设计模式"></a>设计模式</h1><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><ul>
<li><a target="_blank" rel="noopener" href="https://gpp.tkchu.me/">游戏编程模式电子书</a></li>
</ul>
<table>
<thead>
<tr>
<th>模式</th>
<th>详情</th>
<th>模式</th>
<th>详情</th>
</tr>
</thead>
<tbody><tr>
<td>命令模式</td>
<td>通过命令控制对象行为,需要的话可以记录状态并实现撤回</td>
<td>更新方法模式</td>
<td>对每个对象单独调用更新函数</td>
</tr>
<tr>
<td>享元模式</td>
<td>多个对象共用同一个资源或者属性</td>
<td>游戏循环模式</td>
<td>游戏循环底层</td>
</tr>
<tr>
<td>状态模式</td>
<td>通过变量切换对象的不同状态</td>
<td>双缓冲模式</td>
<td>绘制相关，当A在执行是B在准备，B在执行时A在准备</td>
</tr>
<tr>
<td>单例模式</td>
<td>静态方法,全局变量,可以全局访问的属性和方法</td>
<td>字节码模式</td>
<td>自定义编程语言?</td>
</tr>
<tr>
<td>原型模式</td>
<td>复制当前对象生成新的对象,(泛型,模板)。<br />类似场景文件，预制体的实现</td>
<td>事件队列</td>
<td>将事件加入队列,等待执行处理,类似观察者模式,多出缓存区域</td>
</tr>
<tr>
<td>观察者模式</td>
<td>主题对象向所有观察者对象发送信号，在godot中可通过信号实现</td>
<td>服务器定位器</td>
<td>类似单例</td>
</tr>
<tr>
<td>子类沙箱模式</td>
<td>将子对象重复的方法写在基类,避免高耦合度</td>
<td></td>
<td></td>
</tr>
<tr>
<td>类型对象</td>
<td>对象可通过外部配置文件修改产生新的对象，如表格和json等</td>
<td></td>
<td></td>
</tr>
<tr>
<td>组件模式</td>
<td>对对象添加组件进行使用，挂脚本就是一种组件模式</td>
<td></td>
<td></td>
</tr>
</tbody></table>
<h2 id="命令模式"><a href="#命令模式" class="headerlink" title="命令模式"></a>命令模式</h2><p>在游戏编程中，命令模式（Command Pattern）是一种常见的设计模式，它允许将请求封装为对象，从而实现请求的排队、记录、撤销&#x2F;重做以及将请求的执行者与请求本身解耦。这对于游戏开发中的多种场景，如用户界面交互、游戏逻辑执行、AI行为模拟等，都是非常有用的。</p>
<h3 id="命令模式的基本结构"><a href="#命令模式的基本结构" class="headerlink" title="命令模式的基本结构"></a>命令模式的基本结构</h3><ol>
<li><strong>命令接口（Command）</strong>：定义一个命令的接口，声明执行的方法。</li>
<li><strong>具体命令（ConcreteCommand）</strong>：实现命令接口，并关联一个接收者对象。调用接收者对象的相应操作以执行请求。</li>
<li><strong>接收者（Receiver）</strong>：知道如何执行与请求相关的操作。任何类都可能作为一个接收者。</li>
<li><strong>调用者（Invoker）</strong>：要求命令执行一个请求。它包含一个或多个命令对象，并调用命令对象的执行方法。</li>
<li><strong>客户端（Client）</strong>：创建具体的命令对象，并设置它的接收者。</li>
</ol>
<h3 id="游戏编程中的命令模式示例"><a href="#游戏编程中的命令模式示例" class="headerlink" title="游戏编程中的命令模式示例"></a>游戏编程中的命令模式示例</h3><ul>
<li><p>将需要执行的对象具体行为通过命令对象来调用</p>
</li>
<li><p>当按下1键玩家的名字改为小海,按下2键又变为小月</p>
</li>
</ul>
<ol>
<li><strong>接收者（Receiver）</strong>：</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> 玩家</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    玩家() &#123;&#125;;</span><br><span class="line">    ~玩家() &#123;&#125;;</span><br><span class="line"></span><br><span class="line">    string name&#123;<span class="string">&quot;小月&quot;</span>&#125;;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line"></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li><strong>命令接口（Command）</strong>：</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//命令接口</span></span><br><span class="line"><span class="keyword">class</span> 抽象命令</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">virtual</span> <span class="type">void</span> 执行(string string)=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">virtual</span> <span class="type">void</span> 撤销()=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line"></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>2.<br>3. <strong>具体命令（ConcreteCommand）</strong>：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//实现命令对象</span></span><br><span class="line"><span class="keyword">class</span> 命令 :<span class="keyword">public</span> 抽象命令</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    玩家* 玩家指针;    <span class="comment">//指向玩家实例</span></span><br><span class="line">    string name;     <span class="comment">//记录玩家属性</span></span><br><span class="line"></span><br><span class="line">    命令(玩家&amp;p_玩家):玩家指针(&amp;p_玩家) &#123;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="type">void</span> 执行(string p_name)</span><br><span class="line">    &#123;</span><br><span class="line">        name = 玩家指针-&gt;name;    <span class="comment">//记录玩家属性</span></span><br><span class="line">        玩家指针-&gt;name = p_name;   <span class="comment">//指向玩家行为,通过字符串更改name属性</span></span><br><span class="line">        cout &lt;&lt; 玩家指针-&gt;name &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">void</span> 撤销()</span><br><span class="line">    &#123;</span><br><span class="line">        玩家指针-&gt;name = name;     <span class="comment">//撤销玩家属性,将name属性更改为上一步记录的值</span></span><br><span class="line">        cout &lt;&lt; 玩家指针-&gt;name &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    玩家 玩家实例;</span><br><span class="line">    命令 命令实例(玩家实例);  <span class="comment">//初始化,引用玩家对象</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> op;</span><br><span class="line">        cin &gt;&gt; op;</span><br><span class="line">        <span class="keyword">if</span> (op == <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            命令实例.执行(<span class="string">&quot;小海&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (op == <span class="number">2</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            命令实例.撤销();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="5">
<li><strong>调用者（Invoker）</strong>：</li>
</ol>
<p>调用者可以是游戏的主循环、UI管理器或AI系统等。在这个示例中，我们可以假设有一个UI管理器，它负责处理玩家的点击事件。</p>
<ol start="6">
<li><strong>客户端（Client）</strong>：</li>
</ol>
<p>客户端通常是游戏的初始化代码或配置部分。在这里，我们创建具体的命令对象，并将其与接收者关联起来。然后，我们将命令对象传递给调用者（如UI管理器）。</p>
<h3 id="命令模式的优点"><a href="#命令模式的优点" class="headerlink" title="命令模式的优点"></a>命令模式的优点</h3><ul>
<li><strong>解耦</strong>：命令模式将请求的执行者与请求本身解耦，使得请求的发送者和接收者可以独立地变化。</li>
<li><strong>可扩展性</strong>：新的命令可以很容易地添加到系统中，而无需修改现有的类。</li>
<li><strong>可撤销&#x2F;重做</strong>：通过实现<code>undo()</code>等方法，可以很容易地支持命令的撤销和重做功能。</li>
<li><strong>队列和日志</strong>：命令对象可以存储在队列中以实现命令的批量执行或延迟执行，也可以存储在日志中以记录游戏的历史状态。</li>
</ul>
<h3 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h3><ul>
<li>命令模式可能会增加系统的复杂性和开销，因此应谨慎使用。在简单场景中，可能不需要使用命令模式。</li>
<li>在实现命令模式时，要确保正确地管理命令对象的生命周期，以避免内存泄漏等问题。</li>
</ul>
<h3 id="享元模式"><a href="#享元模式" class="headerlink" title="享元模式"></a>享元模式</h3><p>在游戏编程中，享元模式（Flyweight Pattern）是一种用于优化性能的设计模式，它通过共享来避免大量拥有相同内容对象的开销。在游戏开发中，这种模式特别适用于那些需要创建大量相似对象的情况，如玩家角色、怪物、道具等。</p>
<p>享元模式的核心思想是将对象的内部状态（即不随环境改变而改变的属性）和外部状态（即随环境改变而改变的属性）进行区分。通过共享内部状态，可以显著减少对象的数量，从而降低内存消耗和提高性能。</p>
<p>在游戏编程中，享元模式的应用场景可能包括：</p>
<ol>
<li><strong>角色创建</strong>：在大型多人在线游戏（MMO）中，可能存在大量的玩家角色。这些角色可能有很多相同的属性（如种族、职业、等级等），而装备、技能、位置等属性则各不相同。通过享元模式，可以将这些共享的属性存储在一个享元对象中，并为每个角色分配一个包含其特有属性的实例。</li>
<li><strong>怪物生成</strong>：在游戏中，可能需要生成大量的怪物。这些怪物可能具有相同的外观、属性和行为，但位置、状态等属性可能各不相同。通过享元模式，可以共享怪物的内部状态，从而减少内存消耗。</li>
<li><strong>道具管理</strong>：在游戏中，可能存在大量的道具，这些道具可能具有相同的属性（如名称、类型、功能等），但数量、位置等属性可能各不相同。通过享元模式，可以共享道具的内部状态，从而优化内存使用。</li>
</ol>
<p>在实现享元模式时，通常需要定义两个主要类：</p>
<ol>
<li><strong>享元类（Flyweight）</strong>：用于存储对象的内部状态。这个类通常具有一个静态的工厂方法或工厂类来管理享元对象的创建和共享。</li>
<li><strong>上下文类（Context）</strong>：用于存储对象的外部状态。这个类持有享元对象的引用，并提供操作这些对象的方法。当需要操作对象时，上下文类会将享元对象与其外部状态结合起来。</li>
</ol>
<p>需要注意的是，享元模式虽然可以显著优化性能，但也可能增加系统的复杂性。因此，在使用享元模式时，需要权衡其优点和缺点，并根据具体需求进行选择和调整。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;list&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unordered_map&gt;</span>  </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;memory&gt;</span>  </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="comment">// 享元接口  </span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MonsterFlyweight</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">virtual</span> ~<span class="built_in">MonsterFlyweight</span>() = <span class="keyword">default</span>;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">attack</span><span class="params">()</span> <span class="type">const</span> </span>= <span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">setLocation</span><span class="params">(<span class="type">const</span> std::string&amp; location)</span> </span>= <span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="type">const</span> std::string&amp; <span class="title">getLocation</span><span class="params">()</span> <span class="type">const</span> </span>= <span class="number">0</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 具体的享元类  </span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Monster</span> : <span class="keyword">public</span> MonsterFlyweight &#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    std::string monsterType;</span><br><span class="line">    <span class="type">int</span> attackPower;</span><br><span class="line">    std::string location; <span class="comment">// 外部状态通常不应在享元类中直接存储，但为简单起见，这里这样做  </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">Monster</span>(<span class="type">const</span> std::string&amp; monsterType, <span class="type">int</span> attackPower)</span><br><span class="line">        : <span class="built_in">monsterType</span>(monsterType), <span class="built_in">attackPower</span>(attackPower) &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">attack</span><span class="params">()</span> <span class="type">const</span> <span class="keyword">override</span> </span>&#123;</span><br><span class="line">        std::cout &lt;&lt; monsterType &lt;&lt; <span class="string">&quot; monster attacks with power &quot;</span> &lt;&lt; attackPower &lt;&lt; std::endl;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">setLocation</span><span class="params">(<span class="type">const</span> std::string&amp; location)</span> <span class="keyword">override</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>-&gt;location = location;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">const</span> std::string&amp; <span class="title">getLocation</span><span class="params">()</span> <span class="type">const</span> <span class="keyword">override</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> location;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 享元工厂类  </span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MonsterFactory</span> &#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    std::unordered_map&lt;std::string, std::unique_ptr&lt;MonsterFlyweight&gt;&gt; monsterPool;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">MonsterFlyweight* <span class="title">getMonster</span><span class="params">(<span class="type">const</span> std::string&amp; monsterType, <span class="type">int</span> attackPower)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">auto</span> it = monsterPool.<span class="built_in">find</span>(monsterType);</span><br><span class="line">        <span class="keyword">if</span> (it == monsterPool.<span class="built_in">end</span>()) &#123;</span><br><span class="line">            it = monsterPool.<span class="built_in">emplace</span>(std::piecewise_construct,</span><br><span class="line">                std::forward_as_tuple(monsterType),</span><br><span class="line">                std::forward_as_tuple(std::<span class="built_in">make_unique</span>&lt;Monster&gt;(monsterType, attackPower))).first;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> it-&gt;second.<span class="built_in">get</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 上下文类（用于存储外部状态）  </span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MonsterContext</span> &#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    MonsterFlyweight* monster;</span><br><span class="line">    std::string location; <span class="comment">// 外部状态在上下文中存储  </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">MonsterContext</span>(MonsterFlyweight* monster) : <span class="built_in">monster</span>(monster) &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">setLocation</span><span class="params">(<span class="type">const</span> std::string&amp; location)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>-&gt;location = location;</span><br><span class="line">        monster-&gt;<span class="built_in">setLocation</span>(location); <span class="comment">// 通知享元更新其位置（这里只是为了演示）  </span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">attack</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        monster-&gt;<span class="built_in">attack</span>();</span><br><span class="line">        std::cout &lt;&lt; <span class="string">&quot;Monster is now at &quot;</span> &lt;&lt; location &lt;&lt; std::endl;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 客户端代码  </span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    MonsterFactory factory;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 创建并共享享元对象  </span></span><br><span class="line">    MonsterFlyweight* goblin = factory.<span class="built_in">getMonster</span>(<span class="string">&quot;Goblin&quot;</span>, <span class="number">10</span>);</span><br><span class="line">    MonsterFlyweight* orc = factory.<span class="built_in">getMonster</span>(<span class="string">&quot;Orc&quot;</span>, <span class="number">15</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 使用上下文来设置外部状态并执行操作  </span></span><br><span class="line">    <span class="function">MonsterContext <span class="title">goblinContext</span><span class="params">(goblin)</span></span>;</span><br><span class="line">    goblinContext.<span class="built_in">setLocation</span>(<span class="string">&quot;Cave Entrance&quot;</span>);</span><br><span class="line">    goblinContext.<span class="built_in">attack</span>();</span><br><span class="line"></span><br><span class="line">    <span class="function">MonsterContext <span class="title">orcContext</span><span class="params">(orc)</span></span>;</span><br><span class="line">    orcContext.<span class="built_in">setLocation</span>(<span class="string">&quot;Forest Clearing&quot;</span>);</span><br><span class="line">    orcContext.<span class="built_in">attack</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="状态模式"><a href="#状态模式" class="headerlink" title="状态模式"></a>状态模式</h3><p>在游戏编程中，状态模式（State Pattern）是一种行为设计模式，它允许一个对象在其内部状态改变时改变它的行为。状态模式使得对象看起来好像修改了它的类，但它实际上是通过将对象的行为委托给其当前状态对象来改变其行为的。这提供了一种使行为依赖于对象内部状态变化的解决方案，而不是通过大量的条件语句和复杂的逻辑来管理这些变化。</p>
<p>以下是一个简单的游戏编程中状态模式的示例，假设我们有一个角色（如玩家角色）可以处于不同的状态（如空闲、移动、攻击等）：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 状态基类</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">State</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">virtual</span> ~<span class="built_in">State</span>() = <span class="keyword">default</span>;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">handle</span><span class="params">(<span class="keyword">class</span> Character* character)</span> </span>= <span class="number">0</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 空闲状态</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">IdleState</span> : <span class="keyword">public</span> State &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">handle</span><span class="params">(Character* character)</span> <span class="keyword">override</span> </span>&#123;</span><br><span class="line">        std::cout &lt;&lt; <span class="string">&quot;Character is idle.&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">        <span class="comment">// 切换到其他状态...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 移动状态</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MoveState</span> : <span class="keyword">public</span> State &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">handle</span><span class="params">(Character* character)</span> <span class="keyword">override</span> </span>&#123;</span><br><span class="line">        std::cout &lt;&lt; <span class="string">&quot;Character is moving.&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">        <span class="comment">// 角色移动的逻辑...</span></span><br><span class="line">        <span class="comment">// 切换到其他状态...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 攻击状态</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AttackState</span> : <span class="keyword">public</span> State &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">handle</span><span class="params">(Character* character)</span> <span class="keyword">override</span> </span>&#123;</span><br><span class="line">        std::cout &lt;&lt; <span class="string">&quot;Character is attacking.&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">        <span class="comment">// 角色攻击的逻辑...</span></span><br><span class="line">        <span class="comment">// 切换到其他状态...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 角色类</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Character</span> &#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    State* state;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">Character</span>() : <span class="built_in">state</span>(<span class="keyword">new</span> <span class="built_in">IdleState</span>()) &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">setState</span><span class="params">(State* newState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">delete</span> state;</span><br><span class="line">        state = newState;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">update</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        state-&gt;<span class="built_in">handle</span>(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 其他角色相关的方法...</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Character character;</span><br><span class="line"></span><br><span class="line">    character.<span class="built_in">update</span>(); <span class="comment">// 输出 &quot;Character is idle.&quot;</span></span><br><span class="line"></span><br><span class="line">    character.<span class="built_in">setState</span>(<span class="keyword">new</span> <span class="built_in">MoveState</span>());</span><br><span class="line">    character.<span class="built_in">update</span>(); <span class="comment">// 输出 &quot;Character is moving.&quot;</span></span><br><span class="line"></span><br><span class="line">    character.<span class="built_in">setState</span>(<span class="keyword">new</span> <span class="built_in">AttackState</span>());</span><br><span class="line">    character.<span class="built_in">update</span>(); <span class="comment">// 输出 &quot;Character is attacking.&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 清理动态分配的状态对象（在实际应用中可能需要更复杂的内存管理）</span></span><br><span class="line">    <span class="keyword">delete</span> character.state;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在这个例子中，<code>Character</code> 类有一个 <code>State</code> 类型的成员变量 <code>state</code>，它指向当前的状态对象。<code>Character</code> 类有一个 <code>setState</code> 方法来更改其当前状态，以及一个 <code>update</code> 方法来调用当前状态对象的 <code>handle</code> 方法。每个状态类（如 <code>IdleState</code>、<code>MoveState</code>、<code>AttackState</code>）都实现了 <code>handle</code> 方法，该方法定义了当角色处于该状态时应该执行的行为。</p>
<p>通过使用状态模式，我们可以轻松地添加新的状态和行为，而无需修改 <code>Character</code> 类或现有的状态类。这提高了代码的可维护性和可扩展性。</p>
<h3 id="子类沙箱模式"><a href="#子类沙箱模式" class="headerlink" title="子类沙箱模式"></a>子类沙箱模式</h3><ul>
<li>子类沙箱模式（Subclass Sandbox Pattern）是一种设计模式，主要用于在面向对象编程中管理子类与基类之间的行为和操作。该模式的核心思想是将一些通用的操作或行为定义为基类的方法，而子类则通过重载或实现这些方法来实现特定的行为。通过这种方式，可以将所有与这些操作相关的耦合都聚集到基类，从而使子类与其他类更加独立。</li>
</ul>
<p>​        子类沙箱模式通常适用于以下情况：</p>
<ol>
<li>有一个带有大量子类的基类。</li>
<li>基类能够提供所有子类可能需要执行的操作集合。</li>
<li>在子类之间有重叠的代码，你想让它们之间更容易地共享代码。</li>
<li>你想使这些继承类和程序的其他代码之间的耦合最小化。</li>
</ol>
<p>在子类沙箱模式中，基类通常包含一些抽象方法或虚方法，这些方法定义了子类需要实现的行为。子类通过重载这些方法来实现自己的特定行为。同时，基类还可以包含一些受保护的（protected）方法，这些方法提供了一些子类在实现特定行为时需要调用的操作。这些受保护的方法可以被视为“沙箱”中的安全原语，子类可以在其中安全地执行特定的操作。</p>
<p>子类沙箱模式的优点包括：</p>
<ol>
<li>减少代码冗余：通过在基类中定义通用的操作，可以避免在子类中重复编写相同的代码。</li>
<li>提高代码的可维护性：由于所有的耦合都聚集到基类，子类与其他类之间的依赖关系变得更加清晰和简单，从而提高了代码的可维护性。</li>
<li>促进代码复用：子类可以通过继承基类来重用基类中定义的操作，从而提高了代码的复用性。</li>
</ol>
<p>然而，子类沙箱模式也存在一些缺点。例如，当基类包含大量的方法时，它可能会变得庞大且难以维护。此外，如果子类需要访问基类中的受保护方法，则可能会破坏封装性并增加类之间的耦合度。因此，在使用子类沙箱模式时，需要权衡其优缺点并根据具体的应用场景来选择是否使用该模式。</p>
<ul>
<li><p>在C++中，子类沙箱模式的一个示例可以通过创建一个基类，该类包含一些虚函数（表示子类可能需要实现的行为），以及一个或多个受保护的方法（表示子类可以安全调用的操作）。子类将继承这个基类，并根据需要重载虚函数来实现特定的行为。</p>
<p>以下是一个简单的C++示例，展示了子类沙箱模式的概念：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 基类，包含虚函数和受保护的方法</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Base</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// 虚函数，子类需要实现</span></span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">executeAction</span><span class="params">()</span> </span>= <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">    <span class="comment">// 受保护的方法，子类可以调用</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">protectedOperation</span><span class="params">(<span class="type">const</span> std::string&amp; message)</span> </span>&#123;</span><br><span class="line">        std::cout &lt;&lt; <span class="string">&quot;Protected operation called with message: &quot;</span> &lt;&lt; message &lt;&lt; std::endl;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 子类，继承基类并重载虚函数</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Derived</span> : <span class="keyword">public</span> Base &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// 重载基类中的虚函数</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">executeAction</span><span class="params">()</span> <span class="keyword">override</span> </span>&#123;</span><br><span class="line">        std::cout &lt;&lt; <span class="string">&quot;Derived class action starting...&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">        <span class="comment">// 调用基类中的受保护方法</span></span><br><span class="line">        <span class="built_in">protectedOperation</span>(<span class="string">&quot;Hello from Derived!&quot;</span>);</span><br><span class="line">        std::cout &lt;&lt; <span class="string">&quot;Derived class action finished.&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 主函数，用于测试</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 创建子类对象</span></span><br><span class="line">    Derived derivedObj;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 调用子类对象的虚函数，该函数会调用基类中的受保护方法</span></span><br><span class="line">    derivedObj.<span class="built_in">executeAction</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在这个示例中，<code>Base</code> 类是一个基类，它包含一个纯虚函数 <code>executeAction()</code> 和一个受保护的方法 <code>protectedOperation()</code>。<code>Derived</code> 类是 <code>Base</code> 的子类，它重载了 <code>executeAction()</code> 函数并在其中调用了基类的 <code>protectedOperation()</code> 方法。在 <code>main()</code> 函数中，我们创建了一个 <code>Derived</code> 类的对象，并调用了它的 <code>executeAction()</code> 方法，该方法会输出一些信息并调用基类的受保护方法。</p>
<p>请注意，这个示例主要是为了演示子类沙箱模式的概念，而不是一个完整的应用程序。在实际的应用程序中，基类和子类可能会包含更多的属性和方法，并且它们之间的关系可能会更加复杂。</p>
</li>
</ul>
<h3 id="工厂模式"><a href="#工厂模式" class="headerlink" title="工厂模式"></a>工厂模式</h3><h4 id="函数工厂"><a href="#函数工厂" class="headerlink" title="函数工厂"></a>函数工厂</h4><ul>
<li><p>在工厂类声明一个返回类的实例的函数</p>
</li>
<li><p>这段代码创建了一个怪物基类,然后通过继承实现了不同怪物,然后创建工厂来返回不同怪物的实例</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;list&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="comment">//怪物的基类</span></span><br><span class="line"><span class="keyword">class</span> 怪物基类</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    怪物基类(string p_name):<span class="built_in">name</span>(p_name) &#123;&#125;;</span><br><span class="line">    <span class="keyword">virtual</span> ~怪物基类() &#123;&#125;;</span><br><span class="line">    <span class="type">void</span> 共同方法()</span><br><span class="line">    &#123;</span><br><span class="line">        cout &lt;&lt; name &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    string name;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>&#x2F;&#x2F;怪物实现,都继承之怪物基类<br>class 野猪 :public 怪物基类<br>{<br>public:</p>
<pre><code>野猪(string p_name) :怪物基类(p_name) &#123;&#125;;
~野猪() &#123;&#125;;
</code></pre>
<p>};</p>
<p>class 黑熊 :public 怪物基类<br>{<br>public:</p>
<pre><code>黑熊(string p_name) :怪物基类(p_name) &#123;&#125;;
~黑熊() &#123;&#125;;
</code></pre>
<p>};</p>
<p>class 蜘蛛 :public 怪物基类<br>{<br>public:</p>
<pre><code>蜘蛛(string p_name) :怪物基类(p_name) &#123;&#125;;
~蜘蛛() &#123;&#125;;
</code></pre>
<p>};</p>
<p>&#x2F;&#x2F;声明一个怪物工厂,用于生产怪物<br>class 怪物工厂<br>{<br>public:</p>
<pre><code>怪物基类* 创建野猪(string p_name)
&#123;
    return new 野猪(p_name);
&#125;
怪物基类* 创建黑熊(string p_name)
&#123;
    return new 野猪(p_name);
&#125;
怪物基类* 创建蜘蛛(string p_name)
&#123;
    return new 野猪(p_name);
&#125;
</code></pre>
<p>};</p>
<p>int main() {</p>
<pre><code>怪物工厂 工厂;
怪物基类* new野猪=工厂.创建野猪(&quot;讨之助&quot;);
怪物基类* new黑熊 = 工厂.创建黑熊(&quot;小明&quot;);
怪物基类* new蜘蛛 = 工厂.创建蜘蛛(&quot;假面骑士&quot;);
new野猪-&gt;共同方法();
new黑熊-&gt;共同方法();
new蜘蛛-&gt;共同方法();

return 0;
</code></pre>
<p>}</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br></pre></td><td class="code"><pre><span class="line">![www](/img/函数工厂模式.png)</span><br><span class="line"></span><br><span class="line">#### 抽象工厂</span><br><span class="line"></span><br><span class="line">+ 通过抽象工厂和抽象产品生产一系列的产品,比图我要进货手机,有安卓和苹果等品牌,我就需要这个手机工厂生产了这两种品牌的手机</span><br><span class="line"></span><br><span class="line">```cpp</span><br><span class="line">#include &lt;iostream&gt;</span><br><span class="line">#include &lt;list&gt;</span><br><span class="line">using namespace std;</span><br><span class="line"></span><br><span class="line">//产品抽象类,所以苹果产品都继承这个类</span><br><span class="line">class 苹果</span><br><span class="line">&#123;</span><br><span class="line">public:</span><br><span class="line">  virtual ~苹果() &#123;&#125;;</span><br><span class="line">  virtual void 输出产品名字()=0;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">//苹果电脑实现</span><br><span class="line">class 苹果电脑 :public 苹果</span><br><span class="line">&#123;</span><br><span class="line">public:</span><br><span class="line">  ~苹果电脑() &#123;&#125;;</span><br><span class="line">  void 输出产品名字()</span><br><span class="line">  &#123;</span><br><span class="line">      cout &lt;&lt; &quot;苹果电脑&quot; &lt;&lt; endl;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">//苹果手机实现</span><br><span class="line">class 苹果手机 :public 苹果</span><br><span class="line">&#123;</span><br><span class="line">public:</span><br><span class="line">  ~苹果手机() &#123;&#125;;</span><br><span class="line">  void 输出产品名字()</span><br><span class="line">  &#123;</span><br><span class="line">      cout &lt;&lt; &quot;苹果手机&quot; &lt;&lt; endl;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">//安卓产品抽象类,索引安卓产品都继承这个类</span><br><span class="line">class 安卓</span><br><span class="line">&#123;</span><br><span class="line">public:</span><br><span class="line">  virtual ~安卓() &#123;&#125;;</span><br><span class="line">  virtual void 输出产品名字()=0;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">//安卓点啊弄实现</span><br><span class="line">class 安卓电脑 :public 安卓</span><br><span class="line">&#123;</span><br><span class="line">public:</span><br><span class="line">  ~安卓电脑() &#123;&#125;;</span><br><span class="line">  void 输出产品名字()</span><br><span class="line">  &#123;</span><br><span class="line">      cout &lt;&lt; &quot;安卓电脑&quot; &lt;&lt; endl;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">//安卓手机实现</span><br><span class="line">class 安卓手机 :public 安卓</span><br><span class="line">&#123;</span><br><span class="line">public:</span><br><span class="line">  ~安卓手机() &#123;&#125;;</span><br><span class="line">  void 输出产品名字()</span><br><span class="line">  &#123;</span><br><span class="line">      cout &lt;&lt; &quot;安卓手机&quot; &lt;&lt; endl;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">//工厂抽象类</span><br><span class="line">class 数码工厂</span><br><span class="line">&#123;</span><br><span class="line">public:</span><br><span class="line">  virtual ~数码工厂() &#123;&#125;;</span><br><span class="line">  virtual 安卓* 生产安卓产品() = 0;</span><br><span class="line">  virtual 苹果* 生产苹果产品() = 0;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">//工厂实现,可以生产各种品牌的电脑</span><br><span class="line">class 电脑工厂 :public 数码工厂</span><br><span class="line">&#123;</span><br><span class="line">public:</span><br><span class="line">  ~电脑工厂() &#123;&#125;;</span><br><span class="line">  安卓* 生产安卓产品()</span><br><span class="line">  &#123;</span><br><span class="line">      return new  安卓电脑;</span><br><span class="line">  &#125;</span><br><span class="line">  苹果* 生产苹果产品()</span><br><span class="line">  &#123;</span><br><span class="line">      return new 苹果电脑;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line">//工厂实现,可以生产各种品牌的手机</span><br><span class="line">class 手机工厂 :public 数码工厂</span><br><span class="line">&#123;</span><br><span class="line">public:</span><br><span class="line">  ~手机工厂() &#123;&#125;;</span><br><span class="line">  安卓* 生产安卓产品()</span><br><span class="line">  &#123;</span><br><span class="line">      return new  安卓手机;</span><br><span class="line">  &#125;</span><br><span class="line">  苹果* 生产苹果产品()</span><br><span class="line">  &#123;</span><br><span class="line">      return new 苹果手机;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">int main() &#123;</span><br><span class="line"></span><br><span class="line">  //我需要生产电脑</span><br><span class="line">  电脑工厂* 电脑商 = new 电脑工厂;</span><br><span class="line">  苹果* 苹果pro = 电脑商-&gt;生产苹果产品();</span><br><span class="line">  安卓* 安卓平板 = 电脑商-&gt;生产安卓产品();</span><br><span class="line">  苹果pro-&gt;输出产品名字();</span><br><span class="line">  安卓平板-&gt;输出产品名字();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  //我需要手机</span><br><span class="line">  手机工厂* 手机商 = new 手机工厂();</span><br><span class="line">  苹果* 苹果15 = 手机商-&gt;生产苹果产品();</span><br><span class="line">  苹果15-&gt;输出产品名字();</span><br><span class="line">  return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/auraea/%5Cimg%5C%E6%8A%BD%E8%B1%A1%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F.png" alt="抽象工厂模式"></p>
<ul>
<li>怪物工厂</li>
<li>通过抽象怪物工厂创建一系列的类</li>
</ul>
<p><img src="/auraea/%5Cimg%5C%E6%80%AA%E7%89%A9%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F.png" alt="抽象工厂模式"></p>
<p>在游戏开发中，抽象工厂模式（Abstract Factory Pattern）的使用通常出现在以下场景：</p>
<ol>
<li><strong>需要创建多个相关或相互依赖的对象时</strong>：抽象工厂模式允许你定义一个接口来创建一组相关的对象，而无需指定它们的具体类。这在游戏开发中很常见，因为游戏通常包含许多相互关联的对象，如角色、武器、装备等。</li>
<li><strong>需要处理多个产品族时</strong>：游戏可能会根据不同的版本、难度或模式而有不同的产品族（即一组相关的对象）。例如，一个游戏可能有不同的角色族（如战士、法师、盗贼等），每个角色族都有自己的武器、装备和技能。使用抽象工厂模式，你可以为每个角色族创建一个具体的工厂，该工厂负责创建该角色族所需的所有对象。</li>
<li><strong>需要隐藏对象的创建细节时</strong>：在游戏开发中，你可能希望隐藏对象的创建细节，以便在不影响客户端代码的情况下更改对象的实现。抽象工厂模式允许你定义一个接口来创建对象，而客户端代码只需与该接口交互，而无需知道对象的实际创建过程。</li>
<li><strong>需要提高系统的可扩展性和可维护性时</strong>：随着游戏的发展，你可能需要添加新的角色、武器或装备。使用抽象工厂模式，你可以轻松地添加新的产品族或产品，而无需修改现有的客户端代码。这有助于提高系统的可扩展性和可维护性。</li>
</ol>
<p>总之，抽象工厂模式在游戏开发中是一种非常有用的设计模式，它可以帮助你创建和管理一组相关的对象，并隐藏对象的创建细节。如果你的游戏需要处理多个产品族或需要提高系统的可扩展性和可维护性，那么抽象工厂模式可能是一个很好的选择。</p>
<p>在游戏开发中，抽象工厂模式的一个典型应用例子是创建不同类型的角色（如战士、法师）以及他们各自的装备。以下是一个简化的例子来说明这一点：</p>
<p>首先，定义一些接口来表示不同类型的角色和装备：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 角色接口</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Character</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">virtual</span> ~<span class="built_in">Character</span>() &#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">equip</span><span class="params">()</span> </span>= <span class="number">0</span>; <span class="comment">// 装备武器和装备</span></span><br><span class="line">    <span class="comment">// 其他角色方法...</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 战士接口和具体实现</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Warrior</span> : <span class="keyword">public</span> Character &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">equip</span><span class="params">()</span> <span class="keyword">override</span> </span>&#123;</span><br><span class="line">        std::cout &lt;&lt; <span class="string">&quot;Warrior equips sword and shield.&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 其他战士方法...</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 法师接口和具体实现</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Mage</span> : <span class="keyword">public</span> Character &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">equip</span><span class="params">()</span> <span class="keyword">override</span> </span>&#123;</span><br><span class="line">        std::cout &lt;&lt; <span class="string">&quot;Mage equips staff and robe.&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 其他法师方法...</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 武器接口</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Weapon</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">virtual</span> ~<span class="built_in">Weapon</span>() &#123;&#125;</span><br><span class="line">    <span class="comment">// 武器的方法...</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 战士武器和法师武器的具体实现（略）</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 装备接口</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Armor</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">virtual</span> ~<span class="built_in">Armor</span>() &#123;&#125;</span><br><span class="line">    <span class="comment">// 装备的方法...</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 战士装备和法师装备的具体实现（略）</span></span><br></pre></td></tr></table></figure>

<p>接下来，定义一个抽象工厂接口来创建角色和装备：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 抽象工厂接口</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">CharacterFactory</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">virtual</span> ~<span class="built_in">CharacterFactory</span>() &#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> Character* <span class="title">createWarrior</span><span class="params">()</span> </span>= <span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> Character* <span class="title">createMage</span><span class="params">()</span> </span>= <span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> Weapon* <span class="title">createWarriorWeapon</span><span class="params">()</span> </span>= <span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> Weapon* <span class="title">createMageWeapon</span><span class="params">()</span> </span>= <span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> Armor* <span class="title">createWarriorArmor</span><span class="params">()</span> </span>= <span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> Armor* <span class="title">createMageArmor</span><span class="params">()</span> </span>= <span class="number">0</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>然后，为每个产品族（如战士和法师）创建一个具体的工厂类：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 战士工厂</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">WarriorFactory</span> : <span class="keyword">public</span> CharacterFactory &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">Character* <span class="title">createWarrior</span><span class="params">()</span> <span class="keyword">override</span> </span>&#123; <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Warrior</span>(); &#125;</span><br><span class="line">    <span class="function">Weapon* <span class="title">createWarriorWeapon</span><span class="params">()</span> <span class="keyword">override</span> </span>&#123; <span class="comment">/* 返回战士武器的实例 */</span> &#125;</span><br><span class="line">    <span class="function">Armor* <span class="title">createWarriorArmor</span><span class="params">()</span> <span class="keyword">override</span> </span>&#123; <span class="comment">/* 返回战士装备的实例 */</span> &#125;</span><br><span class="line">    <span class="comment">// 其他法师相关的方法在这里不需要实现</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 法师工厂</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MageFactory</span> : <span class="keyword">public</span> CharacterFactory &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">Character* <span class="title">createMage</span><span class="params">()</span> <span class="keyword">override</span> </span>&#123; <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Mage</span>(); &#125;</span><br><span class="line">    <span class="function">Weapon* <span class="title">createMageWeapon</span><span class="params">()</span> <span class="keyword">override</span> </span>&#123; <span class="comment">/* 返回法师武器的实例 */</span> &#125;</span><br><span class="line">    <span class="function">Armor* <span class="title">createMageArmor</span><span class="params">()</span> <span class="keyword">override</span> </span>&#123; <span class="comment">/* 返回法师装备的实例 */</span> &#125;</span><br><span class="line">    <span class="comment">// 其他战士相关的方法在这里不需要实现</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>最后，在游戏的主逻辑或某个客户端代码中，你可以使用这些工厂来创建角色和装备：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    CharacterFactory* factory;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 创建战士族</span></span><br><span class="line">    factory = <span class="keyword">new</span> <span class="built_in">WarriorFactory</span>();</span><br><span class="line">    Character* warrior = factory-&gt;<span class="built_in">createWarrior</span>();</span><br><span class="line">    warrior-&gt;<span class="built_in">equip</span>(); <span class="comment">// 输出 &quot;Warrior equips sword and shield.&quot;</span></span><br><span class="line">    <span class="comment">// ... 其他战士相关的操作 ...</span></span><br><span class="line">    <span class="keyword">delete</span> warrior;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 创建法师族</span></span><br><span class="line">    <span class="keyword">delete</span> factory; <span class="comment">// 先删除前一个工厂实例</span></span><br><span class="line">    factory = <span class="keyword">new</span> <span class="built_in">MageFactory</span>();</span><br><span class="line">    Character* mage = factory-&gt;<span class="built_in">createMage</span>();</span><br><span class="line">    mage-&gt;<span class="built_in">equip</span>(); <span class="comment">// 输出 &quot;Mage equips staff and robe.&quot;</span></span><br><span class="line">    <span class="comment">// ... 其他法师相关的操作 ...</span></span><br><span class="line">    <span class="keyword">delete</span> mage;</span><br><span class="line">    <span class="keyword">delete</span> factory;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这个例子展示了如何使用抽象工厂模式来创建和管理游戏中不同类型的角色和装备。每个具体的工厂类负责创建它所属产品族的对象，从而实现了创建过程的封装和隔离。这有助于保持代码的清晰性和可维护性，并允许在不影响客户端代码的情况下添加新的产品族或修改现有产品族的实现。</p>
<h1 id="装配系统"><a href="#装配系统" class="headerlink" title="装配系统"></a>装配系统</h1><ul>
<li><p>所需节点Node3D,Marker3D作为部件放置的位置,方便调整位置</p>
</li>
<li><pre><code class="language-gdscript">@tool
extends Node3D
class_name 装备模型

@onready var 枪身: Marker3D = $&quot;枪身&quot;
@onready var 枪管: Marker3D = $&quot;枪管&quot;
@onready var 瞄准仪: Marker3D = $&quot;瞄准仪&quot;

#资源,每当资源变更时刷新配件节点
@export var 枪身资源:武器资源类:
    get: 
        return 枪身资源
    set(value):
        if value==枪身资源:
            return
        枪身资源=value
        武器资源更新()

@export var 枪管资源:武器资源类:
    get: 
        return 枪管资源
    set(value):
        if value==枪管资源:
            return
        枪管资源=value
        武器资源更新()

@export var 瞄准仪资源:武器资源类:
    get: 
        return 瞄准仪资源
    set(value):
        if value==瞄准仪资源:
            return
        瞄准仪资源=value
        武器资源更新()

# Called every frame. &#39;delta&#39; is the elapsed time since the previous frame.
func _process(delta: float) -&gt; void:
    pass
func 武器资源更新():
    #初始化节点,将配件全部清除
    if(枪身 and 枪身.get_child_count()&gt;0):
        枪身.get_child(0).queue_free()
    if(枪管 and 枪管.get_child_count()&gt;0):
        枪管.get_child(0).queue_free()
    if(瞄准仪 and 瞄准仪.get_child_count()&gt;0):
        瞄准仪.get_child(0).queue_free()

    #检查资源是否存在
    if 枪身!=null and 枪身资源:
        var 武器场景:PackedScene=load(枪身资源.武器场景路径)
        枪身.add_child(武器场景.instantiate())
    else: #如果武器不存在,初始化其他配件
        枪管资源=null
        瞄准仪资源=null

    #检查其他配件,如果存在则添加到节点树
    if 枪管!=null and 枪管资源:
        var 枪管场景:PackedScene=load(枪管资源.武器场景路径)
        枪管.add_child(枪管场景.instantiate())

    if 瞄准仪!=null and 瞄准仪资源:
        var 瞄准仪场景:PackedScene=load(瞄准仪资源.武器场景路径)
        瞄准仪.add_child(瞄准仪场景.instantiate())


+ 背包,负责更新装备
  
  
  extends Control
  
  @export var 武器展示场景: 装备模型
  @export var 武器装备场景: 装备模型
  @export var 物品背包:Array[Resource]
  
  # Called when the node enters the scene tree for the first time.
  func _ready() -&gt; void:
      pass # Replace with function body.
  
  
  # Called every frame. &#39;delta&#39; is the elapsed time since the previous frame.
  
  func _process(delta: float) -&gt; void:
  
      更新装备(武器展示场景);
      更新装备(武器装备场景);
      pass
  
  func 更新装备(data:装备模型):
  
      if data:
          data.枪身资源=物品背包[0]
          data.枪管资源=物品背包[1]
          data.瞄准仪资源=物品背包[2]
  
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">  </span><br></pre></td></tr></table></figure>
  extends PanelContainer
    
    @onready var texture_rect: TextureRect
    
    @onready var 背包: Control = $&quot;../../..&quot;
    @export var 索引:int=0
    # Called when the node enters the scene tree for the first time.
    func _ready() -&gt; void:
        texture_rect=get_node(&quot;TextureRect&quot;)
        pass # Replace with function body.
    
    # Called every frame. &#39;delta&#39; is the elapsed time since the previous frame.
    func _process(delta: float) -&gt; void:
        if 背包.物品背包[索引]:
            texture_rect.texture=背包.物品背包[索引].icon
        else:
            texture_rect.texture=preload(&quot;res://Icon/空纹理.png&quot;)
        pass
    
    func _get_drag_data(position):
        if 背包.物品背包[索引]:
            var cpb =TextureRect.new()
            cpb.texture=背包.物品背包[索引].icon
            set_drag_preview(cpb)
            return 背包.物品背包[索引]
    
    func _can_drop_data(position, data):
        # 检查是否为武器基类
        if data is Resource:
            return true
        else:
            return false
    #数据处理
    func _drop_data(position, data):
        print(data)
        if 背包.物品背包[索引]==null:
            var ite=背包.物品背包.find(data)
            背包.物品背包
    [索引]=data
            背包.物品背包[ite]=null
        else :
            var ite=背包.物品背包.find(data)
            var temp=背包.物品背包[索引]
            背包.物品背包[索引]=data
            背包.物品背包[ite]=temp
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"># 游戏能力系统</span><br><span class="line">```cpp</span><br><span class="line">#ifndef TABILITY_H</span><br><span class="line">#define TABILITY_H</span><br><span class="line"></span><br><span class="line">#include &lt;godot_cpp/classes/node.hpp&gt;</span><br><span class="line"></span><br><span class="line">//#include &lt;godot_cpp/core/class_db.hpp&gt;</span><br><span class="line">#include &lt;godot_cpp/variant/utility_functions.hpp&gt;  //输出字符串用</span><br><span class="line">using namespace godot;</span><br><span class="line"></span><br><span class="line">//#define VARIANT_ARG_MAX 8</span><br><span class="line">//#define VARIANT_ARG_DECLARE const Variant &amp;p_arg1, const Variant &amp;p_arg2, const Variant &amp;p_arg3, const Variant &amp;p_arg4, const //Variant &amp;p_arg5, const Variant &amp;p_arg6, const Variant &amp;p_arg7, const Variant &amp;p_arg8</span><br><span class="line"></span><br><span class="line">class AbilitySystem : public Node</span><br><span class="line">&#123;</span><br><span class="line">    GDCLASS(AbilitySystem, Node);</span><br><span class="line"></span><br><span class="line">private:</span><br><span class="line">protected:</span><br><span class="line">    static void _bind_methods();</span><br><span class="line">public:</span><br><span class="line">    AbilitySystem();</span><br><span class="line">    ~AbilitySystem();</span><br><span class="line">&#125;;</span><br><span class="line">#endif // TABILITY_H</span><br></pre></td></tr></table></figure>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**************************************************************************/</span></span><br><span class="line"><span class="comment">/*  threen.cpp                                                            */</span></span><br><span class="line"><span class="comment">/**************************************************************************/</span></span><br><span class="line"><span class="comment">/*                         This file is part of:                          */</span></span><br><span class="line"><span class="comment">/*                             GODOT ENGINE                               */</span></span><br><span class="line"><span class="comment">/*                        https://godotengine.org                         */</span></span><br><span class="line"><span class="comment">/**************************************************************************/</span></span><br><span class="line"><span class="comment">/* Copyright (c) 2014-present Godot Engine contributors (see AUTHORS.md). */</span></span><br><span class="line"><span class="comment">/* Copyright (c) 2007-2014 Juan Linietsky, Ariel Manzur.                  */</span></span><br><span class="line"><span class="comment">/*                                                                        */</span></span><br><span class="line"><span class="comment">/* Permission is hereby granted, free of charge, to any person obtaining  */</span></span><br><span class="line"><span class="comment">/* a copy of this software and associated documentation files (the        */</span></span><br><span class="line"><span class="comment">/* &quot;Software&quot;), to deal in the Software without restriction, including    */</span></span><br><span class="line"><span class="comment">/* without limitation the rights to use, copy, modify, merge, publish,    */</span></span><br><span class="line"><span class="comment">/* distribute, sublicense, and/or sell copies of the Software, and to     */</span></span><br><span class="line"><span class="comment">/* permit persons to whom the Software is furnished to do so, subject to  */</span></span><br><span class="line"><span class="comment">/* the following conditions:                                              */</span></span><br><span class="line"><span class="comment">/*                                                                        */</span></span><br><span class="line"><span class="comment">/* The above copyright notice and this permission notice shall be         */</span></span><br><span class="line"><span class="comment">/* included in all copies or substantial portions of the Software.        */</span></span><br><span class="line"><span class="comment">/*                                                                        */</span></span><br><span class="line"><span class="comment">/* THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND,        */</span></span><br><span class="line"><span class="comment">/* EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF     */</span></span><br><span class="line"><span class="comment">/* MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. */</span></span><br><span class="line"><span class="comment">/* IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY   */</span></span><br><span class="line"><span class="comment">/* CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,   */</span></span><br><span class="line"><span class="comment">/* TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE      */</span></span><br><span class="line"><span class="comment">/* SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.                 */</span></span><br><span class="line"><span class="comment">/**************************************************************************/</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;public/AbilitySystem.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">//#include &quot;easing_equations.h&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;godot_cpp/core/class_db.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;godot_cpp/variant/utility_functions.hpp&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> godot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> AbilitySystem::_bind_methods()</span><br><span class="line">&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">AbilitySystem::<span class="built_in">AbilitySystem</span>() &#123;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">AbilitySystem::~<span class="built_in">AbilitySystem</span>()</span><br><span class="line">&#123;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
</code></pre>
</li>
</ul>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="https://luojiangbao015.github.io">John Doe</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="https://luojiangbao015.github.io/2025/03/14/%E6%88%88%E5%A4%9A/GDScript/Gdextension/">https://luojiangbao015.github.io/2025/03/14/%E6%88%88%E5%A4%9A/GDScript/Gdextension/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles on this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless otherwise stated.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/auraea/tags/%E5%AD%A6%E4%B9%A0/">学习</a></div><div class="post-share"><div class="social-share" data-image="/auraea/img/ww/D003.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/auraea/2025/03/14/%E6%88%88%E5%A4%9A/CSharp/CS%E6%88%88%E5%A4%9A%E6%9D%82%E9%A1%B9/" title="C#杂项"><img class="cover" src="/auraea/img/ww/A.png" onerror="onerror=null;src='/auraea/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">Previous</div><div class="info-item-2">C#杂项</div></div><div class="info-2"><div class="info-item-1">戈多CS源码类声明1public class Node : GodotObject  枚举声明12345678public enum ProcessModeEnum : long   &#123;       Inherit,       Pausable,       WhenPaused,       Always,       Disabled   &#125;  FLAGS声明 可以组合多种状态 示例  1234567891011121314151617181920//声明    [Flags]    public fliagsenum MySlags&#123;A=1,B=2,C=4&#125;;//函数    public void func(fliags a)    &#123;        if((fliags &amp; MySlags.A)== MySlags.A)        &#123;            //第一个方法        &#125;        if((fliags &amp; MySlags.A)== MySlags.A)  ...</div></div></div></a><a class="pagination-related" href="/auraea/2025/03/14/%E6%88%88%E5%A4%9A/GDScript/godot%E5%9F%BA%E7%A1%80/" title="godot基础"><img class="cover" src="/auraea/img/ww/D003.png" onerror="onerror=null;src='/auraea/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">Next</div><div class="info-item-2">godot基础</div></div><div class="info-2"><div class="info-item-1">语法变量12345var 变量:int #自动转换类型var 整型:int #限定为整型var 字符串:String #限定为字符串var 浮点:float #限定为字符串var 数组:array  类123class 类:    var x    var y  函数12func 方法()-&gt;void:    print(&quot;输出&quot;)  12345#判断类型转换掉用if (@event is InputEventMouseMotion mouseMotion)&#123;	_mouseDelta = mouseMotion.Relative;&#125;  封装123456789var _width: float = 0.0@export var 宽度: float=27:	get(): 		return _width	set(value):		if value==_width:			return		_width=value		_回调_尺寸改变时()    存储系统 代码实例:读取 123456789extends Nodeclass_name...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/auraea/2025/03/14/cpp/C++%E6%95%B0%E7%BB%84/" title="c++数组"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-03-14</div><div class="info-item-2">c++数组</div></div><div class="info-2"><div class="info-item-1">文档说明 此文档记录了C++普通数组实现增删改查的方法  声明123int const 数组最大长度=10;      //声明数组最大长度int 数组数据=[N+1];       //声明数组,长度为11       同:int 数组数据[11];int 元素数量=0;           //声明一个整形遍历,用来记录存储数组元素数量   插入数组的方法 创建一个带有一个参数的方法 判断数组数组元素数量是否等于最大数组元素,如果等于则返回跳出 如果元素数量小于最大元素数量,数组&#x3D;等于参数,元素数量+1,  123456789void 插入元素(int 元素)&#123;    if (元素数量==数组最大长度)    &#123;        cout&lt;&lt;&quot;数组满了&quot;&lt;&lt;endl;        return;  //跳出函数    &#125;    数组数据[元素数量=元素数量+1]=元素;  //数组数据[1]=元素&#125;    通过以上方法可以通过for直接插入数组  1234for(int...</div></div></div></a><a class="pagination-related" href="/auraea/2025/03/14/cpp/CMake/" title="Cmake"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-03-14</div><div class="info-item-2">Cmake</div></div><div class="info-2"><div class="info-item-1">文档说明 用于记录CMake编译器的用法  CMake用法基础 模板  123cmake_minimum_required(VERSION 3.10)  #版本project(MyProject)  #项目名   可执行文件  1add_executable(可执行文件名 main.cpp)    多个可执行文件  12add_executable(可执行文件名1 my1.cpp) add_executable(可执行文件名2 my2.cpp)   生成静态文件 生成静态库  12set(MUL_SOURCES ./mul/mul.cpp)          #设置CPP路径变量add_library(mul STATIC $&#123;MUL_SOURCES&#125;)  #通过MUL_SOURCES路径STATIC属性添加为静态库   链接全局,将静态链接链接至所有程序  123include_directories(./)  #添加头文件路径1.link_directories(路径)  #添加静态库链接所在目录2.link_libraries(库名)     ...</div></div></div></a><a class="pagination-related" href="/auraea/2025/03/14/cpp/cpp%E5%9F%BA%E7%A1%80/" title="CPP基础"><img class="cover" src="https://img2.imgtp.com/2024/03/29/Iy4Ct6xe.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-03-14</div><div class="info-item-2">CPP基础</div></div><div class="info-2"><div class="info-item-1">文档说明 记录CPP的一些基础用法  基础变量变量声明1234int 整型=0;int[] 数组=&#123;2,2,2&#125;;char 字符=&#x27;a&#x27;;String 字符串=&quot;我是字符串&quot;;  结构体结构体声明123456struct 结构体&#123;string 字符串;int x;int y;&#125;  类类声明123456789class Box&#123;  public:  // 公有成员   protected:  // 受保护成员   private:  // 私有成员&#125;;  函数回调函数 通过指针函数对函数进行调用  12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091#include...</div></div></div></a><a class="pagination-related" href="/auraea/2025/03/14/cpp/cpp%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" title="cpp数据结构"><img class="cover" src="https://img2.imgtp.com/2024/03/29/CuFHenMA.webp" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-03-14</div><div class="info-item-2">cpp数据结构</div></div><div class="info-2"><div class="info-item-1">结构线性表   方法     初始化init()    头插insertAtHead(int vale)    尾插insertAtTail(int vale)    删除指定元素deletenode(int vale)    遍历输出printList()    析构LinkedList()    线性表数组1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192#include&lt;bits/stdc++.h&gt;using namespace std;const int N = 10;    //最大容量为10int res[N + 1];    //存储元素,下标从1开始int cnt = 0;    //数组指针，也表示当前元素数量//插入元素void...</div></div></div></a><a class="pagination-related" href="/auraea/2025/03/14/cpp/cpp%E6%A8%A1%E6%9D%BF/" title="cpp模板"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-03-14</div><div class="info-item-2">cpp模板</div></div><div class="info-2"><div class="info-item-1">Git 拉取 1git clone 链接  修改  添加 1git add .  检查 1git status  提交 1git commit -m &quot;input yours message&quot;  推送 1git push origin main  </div></div></div></a><a class="pagination-related" href="/auraea/2025/03/14/cpp/inGUI/" title="ImGUI"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-03-14</div><div class="info-item-2">ImGUI</div></div><div class="info-2"><div class="info-item-1">文档说明 ImGui库是一个强大的C++GUI开源库,可用于开发多种可视化程序  窗口创建窗口 源码声明  1bool ImGui::Begin(const char* name, bool* p_open, ImGuiWindowFlags flags)  //创建窗口  1void ImGui::End()  //结束   name 窗口名 p_open 布尔指针,控制窗口显示 ImGuiWindowFlags...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/auraea/img/butterfly-icon.png" onerror="this.onerror=null;this.src='/auraea/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">John Doe</div><div class="author-info-description"></div><div class="site-data"><a href="/auraea/archives/"><div class="headline">Articles</div><div class="length-num">36</div></a><a href="/auraea/tags/"><div class="headline">Tags</div><div class="length-num">3</div></a><a href="/auraea/categories/"><div class="headline">Categories</div><div class="length-num">6</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%BA%90%E7%A0%81"><span class="toc-number">1.</span> <span class="toc-text">源码</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A8%A1%E6%9D%BF"><span class="toc-number">1.1.</span> <span class="toc-text">模板</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#bind-methods"><span class="toc-number">1.2.</span> <span class="toc-text">_bind_methods()</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B3%A8%E5%86%8C%E5%B1%9E%E6%80%A7"><span class="toc-number">1.3.</span> <span class="toc-text">注册属性</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A3%B0%E6%98%8E-%E6%9E%9A%E4%B8%BE-Flag-%E5%B8%B8%E9%87%8F"><span class="toc-number">1.4.</span> <span class="toc-text">声明:枚举,Flag,常量</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BF%A1%E5%8F%B7"><span class="toc-number">1.5.</span> <span class="toc-text">信号</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E7%BB%84"><span class="toc-number">1.6.</span> <span class="toc-text">数组</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B%E5%AF%B9%E8%B1%A1"><span class="toc-number">1.7.</span> <span class="toc-text">实例对象</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B0%83%E7%94%A8%E5%8D%95%E4%BE%8B"><span class="toc-number">1.8.</span> <span class="toc-text">调用单例</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%87%8D%E5%86%99%E8%99%9A%E5%87%BD%E6%95%B0"><span class="toc-number">1.9.</span> <span class="toc-text">重写虚函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ADD-PROPERTY%E7%9A%84%E7%94%A8%E6%B3%95"><span class="toc-number">1.10.</span> <span class="toc-text">ADD_PROPERTY的用法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#enum-PropertyHint"><span class="toc-number">1.10.0.1.</span> <span class="toc-text">enum PropertyHint</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#enum-Type"><span class="toc-number">1.10.0.2.</span> <span class="toc-text">enum Type</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Scons"><span class="toc-number">2.</span> <span class="toc-text">Scons</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">2.1.</span> <span class="toc-text">配置文件</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Gdextension"><span class="toc-number">3.</span> <span class="toc-text">Gdextension</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6-1"><span class="toc-number">3.1.</span> <span class="toc-text">配置文件</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%9E%E7%8E%B0%E6%BA%90%E7%A0%81"><span class="toc-number">4.</span> <span class="toc-text">实现源码</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#2D"><span class="toc-number">4.1.</span> <span class="toc-text">2D</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80%E7%A7%BB%E5%8A%A8"><span class="toc-number">4.1.1.</span> <span class="toc-text">基础移动</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%AA%E7%89%A9%E8%BF%BD%E8%B8%AA%E7%8E%A9%E5%AE%B6"><span class="toc-number">4.1.2.</span> <span class="toc-text">怪物追踪玩家</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9A%B4%E5%87%BB%E5%85%AC%E5%BC%8F"><span class="toc-number">4.1.3.</span> <span class="toc-text">暴击公式</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3D"><span class="toc-number">4.2.</span> <span class="toc-text">3D</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80%E7%A7%BB%E5%8A%A8-1"><span class="toc-number">4.2.1.</span> <span class="toc-text">基础移动</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%95%E4%BE%8B"><span class="toc-number">4.3.</span> <span class="toc-text">单例</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%98%E5%82%A8%E7%B3%BB%E7%BB%9F"><span class="toc-number">4.3.1.</span> <span class="toc-text">存储系统</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#GUI"><span class="toc-number">4.4.</span> <span class="toc-text">GUI</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8C%89%E9%92%AE"><span class="toc-number">4.4.1.</span> <span class="toc-text">按钮</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8F%92%E4%BB%B6"><span class="toc-number">4.5.</span> <span class="toc-text">插件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%83%8C%E5%8C%85"><span class="toc-number">4.5.1.</span> <span class="toc-text">背包</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F"><span class="toc-number">5.</span> <span class="toc-text">设计模式</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B"><span class="toc-number">5.1.</span> <span class="toc-text">简介</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%91%BD%E4%BB%A4%E6%A8%A1%E5%BC%8F"><span class="toc-number">5.2.</span> <span class="toc-text">命令模式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%91%BD%E4%BB%A4%E6%A8%A1%E5%BC%8F%E7%9A%84%E5%9F%BA%E6%9C%AC%E7%BB%93%E6%9E%84"><span class="toc-number">5.2.1.</span> <span class="toc-text">命令模式的基本结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B8%B8%E6%88%8F%E7%BC%96%E7%A8%8B%E4%B8%AD%E7%9A%84%E5%91%BD%E4%BB%A4%E6%A8%A1%E5%BC%8F%E7%A4%BA%E4%BE%8B"><span class="toc-number">5.2.2.</span> <span class="toc-text">游戏编程中的命令模式示例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%91%BD%E4%BB%A4%E6%A8%A1%E5%BC%8F%E7%9A%84%E4%BC%98%E7%82%B9"><span class="toc-number">5.2.3.</span> <span class="toc-text">命令模式的优点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-number">5.2.4.</span> <span class="toc-text">注意事项</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%AB%E5%85%83%E6%A8%A1%E5%BC%8F"><span class="toc-number">5.2.5.</span> <span class="toc-text">享元模式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%8A%B6%E6%80%81%E6%A8%A1%E5%BC%8F"><span class="toc-number">5.2.6.</span> <span class="toc-text">状态模式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%90%E7%B1%BB%E6%B2%99%E7%AE%B1%E6%A8%A1%E5%BC%8F"><span class="toc-number">5.2.7.</span> <span class="toc-text">子类沙箱模式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F"><span class="toc-number">5.2.8.</span> <span class="toc-text">工厂模式</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E5%B7%A5%E5%8E%82"><span class="toc-number">5.2.8.1.</span> <span class="toc-text">函数工厂</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%A3%85%E9%85%8D%E7%B3%BB%E7%BB%9F"><span class="toc-number">6.</span> <span class="toc-text">装配系统</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Posts</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/auraea/2025/03/14/%E6%B8%B8%E6%88%8F%E8%AE%BE%E8%AE%A1/%E6%B8%B8%E6%88%8F%E8%AE%BE%E8%AE%A1/" title="游戏设计"><img src="/auraea/img/ww/D003.png" onerror="this.onerror=null;this.src='/auraea/img/404.jpg'" alt="游戏设计"/></a><div class="content"><a class="title" href="/auraea/2025/03/14/%E6%B8%B8%E6%88%8F%E8%AE%BE%E8%AE%A1/%E6%B8%B8%E6%88%8F%E8%AE%BE%E8%AE%A1/" title="游戏设计">游戏设计</a><time datetime="2025-03-14T11:39:30.302Z" title="Created 2025-03-14 19:39:30">2025-03-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/auraea/2025/03/14/%E6%9D%82%E9%A1%B9/%E6%B8%B8%E6%88%8F%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/" title="游戏源码解析"><img src="/auraea/img/ww/D003.png" onerror="this.onerror=null;this.src='/auraea/img/404.jpg'" alt="游戏源码解析"/></a><div class="content"><a class="title" href="/auraea/2025/03/14/%E6%9D%82%E9%A1%B9/%E6%B8%B8%E6%88%8F%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/" title="游戏源码解析">游戏源码解析</a><time datetime="2025-03-14T11:39:30.299Z" title="Created 2025-03-14 19:39:30">2025-03-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/auraea/2025/03/14/%E6%9D%82%E9%A1%B9/%E5%B0%8F%E8%AF%B4/" title="怪物猎人伤害"><img src="/auraea/img/ww/D003.png" onerror="this.onerror=null;this.src='/auraea/img/404.jpg'" alt="怪物猎人伤害"/></a><div class="content"><a class="title" href="/auraea/2025/03/14/%E6%9D%82%E9%A1%B9/%E5%B0%8F%E8%AF%B4/" title="怪物猎人伤害">怪物猎人伤害</a><time datetime="2025-03-14T11:39:30.298Z" title="Created 2025-03-14 19:39:30">2025-03-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/auraea/2025/03/14/%E6%9D%82%E9%A1%B9/%E5%B0%8F%E8%AF%B4%20-%20%E5%89%AF%E6%9C%AC/" title="怪物猎人伤害"><img src="/auraea/img/ww/D003.png" onerror="this.onerror=null;this.src='/auraea/img/404.jpg'" alt="怪物猎人伤害"/></a><div class="content"><a class="title" href="/auraea/2025/03/14/%E6%9D%82%E9%A1%B9/%E5%B0%8F%E8%AF%B4%20-%20%E5%89%AF%E6%9C%AC/" title="怪物猎人伤害">怪物猎人伤害</a><time datetime="2025-03-14T11:39:30.296Z" title="Created 2025-03-14 19:39:30">2025-03-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/auraea/2025/03/14/%E6%9D%82%E9%A1%B9/%E4%BC%A4%E5%AE%B3%E8%AE%A1%E7%AE%97/" title="怪物猎人伤害"><img src="/auraea/img/ww/D003.png" onerror="this.onerror=null;this.src='/auraea/img/404.jpg'" alt="怪物猎人伤害"/></a><div class="content"><a class="title" href="/auraea/2025/03/14/%E6%9D%82%E9%A1%B9/%E4%BC%A4%E5%AE%B3%E8%AE%A1%E7%AE%97/" title="怪物猎人伤害">怪物猎人伤害</a><time datetime="2025-03-14T11:39:30.295Z" title="Created 2025-03-14 19:39:30">2025-03-14</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2025 By John Doe</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.3.5</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/auraea/js/utils.js"></script><script src="/auraea/js/main.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>