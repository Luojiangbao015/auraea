<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Gas系统笔记 | Hexo</title><meta name="author" content="John Doe"><meta name="copyright" content="John Doe"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Build.cs showdebug abilitysystem 调试信息  12345678910111213using UnrealBuildTool;public class MyMVCtest : ModuleRules&#123;	public MyMVCtest(ReadOnlyTargetRules Target) : base(Target)	&#123;		PCHUsage &#x3D;">
<meta property="og:type" content="article">
<meta property="og:title" content="Gas系统笔记">
<meta property="og:url" content="https://luojiangbao015.github.io/2024/03/30/ue5/%E5%8F%98%E9%87%8F/GAS%E7%B3%BB%E7%BB%9F/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="Build.cs showdebug abilitysystem 调试信息  12345678910111213using UnrealBuildTool;public class MyMVCtest : ModuleRules&#123;	public MyMVCtest(ReadOnlyTargetRules Target) : base(Target)	&#123;		PCHUsage &#x3D;">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://luojiangbao015.github.io/img/ww/D002.png">
<meta property="article:published_time" content="2024-03-29T16:17:59.000Z">
<meta property="article:modified_time" content="2025-02-07T15:23:29.255Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="学习">
<meta property="article:tag" content="变量">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://luojiangbao015.github.io/img/ww/D002.png"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Gas系统笔记",
  "url": "https://luojiangbao015.github.io/2024/03/30/ue5/%E5%8F%98%E9%87%8F/GAS%E7%B3%BB%E7%BB%9F/",
  "image": "https://luojiangbao015.github.io/img/ww/D002.png",
  "datePublished": "2024-03-29T16:17:59.000Z",
  "dateModified": "2025-02-07T15:23:29.255Z",
  "author": [
    {
      "@type": "Person",
      "name": "John Doe",
      "url": "https://luojiangbao015.github.io/"
    }
  ]
}</script><link rel="shortcut icon" href="/auraea/img/favicon.png"><link rel="canonical" href="https://luojiangbao015.github.io/2024/03/30/ue5/%E5%8F%98%E9%87%8F/GAS%E7%B3%BB%E7%BB%9F/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/auraea/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/auraea/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Gas系统笔记',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(img/ww/D002.png);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/auraea/"><span class="site-name">Hexo</span></a><a class="nav-page-title" href="/auraea/"><span class="site-name">Gas系统笔记</span></a></span><div id="menus"></div></nav><div id="post-info"><h1 class="post-title">Gas系统笔记</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2024-03-29T16:17:59.000Z" title="Created 2024-03-30 00:17:59">2024-03-30</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-02-07T15:23:29.255Z" title="Updated 2025-02-07 23:23:29">2025-02-07</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/auraea/categories/ue5/">ue5</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="Build-cs"><a href="#Build-cs" class="headerlink" title="Build.cs"></a>Build.cs</h1><ul>
<li>showdebug abilitysystem 调试信息</li>
</ul>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> UnrealBuildTool;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">MyMVCtest</span> : <span class="title">ModuleRules</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">MyMVCtest</span>(<span class="params">ReadOnlyTargetRules Target</span>) : <span class="title">base</span>(<span class="params">Target</span>)</span></span><br><span class="line">	&#123;</span><br><span class="line">		PCHUsage = PCHUsageMode.UseExplicitOrSharedPCHs;</span><br><span class="line"></span><br><span class="line">		PublicDependencyModuleNames.AddRange(<span class="keyword">new</span> <span class="built_in">string</span>[] &#123; <span class="string">&quot;Core&quot;</span>, <span class="string">&quot;CoreUObject&quot;</span>, <span class="string">&quot;Engine&quot;</span>, <span class="string">&quot;InputCore&quot;</span>,<span class="string">&quot;EnhancedInput&quot;</span>, <span class="string">&quot;GameplayAbilities&quot;</span> &#125;);</span><br><span class="line"></span><br><span class="line">		PrivateDependencyModuleNames.AddRange(<span class="keyword">new</span> <span class="built_in">string</span>[] &#123; <span class="string">&quot;GameplayTags&quot;</span>, <span class="string">&quot;GameplayTasks&quot;</span>, <span class="string">&quot;NavigationSystem&quot;</span>, <span class="string">&quot;Niagara&quot;</span>, <span class="string">&quot;AIModule&quot;</span> &#125;);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol>
<li><p>Gameplay Ability (GA)</p>
<ul>
<li>GA代表游戏中的技能或能力，是玩家或NPC可以执行的动作。</li>
<li>GA通常由一个或多个Ability Task（任务）组成，这些任务定义了技能的具体行为和效果。</li>
</ul>
</li>
<li><p>Gameplay Effect (GE)</p>
<p>：</p>
<ul>
<li>GE描述了一个游戏效果，例如治疗、伤害、加攻、减速等。</li>
<li>GE可以修改玩家属性、添加其他GE、修改玩家身上的Tag或给玩家某个Cue效果。</li>
<li>GE的配置包括时效性参数（如执行时长和周期）、属性修改、修改条件、Tag属性和后处理等。</li>
</ul>
</li>
<li><p>Gameplay Tag (Tag)</p>
<p>：</p>
<ul>
<li>Tag用于标记状态和类别，可以用来表示一个游戏对象的特性、状态、行为等信息。</li>
<li>例如，可以用”Character.Type.Enemy”和”Character.Type.Boss”等Tag来描述敌人角色，用”Character.State.Jump”和”Character.State.Swimming”等Tag来表明对象在跳跃或游泳。</li>
</ul>
</li>
<li><p>Gameplay Cue (GC)</p>
<p>：</p>
<ul>
<li>GC负责播放客户端表现，如特效、音效、动画、材质效果和后处理等。</li>
<li>GC可以通过DS（Data-Driven）端发起，广播到客户端，也可以直接在客户端触发。</li>
</ul>
</li>
<li><p>AttributeSet（属性集）</p>
<p>：</p>
<ul>
<li>AttributeSet定义了角色属性，如攻击力、防御力、血量等。</li>
<li>AttributeSet是GAS系统中用于存储和管理角色属性的核心组件。</li>
</ul>
</li>
<li><p>Ability System Component (ASC)</p>
<p>：</p>
<ul>
<li>ASC是GAS系统的管理组件，负责管理GAS模块对外接口，以及上述提到的GA、Task、GE、Tag、GC和AttributeSet等。</li>
<li>ASC提供了用于激活技能、管理游戏效果和标记等功能的接口。</li>
</ul>
</li>
</ol>
<h1 id="官方Tga"><a href="#官方Tga" class="headerlink" title="官方Tga"></a>官方Tga</h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//头文件</span></span><br><span class="line"><span class="keyword">namespace</span> FairyTag</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">UE_DECLARE_GAMEPLAY_TAG_EXTERN</span>(Movement_Mode_Walking);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//源文件</span></span><br><span class="line"><span class="keyword">namespace</span> FairyTag</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">UE_DEFINE_GAMEPLAY_TAG_COMMENT</span>(Movement_Mode_Walking, <span class="string">&quot;Movement.Mode.Walking&quot;</span>, <span class="string">&quot;Default Character movement tag&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="AttributeSet-属性配置"><a href="#AttributeSet-属性配置" class="headerlink" title="AttributeSet 属性配置"></a>AttributeSet 属性配置</h1><h2 id="创建AttributeSet-类"><a href="#创建AttributeSet-类" class="headerlink" title="创建AttributeSet 类"></a>创建AttributeSet 类</h2><ul>
<li><p>创建继承自AttributeSet的C++类，玩家和怪物的属性都在这里进行声明配置，如生命值魔法值等</p>
<ul>
<li>头文件</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Fill out your copyright notice in the Description page of Project Settings.</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> once</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;CoreMinimal.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;AttributeSet.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;AbilitySystemComponent.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;AuraAttributeSet.generated.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">DECLARE_DELEGATE_RetVal</span>(FGameplayAttribute, FAttributeSignature);</span><br><span class="line"><span class="comment">// 属性访问器</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ATTRIBUTE_ACCESSORS(ClassName, PropertyName) \</span></span><br><span class="line"><span class="meta">GAMEPLAYATTRIBUTE_PROPERTY_GETTER(ClassName, PropertyName) \</span></span><br><span class="line"><span class="meta">GAMEPLAYATTRIBUTE_VALUE_GETTER(PropertyName) \</span></span><br><span class="line"><span class="meta">GAMEPLAYATTRIBUTE_VALUE_SETTER(PropertyName) \</span></span><br><span class="line"><span class="meta">GAMEPLAYATTRIBUTE_VALUE_INITTER(PropertyName)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 特殊属性</span></span><br><span class="line"><span class="built_in">USTRUCT</span>()</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">FEffectProperties</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">GENERATED_BODY</span>()</span><br><span class="line">	<span class="built_in">FEffectProperties</span>()&#123;&#125;;</span><br><span class="line">	</span><br><span class="line">	FGameplayEffectContextHandle EffectContextHandle;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UPROPERTY</span>()</span><br><span class="line">	UAbilitySystemComponent* SourceASC = <span class="literal">nullptr</span>;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UPROPERTY</span>()</span><br><span class="line">	AActor* SourceAvatarActor = <span class="literal">nullptr</span>;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UPROPERTY</span>()</span><br><span class="line">	AController* SourceController = <span class="literal">nullptr</span>;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UPROPERTY</span>()</span><br><span class="line">	ACharacter* SourceCharacter = <span class="literal">nullptr</span>;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UPROPERTY</span>()</span><br><span class="line">	UAbilitySystemComponent* TargetASC = <span class="literal">nullptr</span>;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UPROPERTY</span>()</span><br><span class="line">	AActor* TargetAvatarActor = <span class="literal">nullptr</span>;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UPROPERTY</span>()</span><br><span class="line">	AController* TargetController = <span class="literal">nullptr</span>;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UPROPERTY</span>()</span><br><span class="line">	ACharacter* TargetCharacter = <span class="literal">nullptr</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="title class_">T</span>&gt;</span><br><span class="line"><span class="keyword">using</span> TStaticFuncPtr = <span class="keyword">typename</span> TBaseStaticDelegateInstance&lt;T, FDefaultDelegateUserPolicy&gt;::FFuncPtr;</span><br><span class="line"></span><br><span class="line"><span class="built_in">UCLASS</span>()</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AURADEMO_API</span> UAuraAttributeSet : <span class="keyword">public</span> UAttributeSet</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">GENERATED_BODY</span>()</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="comment">// 构造函数</span></span><br><span class="line">	<span class="built_in">UAuraAttributeSet</span>();</span><br><span class="line"></span><br><span class="line">	<span class="comment">//复制属性</span></span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">GetLifetimeReplicatedProps</span><span class="params">(TArray&lt;FLifetimeProperty&gt;&amp; OutLifetimeProps)</span> <span class="type">const</span> <span class="keyword">override</span></span>;</span><br><span class="line">	<span class="comment">//预处理属性,改变前调用</span></span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">PreAttributeChange</span><span class="params">(<span class="type">const</span> FGameplayAttribute&amp; Attribute, <span class="type">float</span>&amp; NewValue)</span> <span class="keyword">override</span></span>;</span><br><span class="line">	<span class="comment">//后处理属性,改变后调用</span></span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">PostGameplayEffectExecute</span><span class="params">(<span class="type">const</span> FGameplayEffectModCallbackData&amp; Data)</span> <span class="keyword">override</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	* Primary Attributes</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">	<span class="built_in">UPROPERTY</span>(BlueprintReadOnly, ReplicatedUsing = OnRep_Strength, Category = <span class="string">&quot;Primary Attributes&quot;</span>)</span><br><span class="line">	FGameplayAttributeData Strength;</span><br><span class="line">	<span class="built_in">ATTRIBUTE_ACCESSORS</span>(UAuraAttributeSet, Strength);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UPROPERTY</span>(BlueprintReadOnly, ReplicatedUsing = OnRep_Intelligence, Category = <span class="string">&quot;Primary Attributes&quot;</span>)</span><br><span class="line">	FGameplayAttributeData Intelligence;</span><br><span class="line">	<span class="built_in">ATTRIBUTE_ACCESSORS</span>(UAuraAttributeSet, Intelligence);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UPROPERTY</span>(BlueprintReadOnly, ReplicatedUsing = OnRep_Resilience, Category = <span class="string">&quot;Primary Attributes&quot;</span>)</span><br><span class="line">	FGameplayAttributeData Resilience;</span><br><span class="line">	<span class="built_in">ATTRIBUTE_ACCESSORS</span>(UAuraAttributeSet, Resilience);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UPROPERTY</span>(BlueprintReadOnly, ReplicatedUsing = OnRep_Vigor, Category = <span class="string">&quot;Primary Attributes&quot;</span>)</span><br><span class="line">	FGameplayAttributeData Vigor;</span><br><span class="line">	<span class="built_in">ATTRIBUTE_ACCESSORS</span>(UAuraAttributeSet, Vigor);</span><br><span class="line"></span><br><span class="line">	</span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	 * Secondary Attributes</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="built_in">UPROPERTY</span>(BlueprintReadOnly, ReplicatedUsing = OnRep_Armor, Category = <span class="string">&quot;Secondary Attributes&quot;</span>)</span><br><span class="line">	FGameplayAttributeData Armor;</span><br><span class="line">	<span class="built_in">ATTRIBUTE_ACCESSORS</span>(UAuraAttributeSet, Armor);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UPROPERTY</span>(BlueprintReadOnly, ReplicatedUsing = OnRep_ArmorPenetration, Category = <span class="string">&quot;Secondary Attributes&quot;</span>)</span><br><span class="line">	FGameplayAttributeData ArmorPenetration;</span><br><span class="line">	<span class="built_in">ATTRIBUTE_ACCESSORS</span>(UAuraAttributeSet, ArmorPenetration);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UPROPERTY</span>(BlueprintReadOnly, ReplicatedUsing = OnRep_BlockChance, Category = <span class="string">&quot;Secondary Attributes&quot;</span>)</span><br><span class="line">	FGameplayAttributeData BlockChance;</span><br><span class="line">	<span class="built_in">ATTRIBUTE_ACCESSORS</span>(UAuraAttributeSet, BlockChance);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UPROPERTY</span>(BlueprintReadOnly, ReplicatedUsing = OnRep_CriticalHitChance, Category = <span class="string">&quot;Secondary Attributes&quot;</span>)</span><br><span class="line">	FGameplayAttributeData CriticalHitChance;</span><br><span class="line">	<span class="built_in">ATTRIBUTE_ACCESSORS</span>(UAuraAttributeSet, CriticalHitChance);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UPROPERTY</span>(BlueprintReadOnly, ReplicatedUsing = OnRep_CriticalHitDamage, Category = <span class="string">&quot;Secondary Attributes&quot;</span>)</span><br><span class="line">	FGameplayAttributeData CriticalHitDamage;</span><br><span class="line">	<span class="built_in">ATTRIBUTE_ACCESSORS</span>(UAuraAttributeSet, CriticalHitDamage);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UPROPERTY</span>(BlueprintReadOnly, ReplicatedUsing = OnRep_CriticalHitResistance, Category = <span class="string">&quot;Secondary Attributes&quot;</span>)</span><br><span class="line">	FGameplayAttributeData CriticalHitResistance;</span><br><span class="line">	<span class="built_in">ATTRIBUTE_ACCESSORS</span>(UAuraAttributeSet, CriticalHitResistance);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UPROPERTY</span>(BlueprintReadOnly, ReplicatedUsing = OnRep_HealthRegeneration, Category = <span class="string">&quot;Secondary Attributes&quot;</span>)</span><br><span class="line">	FGameplayAttributeData HealthRegeneration;</span><br><span class="line">	<span class="built_in">ATTRIBUTE_ACCESSORS</span>(UAuraAttributeSet, HealthRegeneration);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UPROPERTY</span>(BlueprintReadOnly, ReplicatedUsing = OnRep_ManaRegeneration, Category = <span class="string">&quot;Secondary Attributes&quot;</span>)</span><br><span class="line">	FGameplayAttributeData ManaRegeneration;</span><br><span class="line">	<span class="built_in">ATTRIBUTE_ACCESSORS</span>(UAuraAttributeSet, ManaRegeneration);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UPROPERTY</span>(BlueprintReadOnly, ReplicatedUsing = OnRep_MaxHealth, Category = <span class="string">&quot;Vital Attributes&quot;</span>)</span><br><span class="line">	FGameplayAttributeData MaxHealth;</span><br><span class="line">	<span class="built_in">ATTRIBUTE_ACCESSORS</span>(UAuraAttributeSet, MaxHealth);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UPROPERTY</span>(BlueprintReadOnly, ReplicatedUsing = OnRep_MaxMana, Category = <span class="string">&quot;Vital Attributes&quot;</span>)</span><br><span class="line">	FGameplayAttributeData MaxMana;</span><br><span class="line">	<span class="built_in">ATTRIBUTE_ACCESSORS</span>(UAuraAttributeSet, MaxMana);</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line">	</span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	 * Resistance Attributes</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="built_in">UPROPERTY</span>(BlueprintReadOnly, ReplicatedUsing = OnRep_FireResistance, Category = <span class="string">&quot;Resistance Attributes&quot;</span>)</span><br><span class="line">	FGameplayAttributeData FireResistance;</span><br><span class="line">	<span class="built_in">ATTRIBUTE_ACCESSORS</span>(UAuraAttributeSet, FireResistance);</span><br><span class="line">	</span><br><span class="line">	<span class="built_in">UPROPERTY</span>(BlueprintReadOnly, ReplicatedUsing = OnRep_LightningResistance, Category = <span class="string">&quot;Resistance Attributes&quot;</span>)</span><br><span class="line">	FGameplayAttributeData LightningResistance;</span><br><span class="line">	<span class="built_in">ATTRIBUTE_ACCESSORS</span>(UAuraAttributeSet, LightningResistance);</span><br><span class="line">	</span><br><span class="line">	<span class="built_in">UPROPERTY</span>(BlueprintReadOnly, ReplicatedUsing = OnRep_ArcaneResistance, Category = <span class="string">&quot;Resistance Attributes&quot;</span>)</span><br><span class="line">	FGameplayAttributeData ArcaneResistance;</span><br><span class="line">	<span class="built_in">ATTRIBUTE_ACCESSORS</span>(UAuraAttributeSet, ArcaneResistance);</span><br><span class="line">	</span><br><span class="line">	<span class="built_in">UPROPERTY</span>(BlueprintReadOnly, ReplicatedUsing = OnRep_PhysicalResistance, Category = <span class="string">&quot;Resistance Attributes&quot;</span>)</span><br><span class="line">	FGameplayAttributeData PhysicalResistance;</span><br><span class="line">	<span class="built_in">ATTRIBUTE_ACCESSORS</span>(UAuraAttributeSet, PhysicalResistance);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	* Vital Attributes</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">	<span class="built_in">UPROPERTY</span>(BlueprintReadOnly, ReplicatedUsing = OnRep_Health, Category = <span class="string">&quot;Vital Attributes&quot;</span>)</span><br><span class="line">	FGameplayAttributeData Health;</span><br><span class="line">	<span class="built_in">ATTRIBUTE_ACCESSORS</span>(UAuraAttributeSet, Health);</span><br><span class="line">	</span><br><span class="line">	<span class="built_in">UPROPERTY</span>(BlueprintReadOnly, ReplicatedUsing = OnRep_Mana, Category = <span class="string">&quot;Vital Attributes&quot;</span>)</span><br><span class="line">	FGameplayAttributeData Mana;</span><br><span class="line">	<span class="built_in">ATTRIBUTE_ACCESSORS</span>(UAuraAttributeSet, Mana);</span><br><span class="line"></span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	* Meta Attributes</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">	<span class="built_in">UPROPERTY</span>(BlueprintReadOnly, Category = <span class="string">&quot;Meta Attributes&quot;</span>)</span><br><span class="line">	FGameplayAttributeData IncomingDamage;</span><br><span class="line">	<span class="built_in">ATTRIBUTE_ACCESSORS</span>(UAuraAttributeSet, IncomingDamage);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UPROPERTY</span>(BlueprintReadOnly, Category = <span class="string">&quot;Meta Attributes&quot;</span>)</span><br><span class="line">	FGameplayAttributeData IncomingXP;</span><br><span class="line">	<span class="built_in">ATTRIBUTE_ACCESSORS</span>(UAuraAttributeSet, IncomingXP);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UFUNCTION</span>()</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">OnRep_Health</span><span class="params">(<span class="type">const</span> FGameplayAttributeData&amp; OldHealth)</span> <span class="type">const</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UFUNCTION</span>()</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">OnRep_Mana</span><span class="params">(<span class="type">const</span> FGameplayAttributeData&amp; OldMana)</span> <span class="type">const</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UFUNCTION</span>()</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">OnRep_Strength</span><span class="params">(<span class="type">const</span> FGameplayAttributeData&amp; OldStrength)</span> <span class="type">const</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UFUNCTION</span>()</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">OnRep_Intelligence</span><span class="params">(<span class="type">const</span> FGameplayAttributeData&amp; OldIntelligence)</span> <span class="type">const</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UFUNCTION</span>()</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">OnRep_Resilience</span><span class="params">(<span class="type">const</span> FGameplayAttributeData&amp; OldResilience)</span> <span class="type">const</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UFUNCTION</span>()</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">OnRep_Vigor</span><span class="params">(<span class="type">const</span> FGameplayAttributeData&amp; OldVigor)</span> <span class="type">const</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UFUNCTION</span>()</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">OnRep_Armor</span><span class="params">(<span class="type">const</span> FGameplayAttributeData&amp; OldArmor)</span> <span class="type">const</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UFUNCTION</span>()</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">OnRep_ArmorPenetration</span><span class="params">(<span class="type">const</span> FGameplayAttributeData&amp; OldArmorPenetration)</span> <span class="type">const</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UFUNCTION</span>()</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">OnRep_BlockChance</span><span class="params">(<span class="type">const</span> FGameplayAttributeData&amp; OldBlockChance)</span> <span class="type">const</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UFUNCTION</span>()</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">OnRep_CriticalHitChance</span><span class="params">(<span class="type">const</span> FGameplayAttributeData&amp; OldCriticalHitChance)</span> <span class="type">const</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UFUNCTION</span>()</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">OnRep_CriticalHitDamage</span><span class="params">(<span class="type">const</span> FGameplayAttributeData&amp; OldCriticalHitDamage)</span> <span class="type">const</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UFUNCTION</span>()</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">OnRep_CriticalHitResistance</span><span class="params">(<span class="type">const</span> FGameplayAttributeData&amp; OldCriticalHitResistance)</span> <span class="type">const</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UFUNCTION</span>()</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">OnRep_HealthRegeneration</span><span class="params">(<span class="type">const</span> FGameplayAttributeData&amp; OldHealthRegeneration)</span> <span class="type">const</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UFUNCTION</span>()</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">OnRep_ManaRegeneration</span><span class="params">(<span class="type">const</span> FGameplayAttributeData&amp; OldManaRegeneration)</span> <span class="type">const</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UFUNCTION</span>()</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">OnRep_MaxHealth</span><span class="params">(<span class="type">const</span> FGameplayAttributeData&amp; OldMaxHealth)</span> <span class="type">const</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UFUNCTION</span>()</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">OnRep_MaxMana</span><span class="params">(<span class="type">const</span> FGameplayAttributeData&amp; OldMaxMana)</span> <span class="type">const</span></span>;	</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UFUNCTION</span>()</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">OnRep_FireResistance</span><span class="params">(<span class="type">const</span> FGameplayAttributeData&amp; OldFireResistance)</span> <span class="type">const</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UFUNCTION</span>()</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">OnRep_LightningResistance</span><span class="params">(<span class="type">const</span> FGameplayAttributeData&amp; OldLightningResistance)</span> <span class="type">const</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UFUNCTION</span>()</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">OnRep_ArcaneResistance</span><span class="params">(<span class="type">const</span> FGameplayAttributeData&amp; OldArcaneResistance)</span> <span class="type">const</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UFUNCTION</span>()</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">OnRep_PhysicalResistance</span><span class="params">(<span class="type">const</span> FGameplayAttributeData&amp; OldPhysicalResistance)</span> <span class="type">const</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="comment">// 设置效果属性</span></span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">SetEffectProperties</span><span class="params">(<span class="type">const</span> FGameplayEffectModCallbackData&amp; Data, FEffectProperties&amp; Props)</span> <span class="type">const</span></span>;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="comment">//标签委托字典</span></span><br><span class="line">	<span class="comment">// TMap&lt;FGameplayTag, FAttributeSignature&gt; TagsToAttributes;</span></span><br><span class="line">	<span class="comment">//TMap&lt;FGameplayTag, FGameplayAttribute(*)()&gt; TagsToAttributes;</span></span><br><span class="line">	TMap&lt;FGameplayTag, TStaticFuncPtr&lt;<span class="built_in">FGameplayAttribute</span>()&gt;&gt; TagsToAttributes;</span><br><span class="line">	</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>源文件</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Fill out your copyright notice in the Description page of Project Settings.</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;AbilitySystem/AuraAttributeSet.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;AbilitySystemBlueprintLibrary.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;GameplayEffectExtension.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;AbilitySystem/GameplayTags/AuraGameplayTags.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;GameFramework/Character.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Net/UnrealNetwork.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;UI/WidgetController/AttributeMenuWidgetController.h&quot;</span></span></span><br><span class="line"><span class="comment">//GAMEPLAYATTRIBUTE_REPNOTIFY(UAuraAttributeSet, Health, OldHealth);</span></span><br><span class="line">UAuraAttributeSet::<span class="built_in">UAuraAttributeSet</span>()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//获取标签结构体</span></span><br><span class="line">	<span class="type">const</span> FAuraGameplayTags&amp; GameplayTags = FAuraGameplayTags::<span class="built_in">Get</span>();</span><br><span class="line"></span><br><span class="line">	<span class="comment">/* Primary Attributes */</span></span><br><span class="line">	TagsToAttributes.<span class="built_in">Add</span>(GameplayTags.Attributes_Primary_Strength, GetStrengthAttribute);</span><br><span class="line">	TagsToAttributes.<span class="built_in">Add</span>(GameplayTags.Attributes_Primary_Intelligence, GetIntelligenceAttribute);</span><br><span class="line">	TagsToAttributes.<span class="built_in">Add</span>(GameplayTags.Attributes_Primary_Resilience, GetResilienceAttribute);</span><br><span class="line">	TagsToAttributes.<span class="built_in">Add</span>(GameplayTags.Attributes_Primary_Vigor, GetVigorAttribute);</span><br><span class="line"></span><br><span class="line">	<span class="comment">/* Secondary Attributes */</span></span><br><span class="line">	TagsToAttributes.<span class="built_in">Add</span>(GameplayTags.Attributes_Secondary_Armor, GetArmorAttribute);</span><br><span class="line">	TagsToAttributes.<span class="built_in">Add</span>(GameplayTags.Attributes_Secondary_ArmorPenetration, GetArmorPenetrationAttribute);</span><br><span class="line">	TagsToAttributes.<span class="built_in">Add</span>(GameplayTags.Attributes_Secondary_BlockChance, GetBlockChanceAttribute);	</span><br><span class="line">	TagsToAttributes.<span class="built_in">Add</span>(GameplayTags.Attributes_Secondary_CriticalHitChance, GetCriticalHitChanceAttribute);</span><br><span class="line">	TagsToAttributes.<span class="built_in">Add</span>(GameplayTags.Attributes_Secondary_CriticalHitResistance, GetCriticalHitResistanceAttribute);</span><br><span class="line">	TagsToAttributes.<span class="built_in">Add</span>(GameplayTags.Attributes_Secondary_CriticalHitDamage, GetCriticalHitDamageAttribute);</span><br><span class="line">	TagsToAttributes.<span class="built_in">Add</span>(GameplayTags.Attributes_Secondary_HealthRegeneration, GetHealthRegenerationAttribute);</span><br><span class="line">	TagsToAttributes.<span class="built_in">Add</span>(GameplayTags.Attributes_Secondary_ManaRegeneration, GetManaRegenerationAttribute);</span><br><span class="line">	TagsToAttributes.<span class="built_in">Add</span>(GameplayTags.Attributes_Secondary_MaxHealth, GetMaxHealthAttribute);</span><br><span class="line">	TagsToAttributes.<span class="built_in">Add</span>(GameplayTags.Attributes_Secondary_MaxMana, GetMaxManaAttribute);</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/* Resistance Attributes */</span></span><br><span class="line">	<span class="comment">// TagsToAttributes.Add(GameplayTags.Attributes_Resistance_Arcane, GetArcaneResistanceAttribute);</span></span><br><span class="line">	<span class="comment">// TagsToAttributes.Add(GameplayTags.Attributes_Resistance_Fire, GetFireResistanceAttribute);</span></span><br><span class="line">	<span class="comment">// TagsToAttributes.Add(GameplayTags.Attributes_Resistance_Lightning, GetLightningResistanceAttribute);</span></span><br><span class="line">	<span class="comment">// TagsToAttributes.Add(GameplayTags.Attributes_Resistance_Physical, GetPhysicalResistanceAttribute);</span></span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UAuraAttributeSet::GetLifetimeReplicatedProps</span><span class="params">(TArray&lt;FLifetimeProperty&gt;&amp; OutLifetimeProps)</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	Super::<span class="built_in">GetLifetimeReplicatedProps</span>(OutLifetimeProps);</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// Primary Attributes</span></span><br><span class="line">	</span><br><span class="line">	<span class="built_in">DOREPLIFETIME_CONDITION_NOTIFY</span>(UAuraAttributeSet, Strength, COND_None, REPNOTIFY_Always);</span><br><span class="line">	<span class="built_in">DOREPLIFETIME_CONDITION_NOTIFY</span>(UAuraAttributeSet, Intelligence, COND_None, REPNOTIFY_Always);</span><br><span class="line">	<span class="built_in">DOREPLIFETIME_CONDITION_NOTIFY</span>(UAuraAttributeSet, Resilience, COND_None, REPNOTIFY_Always);</span><br><span class="line">	<span class="built_in">DOREPLIFETIME_CONDITION_NOTIFY</span>(UAuraAttributeSet, Vigor, COND_None, REPNOTIFY_Always);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Secondary Attributes</span></span><br><span class="line"></span><br><span class="line">	<span class="built_in">DOREPLIFETIME_CONDITION_NOTIFY</span>(UAuraAttributeSet, Armor, COND_None, REPNOTIFY_Always);</span><br><span class="line">	<span class="built_in">DOREPLIFETIME_CONDITION_NOTIFY</span>(UAuraAttributeSet, ArmorPenetration, COND_None, REPNOTIFY_Always);</span><br><span class="line">	<span class="built_in">DOREPLIFETIME_CONDITION_NOTIFY</span>(UAuraAttributeSet, BlockChance, COND_None, REPNOTIFY_Always);</span><br><span class="line">	<span class="built_in">DOREPLIFETIME_CONDITION_NOTIFY</span>(UAuraAttributeSet, CriticalHitChance, COND_None, REPNOTIFY_Always);</span><br><span class="line">	<span class="built_in">DOREPLIFETIME_CONDITION_NOTIFY</span>(UAuraAttributeSet, CriticalHitDamage, COND_None, REPNOTIFY_Always);</span><br><span class="line">	<span class="built_in">DOREPLIFETIME_CONDITION_NOTIFY</span>(UAuraAttributeSet, CriticalHitResistance, COND_None, REPNOTIFY_Always);</span><br><span class="line">	<span class="built_in">DOREPLIFETIME_CONDITION_NOTIFY</span>(UAuraAttributeSet, HealthRegeneration, COND_None, REPNOTIFY_Always);	</span><br><span class="line">	<span class="built_in">DOREPLIFETIME_CONDITION_NOTIFY</span>(UAuraAttributeSet, ManaRegeneration, COND_None, REPNOTIFY_Always);	</span><br><span class="line">	<span class="built_in">DOREPLIFETIME_CONDITION_NOTIFY</span>(UAuraAttributeSet, MaxHealth, COND_None, REPNOTIFY_Always);	</span><br><span class="line">	<span class="built_in">DOREPLIFETIME_CONDITION_NOTIFY</span>(UAuraAttributeSet, MaxMana, COND_None, REPNOTIFY_Always);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Resistance Attributes</span></span><br><span class="line"></span><br><span class="line">	<span class="built_in">DOREPLIFETIME_CONDITION_NOTIFY</span>(UAuraAttributeSet, FireResistance, COND_None, REPNOTIFY_Always);</span><br><span class="line">	<span class="built_in">DOREPLIFETIME_CONDITION_NOTIFY</span>(UAuraAttributeSet, LightningResistance, COND_None, REPNOTIFY_Always);</span><br><span class="line">	<span class="built_in">DOREPLIFETIME_CONDITION_NOTIFY</span>(UAuraAttributeSet, ArcaneResistance, COND_None, REPNOTIFY_Always);</span><br><span class="line">	<span class="built_in">DOREPLIFETIME_CONDITION_NOTIFY</span>(UAuraAttributeSet, PhysicalResistance, COND_None, REPNOTIFY_Always);</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// Vital Attributes</span></span><br><span class="line">	</span><br><span class="line">	<span class="built_in">DOREPLIFETIME_CONDITION_NOTIFY</span>(UAuraAttributeSet, Health, COND_None, REPNOTIFY_Always);</span><br><span class="line">	<span class="built_in">DOREPLIFETIME_CONDITION_NOTIFY</span>(UAuraAttributeSet, Mana, COND_None, REPNOTIFY_Always);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//属性改变前调用,限制最大值</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UAuraAttributeSet::PreAttributeChange</span><span class="params">(<span class="type">const</span> FGameplayAttribute&amp; Attribute, <span class="type">float</span>&amp; NewValue)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	Super::<span class="built_in">PreAttributeChange</span>(Attribute, NewValue);</span><br><span class="line">	<span class="keyword">if</span>(Attribute == <span class="built_in">GetHealthAttribute</span>())</span><br><span class="line">	&#123;</span><br><span class="line">		NewValue = FMath::<span class="built_in">Clamp</span>(NewValue, <span class="number">0.f</span>, <span class="built_in">GetMaxHealth</span>());</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(Attribute == <span class="built_in">GetManaAttribute</span>())</span><br><span class="line">	&#123;</span><br><span class="line">		NewValue = FMath::<span class="built_in">Clamp</span>(NewValue, <span class="number">0.f</span>, <span class="built_in">GetMaxMana</span>());</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//属性改变后调用,用于限制属性最大值</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UAuraAttributeSet::PostGameplayEffectExecute</span><span class="params">(<span class="type">const</span> FGameplayEffectModCallbackData&amp; Data)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	Super::<span class="built_in">PostGameplayEffectExecute</span>(Data);</span><br><span class="line">	FEffectProperties Props;</span><br><span class="line">	<span class="built_in">SetEffectProperties</span>(Data, Props);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// if(Props.TargetCharacter-&gt;Implements&lt;UCombatInterface&gt;() &amp;&amp; ICombatInterface::Execute_IsDead(Props.TargetCharacter)) return;</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (Data.EvaluatedData.Attribute == <span class="built_in">GetHealthAttribute</span>())</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">SetHealth</span>(FMath::<span class="built_in">Clamp</span>(<span class="built_in">GetHealth</span>(), <span class="number">0.f</span>, <span class="built_in">GetMaxHealth</span>()));</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (Data.EvaluatedData.Attribute == <span class="built_in">GetManaAttribute</span>())</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">SetMana</span>(FMath::<span class="built_in">Clamp</span>(<span class="built_in">GetMana</span>(), <span class="number">0.f</span>, <span class="built_in">GetMaxMana</span>()));</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//设置效果属性,在属性集类改变属性后调用</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UAuraAttributeSet::SetEffectProperties</span><span class="params">(<span class="type">const</span> FGameplayEffectModCallbackData&amp; Data, FEffectProperties&amp; Props)</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">//结构体设置效果上下文</span></span><br><span class="line">	Props.EffectContextHandle = Data.EffectSpec.<span class="built_in">GetContext</span>();</span><br><span class="line">	<span class="comment">//结构体设置能力系统组件</span></span><br><span class="line">	Props.SourceASC = Props.EffectContextHandle.<span class="built_in">GetOriginalInstigatorAbilitySystemComponent</span>();</span><br><span class="line"></span><br><span class="line">	<span class="comment">//如果能力组件有效和角色有效</span></span><br><span class="line">	<span class="keyword">if</span> (<span class="built_in">IsValid</span>(Props.SourceASC) &amp;&amp; Props.SourceASC-&gt;AbilityActorInfo.<span class="built_in">IsValid</span>() &amp;&amp; Props.SourceASC-&gt;AbilityActorInfo-&gt;AvatarActor.<span class="built_in">IsValid</span>())</span><br><span class="line">	&#123;</span><br><span class="line">		Props.SourceAvatarActor = Props.SourceASC-&gt;AbilityActorInfo-&gt;AvatarActor.<span class="built_in">Get</span>();</span><br><span class="line">		Props.SourceController = Props.SourceASC-&gt;AbilityActorInfo-&gt;PlayerController.<span class="built_in">Get</span>();</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 如果角色无效，则从角色中获取</span></span><br><span class="line">		<span class="keyword">if</span> (Props.SourceController == <span class="literal">nullptr</span> &amp;&amp; Props.SourceAvatarActor != <span class="literal">nullptr</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span> (<span class="type">const</span> APawn* Pawn = <span class="built_in">Cast</span>&lt;APawn&gt;(Props.SourceAvatarActor))</span><br><span class="line">			&#123;</span><br><span class="line">				Props.SourceController = Pawn-&gt;<span class="built_in">GetController</span>();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">// 如果角色有效，则从角色中获取</span></span><br><span class="line">		<span class="keyword">if</span> (Props.SourceController)</span><br><span class="line">		&#123;</span><br><span class="line">			Props.SourceCharacter = <span class="built_in">Cast</span>&lt;ACharacter&gt;(Props.SourceController-&gt;<span class="built_in">GetPawn</span>());</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//如果目标有效和角色有效</span></span><br><span class="line">	<span class="keyword">if</span> (Data.Target.AbilityActorInfo.<span class="built_in">IsValid</span>() &amp;&amp; Data.Target.AbilityActorInfo-&gt;AvatarActor.<span class="built_in">IsValid</span>())</span><br><span class="line">	&#123;</span><br><span class="line">		Props.TargetAvatarActor = Data.Target.AbilityActorInfo-&gt;AvatarActor.<span class="built_in">Get</span>();</span><br><span class="line">		Props.TargetController = Data.Target.AbilityActorInfo-&gt;PlayerController.<span class="built_in">Get</span>();</span><br><span class="line">		Props.TargetCharacter = <span class="built_in">Cast</span>&lt;ACharacter&gt;(Props.TargetAvatarActor);</span><br><span class="line">		Props.TargetASC = UAbilitySystemBlueprintLibrary::<span class="built_in">GetAbilitySystemComponent</span>(Props.TargetAvatarActor);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UAuraAttributeSet::OnRep_Health</span><span class="params">(<span class="type">const</span> FGameplayAttributeData&amp; OldHealth)</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">GAMEPLAYATTRIBUTE_REPNOTIFY</span>(UAuraAttributeSet, Health, OldHealth);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UAuraAttributeSet::OnRep_Mana</span><span class="params">(<span class="type">const</span> FGameplayAttributeData&amp; OldMana)</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">GAMEPLAYATTRIBUTE_REPNOTIFY</span>(UAuraAttributeSet, Mana, OldMana);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UAuraAttributeSet::OnRep_Strength</span><span class="params">(<span class="type">const</span> FGameplayAttributeData&amp; OldStrength)</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">GAMEPLAYATTRIBUTE_REPNOTIFY</span>(UAuraAttributeSet, Strength, OldStrength);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UAuraAttributeSet::OnRep_Intelligence</span><span class="params">(<span class="type">const</span> FGameplayAttributeData&amp; OldIntelligence)</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">GAMEPLAYATTRIBUTE_REPNOTIFY</span>(UAuraAttributeSet, Intelligence, OldIntelligence);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UAuraAttributeSet::OnRep_Resilience</span><span class="params">(<span class="type">const</span> FGameplayAttributeData&amp; OldResilience)</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">GAMEPLAYATTRIBUTE_REPNOTIFY</span>(UAuraAttributeSet, Resilience, OldResilience);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UAuraAttributeSet::OnRep_Vigor</span><span class="params">(<span class="type">const</span> FGameplayAttributeData&amp; OldVigor)</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">GAMEPLAYATTRIBUTE_REPNOTIFY</span>(UAuraAttributeSet, Vigor, OldVigor);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UAuraAttributeSet::OnRep_Armor</span><span class="params">(<span class="type">const</span> FGameplayAttributeData&amp; OldArmor)</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">GAMEPLAYATTRIBUTE_REPNOTIFY</span>(UAuraAttributeSet, Armor, OldArmor);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UAuraAttributeSet::OnRep_ArmorPenetration</span><span class="params">(<span class="type">const</span> FGameplayAttributeData&amp; OldArmorPenetration)</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">GAMEPLAYATTRIBUTE_REPNOTIFY</span>(UAuraAttributeSet, ArmorPenetration, OldArmorPenetration);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UAuraAttributeSet::OnRep_BlockChance</span><span class="params">(<span class="type">const</span> FGameplayAttributeData&amp; OldBlockChance)</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">GAMEPLAYATTRIBUTE_REPNOTIFY</span>(UAuraAttributeSet, BlockChance, OldBlockChance);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UAuraAttributeSet::OnRep_CriticalHitChance</span><span class="params">(<span class="type">const</span> FGameplayAttributeData&amp; OldCriticalHitChance)</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">GAMEPLAYATTRIBUTE_REPNOTIFY</span>(UAuraAttributeSet, CriticalHitChance, OldCriticalHitChance);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UAuraAttributeSet::OnRep_CriticalHitDamage</span><span class="params">(<span class="type">const</span> FGameplayAttributeData&amp; OldCriticalHitDamage)</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">GAMEPLAYATTRIBUTE_REPNOTIFY</span>(UAuraAttributeSet, CriticalHitDamage, OldCriticalHitDamage);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UAuraAttributeSet::OnRep_CriticalHitResistance</span><span class="params">(<span class="type">const</span> FGameplayAttributeData&amp; OldCriticalHitResistance)</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">GAMEPLAYATTRIBUTE_REPNOTIFY</span>(UAuraAttributeSet, CriticalHitResistance, OldCriticalHitResistance);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UAuraAttributeSet::OnRep_HealthRegeneration</span><span class="params">(<span class="type">const</span> FGameplayAttributeData&amp; OldHealthRegeneration)</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">GAMEPLAYATTRIBUTE_REPNOTIFY</span>(UAuraAttributeSet, HealthRegeneration, OldHealthRegeneration);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UAuraAttributeSet::OnRep_ManaRegeneration</span><span class="params">(<span class="type">const</span> FGameplayAttributeData&amp; OldManaRegeneration)</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">GAMEPLAYATTRIBUTE_REPNOTIFY</span>(UAuraAttributeSet, ManaRegeneration, OldManaRegeneration);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UAuraAttributeSet::OnRep_MaxHealth</span><span class="params">(<span class="type">const</span> FGameplayAttributeData&amp; OldMaxHealth)</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">GAMEPLAYATTRIBUTE_REPNOTIFY</span>(UAuraAttributeSet, MaxHealth, OldMaxHealth);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UAuraAttributeSet::OnRep_MaxMana</span><span class="params">(<span class="type">const</span> FGameplayAttributeData&amp; OldMaxMana)</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">GAMEPLAYATTRIBUTE_REPNOTIFY</span>(UAuraAttributeSet, MaxMana, OldMaxMana);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UAuraAttributeSet::OnRep_FireResistance</span><span class="params">(<span class="type">const</span> FGameplayAttributeData&amp; OldFireResistance)</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">GAMEPLAYATTRIBUTE_REPNOTIFY</span>(UAuraAttributeSet, FireResistance, OldFireResistance);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UAuraAttributeSet::OnRep_LightningResistance</span><span class="params">(<span class="type">const</span> FGameplayAttributeData&amp; OldLightningResistance)</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">GAMEPLAYATTRIBUTE_REPNOTIFY</span>(UAuraAttributeSet, LightningResistance, OldLightningResistance);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UAuraAttributeSet::OnRep_ArcaneResistance</span><span class="params">(<span class="type">const</span> FGameplayAttributeData&amp; OldArcaneResistance)</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">GAMEPLAYATTRIBUTE_REPNOTIFY</span>(UAuraAttributeSet, ArcaneResistance, OldArcaneResistance);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UAuraAttributeSet::OnRep_PhysicalResistance</span><span class="params">(<span class="type">const</span> FGameplayAttributeData&amp; OldPhysicalResistance)</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">GAMEPLAYATTRIBUTE_REPNOTIFY</span>(UAuraAttributeSet, PhysicalResistance, OldPhysicalResistance);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="源码说明"><a href="#源码说明" class="headerlink" title="源码说明"></a>源码说明</h3><ul>
<li><p>头文件</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">`<span class="meta">#<span class="keyword">include</span> <span class="string">&quot;AbilitySystemComponent.h&quot;</span>`组件头文件，需要使用AbilitySystemComponent类必须加载该头文件</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>宏定义用于自动生成类属性的访问器方法</p>
<p>命名规范：确保宏中的方法名称符合项目的命名规范。<br>线程安全：如果属性在多线程环境中使用，考虑添加必要的同步机制。<br>性能优化：对于频繁访问的属性，可以考虑使用内联函数以提高性能。<br>通过这种方式，可以大大简化属性访问器的编写，提高代码的可维护性和一致性。</p>
</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ATTRIBUTE_ACCESSORS 宏定义用于自动生成类属性的访问器方法</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ATTRIBUTE_ACCESSORS(ClassName, PropertyName) \</span></span><br><span class="line"><span class="meta">GAMEPLAYATTRIBUTE_PROPERTY_GETTER(ClassName, PropertyName) \ <span class="comment">//生成一个获取属性的方法，通常返回属性的引用或值</span></span></span><br><span class="line"><span class="built_in">GAMEPLAYATTRIBUTE_VALUE_GETTER</span>(PropertyName) \  <span class="comment">//生成一个获取属性值的方法，通常返回属性的值</span></span><br><span class="line"><span class="built_in">GAMEPLAYATTRIBUTE_VALUE_SETTER</span>(PropertyName) \  <span class="comment">//生成一个设置属性值的方法，通常接受一个参数并更新属性的值。</span></span><br><span class="line"><span class="built_in">GAMEPLAYATTRIBUTE_VALUE_INITTER</span>(PropertyName)   <span class="comment">//生成一个初始化属性值的方法，通常用于在构造函数或其他初始化方法中设置属性的初始值</span></span><br></pre></td></tr></table></figure>

<p>​	假设我们有一个类 Character，并且希望为属性 Health 生成访问器方法，可以这样使用宏：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Character</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// 使用宏生成访问器方法</span></span><br><span class="line">    <span class="built_in">ATTRIBUTE_ACCESSORS</span>(Character, Health)</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="type">float</span> Health;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>​	展开后的代码<br>​	宏展开后，生成的代码可能类似于以下内容：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Character</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// 获取属性的方法</span></span><br><span class="line">    <span class="function"><span class="type">float</span>&amp; <span class="title">GetHealth</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> Health; &#125;</span><br><span class="line">    <span class="function"><span class="type">const</span> <span class="type">float</span>&amp; <span class="title">GetHealth</span><span class="params">()</span> <span class="type">const</span> </span>&#123; <span class="keyword">return</span> Health; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取属性值的方法</span></span><br><span class="line">    <span class="function"><span class="type">float</span> <span class="title">GetHealthValue</span><span class="params">()</span> <span class="type">const</span> </span>&#123; <span class="keyword">return</span> Health; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 设置属性值的方法</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">SetHealthValue</span><span class="params">(<span class="type">float</span> NewValue)</span> </span>&#123; Health = NewValue; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 初始化属性值的方法</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">InitHealthValue</span><span class="params">(<span class="type">float</span> InitialValue)</span> </span>&#123; Health = InitialValue; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="type">float</span> Health;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="在玩家类中初始化"><a href="#在玩家类中初始化" class="headerlink" title="在玩家类中初始化"></a>在玩家类中初始化</h2><ul>
<li><p>因为玩家角色在游戏中死亡会被销毁释放，属性也会跟着被释放掉，为了避免这种情况，我们需要将玩家属性和玩家分开，我们可以通过PlayerState类配置玩家的属性，玩家再从PlayerState类里获取属性，这样即使玩家被释放了复活后依旧可以从这里获取属性</p>
</li>
<li><p>新建一个继承自PlayerState的类StestPlayerState</p>
</li>
<li><p>StestPlayerState源码如下</p>
<ul>
<li>头文件</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">pragma</span> once</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;CoreMinimal.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;AbilitySystemInterface.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;GameFramework/PlayerState.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;StestPlayerState.generated.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">//前向声明</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UAbilitySystemComponent</span>;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UAttributeSet</span>;</span><br><span class="line"><span class="built_in">UCLASS</span>()</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">GASDEMO_API</span> AStestPlayerState : <span class="keyword">public</span> APlayerState,<span class="keyword">public</span> IAbilitySystemInterface</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">GENERATED_BODY</span>()</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">AStestPlayerState</span>();</span><br><span class="line">    <span class="comment">//重写组件虚函数</span></span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> UAbilitySystemComponent* <span class="title">GetAbilitySystemComponent</span><span class="params">()</span> <span class="type">const</span> <span class="keyword">override</span></span>;</span><br><span class="line">    <span class="comment">//AttributeSet，属于AbilitySystemComponent</span></span><br><span class="line">	<span class="function">UAttributeSet* <span class="title">GetAttributeSet</span><span class="params">()</span> <span class="type">const</span> </span>&#123; <span class="keyword">return</span> AttributeSet; &#125;</span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">	</span><br><span class="line">	<span class="built_in">UPROPERTY</span>()</span><br><span class="line">	<span class="comment">//指向UAbilitySystemComponent的智能指针，用于管理玩家的能力和效果。</span></span><br><span class="line">	TObjectPtr&lt;UAbilitySystemComponent&gt; AbilitySystemComponent;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UPROPERTY</span>()</span><br><span class="line">	<span class="comment">//指向UAttributeSet的智能指针，用于存储玩家的属性值，如生命值、魔法值等</span></span><br><span class="line">	TObjectPtr&lt;UAttributeSet&gt; AttributeSet;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<ul>
<li>源文件</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Player/StestPlayerState.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;AbilitySystem/AuraAbilitySystemComponent.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;AbilitySystem/AuraAttributeSet.h&quot;</span></span></span><br><span class="line"></span><br><span class="line">AStestPlayerState::<span class="built_in">AStestPlayerState</span>()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//创建能力组件</span></span><br><span class="line">	AbilitySystemComponent = <span class="built_in">CreateDefaultSubobject</span>&lt;UAuraAbilitySystemComponent&gt;(<span class="string">&quot;AbilitySystemComponent&quot;</span>);</span><br><span class="line">	AbilitySystemComponent-&gt;<span class="built_in">SetIsReplicated</span>(<span class="literal">true</span>);</span><br><span class="line">	AbilitySystemComponent-&gt;<span class="built_in">SetReplicationMode</span>(EGameplayEffectReplicationMode::Mixed);</span><br><span class="line">	AttributeSet = <span class="built_in">CreateDefaultSubobject</span>&lt;UAuraAttributeSet&gt;(<span class="string">&quot;AttributeSet&quot;</span>);</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//这段C++代码是Unreal Engine中的一部分，用于设置一个玩家状态(AStestPlayerState)的网络更新频率</span></span><br><span class="line">	NetUpdateFrequency=<span class="number">100.f</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//接口继承的方法，返回AbilitySystemComponent</span></span><br><span class="line"><span class="function">UAbilitySystemComponent* <span class="title">AStestPlayerState::GetAbilitySystemComponent</span><span class="params">()</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> AbilitySystemComponent;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>角色基类源码如下,因为怪物和玩家都有能力组件，所以创建一个角色基类，玩家和怪物都继承自这个类，他们都有能力组件，不过初始化需要分开在子类中初始化，因为玩家的属性是分离的，怪物的不是。<code>注：记得前向声明</code></p>
<ul>
<li>头文件</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">pragma</span> once</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;CoreMinimal.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;GameFramework/Character.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;AbilitySystemInterface.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;AuraCharacterBase.generated.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UAbilitySystemComponent</span>;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UAttributeSet</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">UCLASS</span>()</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AURADEMO_API</span> AAuraCharacterBase : <span class="keyword">public</span> ACharacter,<span class="keyword">public</span> IAbilitySystemInterface</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">GENERATED_BODY</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">AAuraCharacterBase</span>();</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> UAbilitySystemComponent* <span class="title">GetAbilitySystemComponent</span><span class="params">()</span> <span class="type">const</span> <span class="keyword">override</span></span>;</span><br><span class="line">	<span class="function">UAttributeSet* <span class="title">GetAttributeSet</span><span class="params">()</span> <span class="type">const</span> </span>&#123; <span class="keyword">return</span> AttributeSet; &#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">BeginPlay</span><span class="params">()</span> <span class="keyword">override</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//玩家能力组件AbilitySystemComponent</span></span><br><span class="line">	<span class="built_in">UPROPERTY</span>()</span><br><span class="line">	TObjectPtr&lt;UAbilitySystemComponent&gt; AbilitySystemComponent;</span><br><span class="line">	<span class="comment">//玩家属性组件AttributeSet</span></span><br><span class="line">	<span class="built_in">UPROPERTY</span>()</span><br><span class="line">	TObjectPtr&lt;UAttributeSet&gt; AttributeSet;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<ul>
<li>源文件</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">UAbilitySystemComponent* <span class="title">AAuraCharacterBase::GetAbilitySystemComponent</span><span class="params">()</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> AbilitySystemComponent;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>玩家源码，继承自角色基类</p>
<ul>
<li>头文件</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">pragma</span> once</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;CoreMinimal.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;AuraCharacterBase.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;AuraCharacter.generated.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="built_in">UCLASS</span>()</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AURADEMO_API</span> AAuraCharacter : <span class="keyword">public</span> AAuraCharacterBase</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">GENERATED_BODY</span>()</span><br><span class="line"><span class="keyword">public</span>:	</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span>  <span class="type">void</span> <span class="title">PossessedBy</span><span class="params">(AController* NewController)</span> <span class="keyword">override</span></span>;</span><br><span class="line">	<span class="comment">//网络同步相关</span></span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">OnRep_PlayerState</span><span class="params">()</span> <span class="keyword">override</span></span>;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">InitAbilityActorInfo</span><span class="params">()</span></span>;</span><br><span class="line">	</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<ul>
<li>源文件</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Character/AuraCharacter.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;AbilitySystem/AuraAbilitySystemComponent.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Player/AuraPlayerState.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">AAuraCharacter::PossessedBy</span><span class="params">(AController* NewController)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	Super::<span class="built_in">PossessedBy</span>(NewController);</span><br><span class="line">	<span class="built_in">InitAbilityActorInfo</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">AAuraCharacter::OnRep_PlayerState</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	Super::<span class="built_in">OnRep_PlayerState</span>();</span><br><span class="line">	<span class="built_in">InitAbilityActorInfo</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">AAuraCharacter::InitAbilityActorInfo</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">//获取玩家状态单例</span></span><br><span class="line">	AAuraPlayerState* AuraPlayerState = <span class="built_in">GetPlayerState</span>&lt;AAuraPlayerState&gt;();</span><br><span class="line">	<span class="built_in">check</span>(AuraPlayerState);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 这行代码的作用是初始化 AbilitySystemComponent 的 Actor 信息。</span></span><br><span class="line">	<span class="comment">// 具体来说，它将 AuraPlayerState 和 当前对象 (this) 作为参数传递给 InitAbilityActorInfo 方法。</span></span><br><span class="line">	AuraPlayerState-&gt;<span class="built_in">GetAbilitySystemComponent</span>()-&gt;<span class="built_in">InitAbilityActorInfo</span>(AuraPlayerState, <span class="keyword">this</span>); <span class="comment">//如果是怪物则AuraPlayerState改为this</span></span><br><span class="line">    </span><br><span class="line">	<span class="built_in">Cast</span>&lt;UAuraAbilitySystemComponent&gt;(AuraPlayerState-&gt;<span class="built_in">GetAbilitySystemComponent</span>())-&gt;<span class="built_in">AbilityActorInfoSet</span>();<span class="comment">//绑定委托,未实现</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">//将玩玩家的属性和能力设置为玩家状态单例的属性和能力</span></span><br><span class="line">	AbilitySystemComponent = AuraPlayerState-&gt;<span class="built_in">GetAbilitySystemComponent</span>();</span><br><span class="line">	AttributeSet = AuraPlayerState-&gt;<span class="built_in">GetAttributeSet</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="初始化方法"><a href="#初始化方法" class="headerlink" title="初始化方法"></a>初始化方法</h2><p>Intstats 在能力组件中通过数据表格初始化</p>
<p>在AttributeSet中构造函数初始化：适用于静态初始化，通常在类定义时使用。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">    UMyAttributeSet::<span class="built_in">UMyAttributeSet</span>()</span><br><span class="line">    &#123;</span><br><span class="line"><span class="built_in">InitHealth</span>(<span class="number">100.f</span>);</span><br><span class="line"><span class="built_in">InitMaxHealth</span>(<span class="number">100.f</span>);</span><br><span class="line"><span class="built_in">InitMana</span>(<span class="number">50.f</span>);</span><br><span class="line"><span class="built_in">InitMaxMana</span>(<span class="number">50.f</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>InitFromStruct 方法：适用于从结构体中初始化属性。自定义</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">UMyAttributeSet::InitFromStruct</span><span class="params">(<span class="type">const</span> FGameplayAttributeData&amp; Data)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Health = Data.Health;</span><br><span class="line">    MaxHealth = Data.MaxHealth;</span><br><span class="line">    Mana = Data.Mana;</span><br><span class="line">    MaxMana = Data.MaxMana;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>PostGameplayEffectExecute 方法：适用于在应用游戏效果时动态更新属性。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">UMyAttributeSet::PostGameplayEffectExecute</span><span class="params">(<span class="type">const</span> FGameplayEffectModCallbackData&amp; Data)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Super::<span class="built_in">PostGameplayEffectExecute</span>(Data);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 根据游戏效果的数据来更新属性</span></span><br><span class="line">    <span class="keyword">if</span> (Data.EvaluatedData.Attribute == <span class="built_in">GetHealthAttribute</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">SetHealth</span>(FMath::<span class="built_in">Clamp</span>(Data.EvaluatedData.Value, <span class="number">0.0f</span>, <span class="built_in">GetMaxHealth</span>()));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>OnRep_ 函数：适用于在网络复制属性后进行初始化或更新。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">UPROPERTY</span>(Replicated, BlueprintReadWrite, Category = <span class="string">&quot;Attributes&quot;</span>)</span><br><span class="line"><span class="type">float</span> Health;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UMyAttributeSet::OnRep_Health</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// 在属性网络复制后进行初始化或更新</span></span><br><span class="line">    <span class="comment">// 例如，触发事件或更新 UI</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="API"><a href="#API" class="headerlink" title="API"></a>API</h2><h3 id="虚函数"><a href="#虚函数" class="headerlink" title="虚函数"></a>虚函数</h3><table>
<thead>
<tr>
<th>虚函数</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>virtual void GetLifetimeReplicatedProps(TArray<FLifetimeProperty>&amp; OutLifetimeProps) const override;</td>
<td>获取需要在网络上传输的属性</td>
</tr>
<tr>
<td>virtual void PreAttributeChange(const FGameplayAttribute&amp; Attribute, float&amp; NewValue) override;</td>
<td>在属性值变化前调用的回调函数</td>
</tr>
<tr>
<td>virtual void PostGameplayEffectExecute(const FGameplayEffectModCallbackData&amp; Data) override;</td>
<td>在游戏效果执行后调用的回调函数</td>
</tr>
</tbody></table>
<h3 id="属性函数"><a href="#属性函数" class="headerlink" title="属性函数"></a>属性函数</h3><table>
<thead>
<tr>
<th>函数</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>OnRep</td>
<td>属性变化回调</td>
</tr>
<tr>
<td>Clamp</td>
<td>限制最大值NewValue &#x3D; FMath::Clamp(NewValue, 0.f, GetMaxHealth());</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<h1 id="MVC"><a href="#MVC" class="headerlink" title="MVC"></a>MVC</h1><ul>
<li>数据层</li>
<li>Widget 主要函数(设置控制器),(设置控制器时发出蓝图事件)是要控件都继承该类</li>
<li>HUD:,初始化控制层,拥有控制层实例,并提供获取控制层的方法</li>
</ul>
<h2 id="控制层"><a href="#控制层" class="headerlink" title="控制层"></a>控制层</h2><ul>
<li>继承自UObject 在HUD创建实例</li>
<li>拥有玩家控制器,玩家状态,玩家能力组件,玩家属性集(用结构体获取这些对象)</li>
<li>拥有两个虚函数,在HUD里调用,分别为初始化属性和绑定属性回调,还有匿名通知捡起物品</li>
<li>Widget从HUD获取控制层,当Widget获取到控制层时会发出事件给自己</li>
</ul>
<h3 id="派生子类Overlay"><a href="#派生子类Overlay" class="headerlink" title="派生子类Overlay"></a>派生子类Overlay</h3><ul>
<li>负责更新血量和通知捡到物品</li>
</ul>
<h3 id="派生子类Attrib"><a href="#派生子类Attrib" class="headerlink" title="派生子类Attrib"></a>派生子类Attrib</h3><ul>
<li><p>用了函数库,可以全局获取到控制层</p>
</li>
<li><p>负责同步属性面板</p>
</li>
</ul>
<h3 id="Widget代码"><a href="#Widget代码" class="headerlink" title="Widget代码"></a>Widget代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Fill out your copyright notice in the Description page of Project Settings.</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> once</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;CoreMinimal.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Blueprint/UserWidget.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;AuraUserWidget.generated.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 用户界面基类</span></span><br><span class="line"><span class="built_in">UCLASS</span>()</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AURADEMO_API</span> UAuraUserWidget : <span class="keyword">public</span> UUserWidget</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">GENERATED_BODY</span>()</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">UFUNCTION</span>(BlueprintCallable)</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">SetWidgetController</span><span class="params">(UObject* InWidgetController)</span></span>;</span><br><span class="line">	</span><br><span class="line">	<span class="built_in">UPROPERTY</span>(BlueprintReadOnly)</span><br><span class="line">	TObjectPtr&lt;UObject&gt; WidgetController;</span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">	<span class="comment">//事件</span></span><br><span class="line">	<span class="built_in">UFUNCTION</span>(BlueprintImplementableEvent)</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">WidgetControllerSet</span><span class="params">()</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Fill out your copyright notice in the Description page of Project Settings.</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;UI/Widget/AuraUserWidget.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UAuraUserWidget::SetWidgetController</span><span class="params">(UObject* InWidgetController)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">// 将传入的Widget控制器对象赋值给类成员变量WidgetController</span></span><br><span class="line">	WidgetController = InWidgetController;</span><br><span class="line">	<span class="comment">// 调用WidgetControllerSet函数，通知已经设置了Widget控制器对象</span></span><br><span class="line">	<span class="built_in">WidgetControllerSet</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="HUD代码"><a href="#HUD代码" class="headerlink" title="HUD代码"></a>HUD代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Fill out your copyright notice in the Description page of Project Settings.</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> once</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;CoreMinimal.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;GameFramework/HUD.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;UI/Widget/AuraUserWidget.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;UI/WidgetController/AuraWidgetController.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;AuraHUD.generated.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UOverlayWidgetController</span>;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UAuraUserWidget</span>;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UAttributeSet</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">FWidgetControllerParame</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//玩家HUD,负责创建覆盖控件和绑定控制器</span></span><br><span class="line"><span class="built_in">UCLASS</span>(Blueprintable, BlueprintType)</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AURADEMO_API</span> AAuraHUD : <span class="keyword">public</span> AHUD</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">GENERATED_BODY</span>()</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="comment">//覆盖控件</span></span><br><span class="line">	<span class="built_in">UPROPERTY</span>()</span><br><span class="line">	TObjectPtr&lt;UAuraUserWidget&gt; OverlayWidget;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//通过结构体创建或者获取控制器</span></span><br><span class="line">	<span class="function">UOverlayWidgetController *<span class="title">GetOverlayWidgetController</span><span class="params">(<span class="type">const</span> FWidgetControllerParame&amp; WCParams)</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 初始化控制器数据</span></span><br><span class="line">	<span class="built_in">UFUNCTION</span>(BlueprintCallable)</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">InitOverlay</span><span class="params">(APlayerController* PC, APlayerState* PS, UAbilitySystemComponent* ASC, UAttributeSet* AS)</span></span>;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="comment">//覆盖控件类引用</span></span><br><span class="line">	<span class="built_in">UPROPERTY</span>(EditAnywhere)</span><br><span class="line">	TSubclassOf&lt;UAuraUserWidget&gt; OverlayWidgetClass;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//控制器实例指针</span></span><br><span class="line">	<span class="built_in">UPROPERTY</span>()</span><br><span class="line">	TObjectPtr&lt;UOverlayWidgetController&gt; OverlayWidgetController;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//控制器类引用</span></span><br><span class="line">	<span class="built_in">UPROPERTY</span>(EditAnywhere)</span><br><span class="line">	TSubclassOf&lt;UOverlayWidgetController&gt; OverlayWidgetControllerClass;</span><br><span class="line"></span><br><span class="line">	</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="comment">//*面板属性**//</span></span><br><span class="line">	<span class="function">UAttributeMenuWidgetController* <span class="title">GetAttributeMenuWidgetController</span><span class="params">(<span class="type">const</span> FWidgetControllerParame&amp; WCParams)</span></span>;</span><br><span class="line">	<span class="built_in">UPROPERTY</span>()</span><br><span class="line">	TObjectPtr&lt;UAttributeMenuWidgetController&gt; AttributeMenuWidgetController;</span><br><span class="line">	<span class="built_in">UPROPERTY</span>(EditAnywhere)</span><br><span class="line">	TSubclassOf&lt;UAttributeMenuWidgetController&gt; AttributeMenuWidgetControllerClass;</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Fill out your copyright notice in the Description page of Project Settings.</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;UI/HUD/AuraHUD.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;UI/WidgetController/AttributeMenuWidgetController.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;UI/WidgetController/OverlayWidgetController.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function">UOverlayWidgetController* <span class="title">AAuraHUD::GetOverlayWidgetController</span><span class="params">(<span class="type">const</span> FWidgetControllerParame&amp; WCParams)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(OverlayWidgetController == <span class="literal">nullptr</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		OverlayWidgetController = <span class="built_in">NewObject</span>&lt;UOverlayWidgetController&gt;(<span class="keyword">this</span>, OverlayWidgetControllerClass);</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 设置参数</span></span><br><span class="line">		OverlayWidgetController-&gt;<span class="built_in">SetWidgetControllerParams</span>(WCParams);</span><br><span class="line">		<span class="comment">// 绑定回调</span></span><br><span class="line">		OverlayWidgetController-&gt;<span class="built_in">BindCallbacksToDependencies</span>();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> OverlayWidgetController;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">AAuraHUD::InitOverlay</span><span class="params">(APlayerController* PC, APlayerState* PS, UAbilitySystemComponent* ASC, UAttributeSet* AS)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">//判断控制器类类引用和状态UI类引用是否有效</span></span><br><span class="line">	<span class="built_in">checkf</span>(OverlayWidgetClass, <span class="built_in">TEXT</span>(<span class="string">&quot;OverlayWidgetClass is nullptr&quot;</span>))</span><br><span class="line">	<span class="built_in">checkf</span>(OverlayWidgetControllerClass, <span class="built_in">TEXT</span>(<span class="string">&quot;OverlayWidgetControllerClass is nullptr&quot;</span>))</span><br><span class="line"></span><br><span class="line">	<span class="comment">//创建覆盖控件</span></span><br><span class="line">	UUserWidget * Widget = <span class="built_in">CreateWidget</span>&lt;UUserWidget&gt;(<span class="built_in">GetWorld</span>(), OverlayWidgetClass);</span><br><span class="line">	OverlayWidget= <span class="built_in">Cast</span>&lt;UAuraUserWidget&gt;(Widget);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//创建结构体并将参数构造</span></span><br><span class="line">	<span class="type">const</span> FWidgetControllerParame FWidgetControllerParame = &#123;PC, PS, ASC, AS&#125;;</span><br><span class="line">	<span class="comment">//获取OverlayWidgetController</span></span><br><span class="line">	UOverlayWidgetController * WidgetController = <span class="built_in">GetOverlayWidgetController</span>(FWidgetControllerParame);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//设置覆盖控件的控制器,发出事件</span></span><br><span class="line">	OverlayWidget-&gt;<span class="built_in">SetWidgetController</span>(WidgetController); <span class="comment">//设置用户控件的控制层</span></span><br><span class="line">	WidgetController-&gt;<span class="built_in">BroadcastInitialValues</span>(); <span class="comment">//初始化广播的值,在所以UI绑定后调用一次</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//添加到视口</span></span><br><span class="line">	Widget-&gt;<span class="built_in">AddToViewport</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">UAttributeMenuWidgetController* <span class="title">AAuraHUD::GetAttributeMenuWidgetController</span><span class="params">(<span class="type">const</span> FWidgetControllerParame&amp; WCParams)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(AttributeMenuWidgetController == <span class="literal">nullptr</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		AttributeMenuWidgetController = <span class="built_in">NewObject</span>&lt;UAttributeMenuWidgetController&gt;(<span class="keyword">this</span>, AttributeMenuWidgetControllerClass);</span><br><span class="line">		AttributeMenuWidgetController-&gt;<span class="built_in">SetWidgetControllerParams</span>(WCParams);</span><br><span class="line">		AttributeMenuWidgetController-&gt;<span class="built_in">BindCallbacksToDependencies</span>(); <span class="comment">//绑定监听数值变化</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> AttributeMenuWidgetController;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="控制层代码"><a href="#控制层代码" class="headerlink" title="控制层代码"></a>控制层代码</h2><h3 id="基类"><a href="#基类" class="headerlink" title="基类"></a>基类</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Fill out your copyright notice in the Description page of Project Settings.</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> once</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;CoreMinimal.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;AuraWidgetController.generated.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UAttributeSet</span>;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UAbilitySystemComponent</span>;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UAbilitySystemComponent</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//存储玩家控制器、玩家状态、能力组件、属性集的结构体</span></span><br><span class="line"><span class="built_in">USTRUCT</span>(BlueprintType)</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">FWidgetControllerParame</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">GENERATED_BODY</span>()</span><br><span class="line"></span><br><span class="line">	<span class="built_in">FWidgetControllerParame</span>()&#123;&#125;;</span><br><span class="line">	<span class="built_in">FWidgetControllerParame</span>(APlayerController* PC, APlayerState* PS, UAbilitySystemComponent* InAbiliASCtySystemComponent, UAttributeSet* AS)</span><br><span class="line">	: <span class="built_in">PlayerController</span>(PC), <span class="built_in">PlayerState</span>(PS), <span class="built_in">AbilitySystemComponent</span>(InAbiliASCtySystemComponent), <span class="built_in">AttributeSet</span>(AS)</span><br><span class="line">	&#123;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UPROPERTY</span>(EditAnywhere, BlueprintReadWrite)</span><br><span class="line">	TObjectPtr&lt;APlayerController&gt; PlayerController=<span class="literal">nullptr</span>;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UPROPERTY</span>(EditAnywhere, BlueprintReadWrite)</span><br><span class="line">	TObjectPtr&lt;APlayerState&gt; PlayerState=<span class="literal">nullptr</span>;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UPROPERTY</span>(EditAnywhere, BlueprintReadWrite)</span><br><span class="line">	TObjectPtr&lt;UAbilitySystemComponent&gt; AbilitySystemComponent=<span class="literal">nullptr</span>;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UPROPERTY</span>(EditAnywhere, BlueprintReadWrite)</span><br><span class="line">	TObjectPtr&lt;UAttributeSet&gt; AttributeSet=<span class="literal">nullptr</span>;</span><br><span class="line">	</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//控制器基类</span></span><br><span class="line"><span class="built_in">UCLASS</span>()</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AURADEMO_API</span> UAuraWidgetController : <span class="keyword">public</span> UObject</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">GENERATED_BODY</span>()</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">UFUNCTION</span>(BlueprintCallable)</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">SetWidgetControllerParams</span><span class="params">(<span class="type">const</span> FWidgetControllerParame&amp; WCParams)</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 初始化属性(在HUD调用)</span></span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">BroadcastInitialValues</span><span class="params">()</span></span>;</span><br><span class="line">	<span class="comment">// 绑定回调(在HUD调用)</span></span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">BindCallbacksToDependencies</span><span class="params">()</span></span>;</span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line"></span><br><span class="line">	<span class="comment">/*获取对象数据*/</span></span><br><span class="line">	<span class="comment">//获取玩家控制器</span></span><br><span class="line">	<span class="built_in">UPROPERTY</span>(BlueprintReadOnly, Category=<span class="string">&quot;WidgetController&quot;</span>)</span><br><span class="line">	TObjectPtr&lt;APlayerController&gt; PlayerController;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//获取玩家状态</span></span><br><span class="line">	<span class="built_in">UPROPERTY</span>(BlueprintReadOnly, Category=<span class="string">&quot;WidgetController&quot;</span>)</span><br><span class="line">	TObjectPtr&lt;APlayerState&gt; PlayerState;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//获取能力组件</span></span><br><span class="line">	<span class="built_in">UPROPERTY</span>(BlueprintReadOnly, Category=<span class="string">&quot;WidgetController&quot;</span>)</span><br><span class="line">	TObjectPtr&lt;UAbilitySystemComponent&gt; AbilitySystemComponent;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//获取属性集</span></span><br><span class="line">	<span class="built_in">UPROPERTY</span>(BlueprintReadOnly, Category=<span class="string">&quot;WidgetController&quot;</span>)</span><br><span class="line">	TObjectPtr&lt;UAttributeSet&gt; AttributeSet;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Fill out your copyright notice in the Description page of Project Settings.</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;UI/WidgetController/AuraWidgetController.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UAuraWidgetController::SetWidgetControllerParams</span><span class="params">(<span class="type">const</span> FWidgetControllerParame&amp; WCParams)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	PlayerController = WCParams.PlayerController;</span><br><span class="line">	PlayerState = WCParams.PlayerState;</span><br><span class="line">	AbilitySystemComponent = WCParams.AbilitySystemComponent;</span><br><span class="line">	AttributeSet = WCParams.AttributeSet;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UAuraWidgetController::BroadcastInitialValues</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UAuraWidgetController::BindCallbacksToDependencies</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="生命值-魔法值子类"><a href="#生命值-魔法值子类" class="headerlink" title="生命值&#x2F;魔法值子类"></a>生命值&#x2F;魔法值子类</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Fill out your copyright notice in the Description page of Project Settings.</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> once</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;CoreMinimal.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;GameplayTagContainer.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;UI/WidgetController/AuraWidgetController.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;OverlayWidgetController.generated.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//根据传入的表格和Tag返回查找到的数据，表格类型不确定，所以使用T来表示，在使用此函数时，需要指定对应类型</span></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span></span><br><span class="line"><span class="function">T* <span class="title">GetDataTableRowByTag</span><span class="params">(UDataTable* DataTable, <span class="type">const</span> FGameplayTag&amp; Tag)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function">T* <span class="title">GetDataTableRowByTag</span><span class="params">(UDataTable* DataTable, <span class="type">const</span> FGameplayTag&amp; Tag)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	T* Row = DataTable-&gt;<span class="built_in">FindRow</span>&lt;T&gt;(Tag.<span class="built_in">GetTagName</span>(), <span class="built_in">TEXT</span>(<span class="string">&quot;&quot;</span>));</span><br><span class="line">	<span class="keyword">return</span> Row;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//捡到物品的结构</span></span><br><span class="line"><span class="built_in">USTRUCT</span>(BlueprintType)</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">FUIWidgetRow</span> : <span class="keyword">public</span> FTableRowBase</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">GENERATED_BODY</span>();</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UPROPERTY</span>(EditAnywhere, BlueprintReadOnly)</span><br><span class="line">	FGameplayTag MessageTag = <span class="built_in">FGameplayTag</span>();</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UPROPERTY</span>(EditAnywhere, BlueprintReadOnly)</span><br><span class="line">	FText Message = <span class="built_in">FText</span>();</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UPROPERTY</span>(EditAnywhere, BlueprintReadOnly)</span><br><span class="line">	TSubclassOf&lt;<span class="keyword">class</span> <span class="title class_">UAuraUserWidget</span>&gt; MessageWidget;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UPROPERTY</span>(EditAnywhere, BlueprintReadOnly)</span><br><span class="line">	UTexture2D* Image = <span class="literal">nullptr</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">FOnAttributeChangeData</span>;</span><br><span class="line"><span class="comment">//生命值改变时发出通知</span></span><br><span class="line"><span class="built_in">DECLARE_DYNAMIC_MULTICAST_DELEGATE_OneParam</span>(FOnHealtChangedSignature, <span class="type">float</span>, NewHealt);</span><br><span class="line"><span class="comment">//最大生命值改变时发出通知</span></span><br><span class="line"><span class="comment">// DECLARE_DYNAMIC_MULTICAST_DELEGATE_OneParam(FOnMaxHealtChangedSignature,float , NewMaxHealt);</span></span><br><span class="line"><span class="comment">// DECLARE_DYNAMIC_MULTICAST_DELEGATE_OneParam(FOnManaChangedSignature, float, NewMana);</span></span><br><span class="line"><span class="comment">// DECLARE_DYNAMIC_MULTICAST_DELEGATE_OneParam(FOnMaxManaChangedSignature,float , NewMaxMana);</span></span><br><span class="line"><span class="built_in">DECLARE_DYNAMIC_MULTICAST_DELEGATE_OneParam</span>(FOnAttributeChangedSignature, <span class="type">float</span>, NewAttribute);</span><br><span class="line"><span class="built_in">DECLARE_DYNAMIC_MULTICAST_DELEGATE_OneParam</span>(FMessageWidgetRowSignature, FUIWidgetRow, Row);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 覆盖层控制器子类</span></span><br><span class="line"><span class="built_in">UCLASS</span>(Blueprintable,BlueprintType)</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AURADEMO_API</span> UOverlayWidgetController : <span class="keyword">public</span> UAuraWidgetController</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">GENERATED_BODY</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="comment">//当属性改变时发出通知</span></span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">BroadcastInitialValues</span><span class="params">()</span> <span class="keyword">override</span></span>;</span><br><span class="line">	<span class="comment">//当属性改变时绑定回调</span></span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">BindCallbacksToDependencies</span><span class="params">()</span> <span class="keyword">override</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//事件:生命值改变时发出</span></span><br><span class="line">	<span class="built_in">UPROPERTY</span>(BlueprintAssignable, Category = <span class="string">&quot;GAS|Attributes&quot;</span>)</span><br><span class="line">	FOnHealtChangedSignature OnHealtChanged;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//事件:声明最大值改变时发出</span></span><br><span class="line">	<span class="built_in">UPROPERTY</span>(BlueprintAssignable, Category = <span class="string">&quot;GAS|Attributes&quot;</span>)</span><br><span class="line">	FOnAttributeChangedSignature OnMaxHealtChanged;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UPROPERTY</span>(BlueprintAssignable, Category = <span class="string">&quot;GAS|Attributes&quot;</span>)</span><br><span class="line">	FOnAttributeChangedSignature OnManaChanged;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UPROPERTY</span>(BlueprintAssignable, Category = <span class="string">&quot;GAS|Attributes&quot;</span>)</span><br><span class="line">	FOnAttributeChangedSignature OnMaxManaChanged;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UPROPERTY</span>(BlueprintAssignable, Category=<span class="string">&quot;GAS|Messages&quot;</span>)</span><br><span class="line">	FMessageWidgetRowSignature MessageWidgetRowDelegate;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//EditDefaultsOnly 说明此属性可以通过属性窗口编辑，但只能在原型上进行。</span></span><br><span class="line">	<span class="built_in">UPROPERTY</span>(EditDefaultsOnly, BlueprintReadOnly, Category=<span class="string">&quot;Widget Data&quot;</span>)</span><br><span class="line">	TObjectPtr&lt;UDataTable&gt; MessageWidgetDataTable;</span><br><span class="line"></span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">	<span class="comment">// 生命值改变时发出</span></span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">HealthChanged</span><span class="params">(<span class="type">const</span> FOnAttributeChangeData&amp; Data)</span> <span class="type">const</span></span>;</span><br><span class="line">	<span class="comment">// 最大生命值改变时发出</span></span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">MaxHealthChanged</span><span class="params">(<span class="type">const</span> FOnAttributeChangeData&amp; Data)</span> <span class="type">const</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">ManaChanged</span><span class="params">(<span class="type">const</span> FOnAttributeChangeData&amp; Data)</span> <span class="type">const</span></span>;</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">MaxManaChanged</span><span class="params">(<span class="type">const</span> FOnAttributeChangeData&amp; Data)</span> <span class="type">const</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Fill out your copyright notice in the Description page of Project Settings.</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;UI/WidgetController/OverlayWidgetController.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;AbilitySystem/AuraAbilitySystemComponent.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;AbilitySystem/AuraAttributeSet.h&quot;</span></span></span><br><span class="line"></span><br><span class="line">										<span class="comment">/*初始化属性时发出通知*/</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UOverlayWidgetController::BroadcastInitialValues</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	Super::<span class="built_in">BroadcastInitialValues</span>();</span><br><span class="line">	<span class="type">const</span> UAuraAttributeSet* AuraAttributeSet = <span class="built_in">CastChecked</span>&lt;UAuraAttributeSet&gt;(AttributeSet);</span><br><span class="line">	OnHealtChanged.<span class="built_in">Broadcast</span>(AuraAttributeSet-&gt;<span class="built_in">GetHealth</span>());</span><br><span class="line">	OnMaxHealtChanged.<span class="built_in">Broadcast</span>(AuraAttributeSet-&gt;<span class="built_in">GetMaxHealth</span>());</span><br><span class="line">	OnManaChanged.<span class="built_in">Broadcast</span>(AuraAttributeSet-&gt;<span class="built_in">GetMana</span>());</span><br><span class="line">	OnMaxManaChanged.<span class="built_in">Broadcast</span>(AuraAttributeSet-&gt;<span class="built_in">GetMaxMana</span>());</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">											<span class="comment">/*绑定属性回调*/</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UOverlayWidgetController::BindCallbacksToDependencies</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	Super::<span class="built_in">BindCallbacksToDependencies</span>();</span><br><span class="line">	<span class="type">const</span> UAuraAttributeSet* AuraAttributeSet = <span class="built_in">CastChecked</span>&lt;UAuraAttributeSet&gt;(AttributeSet);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="comment">//绑定生命值回调</span></span><br><span class="line">	AbilitySystemComponent-&gt;<span class="built_in">GetGameplayAttributeValueChangeDelegate</span>(</span><br><span class="line">		AuraAttributeSet-&gt;<span class="built_in">GetHealthAttribute</span>()).<span class="built_in">AddUObject</span>(<span class="keyword">this</span>, &amp;UOverlayWidgetController::HealthChanged);</span><br><span class="line">	<span class="comment">//绑定最大生命值回调</span></span><br><span class="line">	AbilitySystemComponent-&gt;<span class="built_in">GetGameplayAttributeValueChangeDelegate</span>(</span><br><span class="line">		AuraAttributeSet-&gt;<span class="built_in">GetMaxHealthAttribute</span>()).<span class="built_in">AddUObject</span>(<span class="keyword">this</span>, &amp;UOverlayWidgetController::MaxHealthChanged);</span><br><span class="line">	<span class="comment">//绑定法力值回调</span></span><br><span class="line">	AbilitySystemComponent-&gt;<span class="built_in">GetGameplayAttributeValueChangeDelegate</span>(</span><br><span class="line">		AuraAttributeSet-&gt;<span class="built_in">GetManaAttribute</span>()).<span class="built_in">AddUObject</span>(<span class="keyword">this</span>, &amp;UOverlayWidgetController::ManaChanged);</span><br><span class="line">	<span class="comment">//绑定最大法力值回调</span></span><br><span class="line">	AbilitySystemComponent-&gt;<span class="built_in">GetGameplayAttributeValueChangeDelegate</span>(</span><br><span class="line">		AuraAttributeSet-&gt;<span class="built_in">GetMaxManaAttribute</span>()).<span class="built_in">AddUObject</span>(<span class="keyword">this</span>, &amp;UOverlayWidgetController::MaxManaChanged);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="comment">//匿名函数调用</span></span><br><span class="line">	<span class="comment">// AbilitySystemComponent-&gt;GetGameplayAttributeValueChangeDelegate(AuraAttributeSet-&gt;GetHealthAttribute()</span></span><br><span class="line">	<span class="comment">// 	).AddLambda([this](const FOnAttributeChangeData&amp; Data)&#123;OnHealtChanged.Broadcast(Data.NewValue);&#125;);</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">//AddLambda 绑定匿名函数(效果添加Tag时触发)</span></span><br><span class="line">	<span class="built_in">Cast</span>&lt;UAuraAbilitySystemComponent&gt;(AbilitySystemComponent)-&gt;EffectAssetTags.<span class="built_in">AddLambda</span>(</span><br><span class="line">		[<span class="keyword">this</span>](<span class="type">const</span> FGameplayTagContainer&amp; AssetTags) <span class="comment">//中括号添加this是为了保证内部能够获取类的对象</span></span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">for</span>(<span class="type">const</span> FGameplayTag&amp; Tag : AssetTags)</span><br><span class="line">			&#123;</span><br><span class="line"></span><br><span class="line">				<span class="comment">// const FString Msg = FString::Printf(TEXT(&quot;添加标签: %s&quot;), *Tag.ToString()); //获取Asset Tag</span></span><br><span class="line">				<span class="comment">// GEngine-&gt;AddOnScreenDebugMessage(-1, 8.f, FColor::Cyan, Msg); //打印到屏幕上 -1 不会被覆盖</span></span><br><span class="line">				<span class="comment">//对标签进行检测，如果不是信息标签，将无法进行广播</span></span><br><span class="line">				FGameplayTag MessageTag = FGameplayTag::<span class="built_in">RequestGameplayTag</span>(<span class="built_in">FName</span>(<span class="string">&quot;Message&quot;</span>));</span><br><span class="line">				<span class="comment">// &quot;A.1&quot;.MatchesTag(&quot;A&quot;) will return True, &quot;A&quot;.MatchesTag(&quot;A.1&quot;) will return False</span></span><br><span class="line">				</span><br><span class="line">				<span class="keyword">if</span>(Tag.<span class="built_in">MatchesTag</span>(MessageTag))</span><br><span class="line">				&#123;</span><br><span class="line">					<span class="type">const</span> FString Msg = FString::<span class="built_in">Printf</span>(<span class="built_in">TEXT</span>(<span class="string">&quot;添加标签: %s&quot;</span>), *Tag.<span class="built_in">ToString</span>()); <span class="comment">//获取Asset Tag</span></span><br><span class="line">					GEngine-&gt;<span class="built_in">AddOnScreenDebugMessage</span>(<span class="number">-1</span>, <span class="number">8.f</span>, FColor::Cyan, Msg); </span><br><span class="line">					</span><br><span class="line">					FUIWidgetRow* Row = <span class="built_in">GetDataTableRowByTag</span>&lt;FUIWidgetRow&gt;(MessageWidgetDataTable, Tag);</span><br><span class="line">					MessageWidgetRowDelegate.<span class="built_in">Broadcast</span>(*Row); <span class="comment">//前面加*取消指针引用</span></span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	);</span><br><span class="line">		</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                                       <span class="comment">/*当属性改变时发出通知*/</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UOverlayWidgetController::HealthChanged</span><span class="params">(<span class="type">const</span> FOnAttributeChangeData&amp; Data)</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	OnHealtChanged.<span class="built_in">Broadcast</span>(Data.NewValue);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UOverlayWidgetController::MaxHealthChanged</span><span class="params">(<span class="type">const</span> FOnAttributeChangeData&amp; Data)</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	OnMaxHealtChanged.<span class="built_in">Broadcast</span>(Data.NewValue);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UOverlayWidgetController::ManaChanged</span><span class="params">(<span class="type">const</span> FOnAttributeChangeData&amp; Data)</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	OnManaChanged.<span class="built_in">Broadcast</span>(Data.NewValue);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UOverlayWidgetController::MaxManaChanged</span><span class="params">(<span class="type">const</span> FOnAttributeChangeData&amp; Data)</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	OnMaxManaChanged.<span class="built_in">Broadcast</span>(Data.NewValue);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="属性集"><a href="#属性集" class="headerlink" title="属性集"></a>属性集</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Fill out your copyright notice in the Description page of Project Settings.</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> once</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;CoreMinimal.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;AttributeSet.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;UI/WidgetController/AuraWidgetController.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;AttributeMenuWidgetController.generated.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UAbilityInfo</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">FAttributeInfo</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">FGameplayTag</span>;</span><br><span class="line"><span class="built_in">DECLARE_DYNAMIC_MULTICAST_DELEGATE_OneParam</span>(FAttibuteInfoSignature, <span class="type">const</span> FAttributeInfo&amp;, Info);</span><br><span class="line"></span><br><span class="line"><span class="comment">//广播属性用的控制层</span></span><br><span class="line"><span class="built_in">UCLASS</span>(Blueprintable, BlueprintType)</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AURADEMO_API</span> UAttributeMenuWidgetController : <span class="keyword">public</span> UAuraWidgetController</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">GENERATED_BODY</span>()</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UFUNCTION</span>(BlueprintCallable)</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">BroadcastInitialValues</span><span class="params">()</span> <span class="keyword">override</span></span>; <span class="comment">//广播初始值</span></span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">BindCallbacksToDependencies</span><span class="params">()</span> <span class="keyword">override</span></span>; <span class="comment">//绑定数值变动后回调广播</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="built_in">UPROPERTY</span>(BlueprintAssignable, Category=<span class="string">&quot;GAS|Attributes&quot;</span>)<span class="comment">//设置BlueprintAssignable可以在蓝图作为委托绑定监听</span></span><br><span class="line">	FAttibuteInfoSignature AttributeInfoDelegate;</span><br><span class="line"></span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">	</span><br><span class="line">	<span class="built_in">UPROPERTY</span>(EditDefaultsOnly)<span class="comment">//EditDefaultsOnly只能在UE面板编辑</span></span><br><span class="line">	TObjectPtr&lt;UAbilityInfo&gt; AttributeInfo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">BroadcastAttributeInfo</span><span class="params">(<span class="type">const</span> FGameplayTag&amp; AttributeTag, <span class="type">const</span> FGameplayAttribute&amp; Attribute)</span> <span class="type">const</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Fill out your copyright notice in the Description page of Project Settings.</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;UI/WidgetController/AttributeMenuWidgetController.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;AbilitySystem/AuraAbilitySystemComponent.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;AbilitySystem/AuraAttributeSet.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;AbilitySystem/Data/AbilityInfo.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Player/AuraPlayerState.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UAttributeMenuWidgetController::BindCallbacksToDependencies</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	Super::<span class="built_in">BindCallbacksToDependencies</span>();</span><br><span class="line">	<span class="type">const</span> UAuraAttributeSet* AS = <span class="built_in">Cast</span>&lt;UAuraAttributeSet&gt;(AttributeSet);</span><br><span class="line">	<span class="built_in">check</span>(AttributeInfo);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span>&amp; Pair : AS-&gt;TagsToAttributes)</span><br><span class="line">	&#123;</span><br><span class="line">		AbilitySystemComponent-&gt;<span class="built_in">GetGameplayAttributeValueChangeDelegate</span>(Pair.<span class="built_in">Value</span>()).<span class="built_in">AddLambda</span>(</span><br><span class="line">			[<span class="keyword">this</span>,Pair,AS](<span class="type">const</span> FOnAttributeChangeData&amp; Data)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="comment">//BroadcastAttributeInfo(Pair.Key,Pair.Value());</span></span><br><span class="line">				FAttributeInfo Info = AttributeInfo-&gt;<span class="built_in">FindAttributeInfoForTag</span>(Pair.Key);</span><br><span class="line">				Info.AttributeValue = Pair.<span class="built_in">Value</span>().<span class="built_in">GetNumericValue</span>(AS);</span><br><span class="line">				AttributeInfoDelegate.<span class="built_in">Broadcast</span>(Info);</span><br><span class="line">			&#125;</span><br><span class="line">		);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UAttributeMenuWidgetController::BroadcastInitialValues</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">const</span> UAuraAttributeSet* AS = <span class="built_in">Cast</span>&lt;UAuraAttributeSet&gt;(AttributeSet);</span><br><span class="line">	<span class="built_in">check</span>(AttributeInfo);</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// for (auto&amp; Pair : AS-&gt;TagsToAttributes)</span></span><br><span class="line">	<span class="comment">// &#123;</span></span><br><span class="line">	<span class="comment">// 	FAttributeInfo Info = AttributeInfo-&gt;FindAttributeInfoForTag(Pair.Key);</span></span><br><span class="line">	<span class="comment">// 	FGameplayAttribute Attr = Pair.Value.Execute();</span></span><br><span class="line">	<span class="comment">// 	Info.AttributeValue = Attr.GetNumericValue(AS);</span></span><br><span class="line">	<span class="comment">// 	AttributeInfoDelegate.Broadcast(Info);</span></span><br><span class="line">	<span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span>&amp; Pair : AS-&gt;TagsToAttributes)</span><br><span class="line">	&#123;</span><br><span class="line">		FAttributeInfo Info = AttributeInfo-&gt;<span class="built_in">FindAttributeInfoForTag</span>(Pair.Key);</span><br><span class="line">		Info.AttributeValue = Pair.<span class="built_in">Value</span>().<span class="built_in">GetNumericValue</span>(AS);</span><br><span class="line">		AttributeInfoDelegate.<span class="built_in">Broadcast</span>(Info);</span><br><span class="line">		<span class="comment">//BroadcastAttributeInfo(Pair.Key,Pair.Value());</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UAttributeMenuWidgetController::BroadcastAttributeInfo</span><span class="params">(<span class="type">const</span> FGameplayTag&amp; AttributeTag,</span></span></span><br><span class="line"><span class="params"><span class="function">	<span class="type">const</span> FGameplayAttribute&amp; Attribute)</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	FAttributeInfo Info = AttributeInfo-&gt;<span class="built_in">FindAttributeInfoForTag</span>(AttributeTag);</span><br><span class="line">	Info.AttributeValue = Attribute.<span class="built_in">GetNumericValue</span>(AttributeSet);</span><br><span class="line">	AttributeInfoDelegate.<span class="built_in">Broadcast</span>(Info);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// void UAttributeMenuWidgetController::BroadcastAttributeInfo(const FGameplayTag&amp; AttributeTag, const FGameplayAttribute&amp; Attribute) const</span></span><br><span class="line"><span class="comment">// &#123;</span></span><br><span class="line"><span class="comment">// 	FAttributeInfo Info = AttributeInfo-&gt;FindAttributeInfoForTag(AttributeTag);</span></span><br><span class="line"><span class="comment">// 	Info.AttributeValue = Attribute.GetNumericValue(AttributeSet);</span></span><br><span class="line"><span class="comment">// 	AttributeInfoDelegate.Broadcast(Info);</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="控制层函数库代码"><a href="#控制层函数库代码" class="headerlink" title="控制层函数库代码"></a>控制层函数库代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Fill out your copyright notice in the Description page of Project Settings.</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> once</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;CoreMinimal.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Kismet/BlueprintFunctionLibrary.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;AuraAbilitySystemLibrary.generated.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UAttributeMenuWidgetController</span>;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UOverlayWidgetController</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">UCLASS</span>()</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AURADEMO_API</span> UAuraAbilitySystemLibrary : <span class="keyword">public</span> UBlueprintFunctionLibrary</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">GENERATED_BODY</span>()</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">////获取生命值控制层</span></span><br><span class="line">	<span class="built_in">UFUNCTION</span>(BlueprintPure, Category=<span class="string">&quot;MyAbilitySystemLibrary|WidgetController&quot;</span>)</span><br><span class="line">	<span class="function"><span class="type">static</span> UOverlayWidgetController* <span class="title">GetOverlayWidgetController</span><span class="params">(<span class="type">const</span> UObject* WorldContextObject)</span></span>;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">//获取属性集控制层</span></span><br><span class="line">	<span class="built_in">UFUNCTION</span>(BlueprintPure, Category=<span class="string">&quot;MyAbilitySystemLibrary|WidgetController&quot;</span>)</span><br><span class="line">	<span class="function"><span class="type">static</span> UAttributeMenuWidgetController* <span class="title">GetAttributeMenuWidgetController</span><span class="params">(<span class="type">const</span> UObject* WorldContextObject)</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Fill out your copyright notice in the Description page of Project Settings.</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;AbilitySystem/AuraAbilitySystemLibrary.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Kismet/GameplayStatics.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Player/AuraPlayerState.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;UI/HUD/AuraHUD.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">//获取生命值控制层</span></span><br><span class="line"><span class="function">UOverlayWidgetController* <span class="title">UAuraAbilitySystemLibrary::GetOverlayWidgetController</span><span class="params">(<span class="type">const</span> UObject* WorldContextObject)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">//获取到playerController， 需要传入一个世界空间上下文的对象，用于得到对应世界中的PC列表，0为本地使用的PC</span></span><br><span class="line">	<span class="keyword">if</span>(APlayerController* PC = UGameplayStatics::<span class="built_in">GetPlayerController</span>(WorldContextObject, <span class="number">0</span>))</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="comment">//从PC获取到HUD，我们就可以从HUD获得对应的Controller</span></span><br><span class="line">		<span class="keyword">if</span>(AAuraHUD* HUD = <span class="built_in">Cast</span>&lt;AAuraHUD&gt;(PC-&gt;<span class="built_in">GetHUD</span>()))</span><br><span class="line">		&#123;</span><br><span class="line">			AAuraPlayerState* PS = PC-&gt;<span class="built_in">GetPlayerState</span>&lt;AAuraPlayerState&gt;();</span><br><span class="line">			UAbilitySystemComponent* ASC = PS-&gt;<span class="built_in">GetAbilitySystemComponent</span>();</span><br><span class="line">			UAttributeSet* AS = PS-&gt;<span class="built_in">GetAttributeSet</span>();</span><br><span class="line">			<span class="function"><span class="type">const</span> FWidgetControllerParame <span class="title">WidgetControllerParams</span><span class="params">(PC, PS, ASC, AS)</span></span>;</span><br><span class="line">			<span class="keyword">return</span> HUD-&gt;<span class="built_in">GetOverlayWidgetController</span>(WidgetControllerParams);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//获取属性集控制层</span></span><br><span class="line"><span class="function">UAttributeMenuWidgetController* <span class="title">UAuraAbilitySystemLibrary::GetAttributeMenuWidgetController</span><span class="params">(<span class="type">const</span> UObject* WorldContextObject)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">//获取到playerController， 需要传入一个世界空间上下文的对象，用于得到对应世界中的PC列表，0为本地使用的PC</span></span><br><span class="line">	<span class="keyword">if</span>(APlayerController* PC = UGameplayStatics::<span class="built_in">GetPlayerController</span>(WorldContextObject, <span class="number">0</span>))</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="comment">//从PC获取到HUD，我们就可以从HUD获得对应的Controller</span></span><br><span class="line">		<span class="keyword">if</span>(AAuraHUD* HUD = <span class="built_in">Cast</span>&lt;AAuraHUD&gt;(PC-&gt;<span class="built_in">GetHUD</span>()))</span><br><span class="line">		&#123;</span><br><span class="line">			AAuraPlayerState* PS = PC-&gt;<span class="built_in">GetPlayerState</span>&lt;AAuraPlayerState&gt;();</span><br><span class="line">			UAbilitySystemComponent* ASC = PS-&gt;<span class="built_in">GetAbilitySystemComponent</span>();</span><br><span class="line">			UAttributeSet* AS = PS-&gt;<span class="built_in">GetAttributeSet</span>();</span><br><span class="line">			<span class="function"><span class="type">const</span> FWidgetControllerParame <span class="title">WidgetControllerParams</span><span class="params">(PC, PS, ASC, AS)</span></span>;</span><br><span class="line">			<span class="keyword">return</span> HUD-&gt;<span class="built_in">GetAttributeMenuWidgetController</span>(WidgetControllerParams);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="GE-效果配置"><a href="#GE-效果配置" class="headerlink" title="GE 效果配置"></a>GE 效果配置</h1><h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2><h3 id="持续时间"><a href="#持续时间" class="headerlink" title="持续时间"></a>持续时间</h3><table>
<thead>
<tr>
<th>属性名</th>
<th>描述</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>Insant</td>
<td>立即执行</td>
<td></td>
</tr>
<tr>
<td>Infinite</td>
<td>无限 比如泉水持续回血,记得添加移除事件,比如玩家离开泉水后不再执行效果</td>
<td>+ Period  间隔时间<br />+ bExecutePeriodicEffectOnApplication 立即执行或者倒数再执行<br />+ PeriodicInhibitionPolicy</td>
</tr>
<tr>
<td>Has Duration</td>
<td>有时间</td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<h3 id="堆叠Stacking"><a href="#堆叠Stacking" class="headerlink" title="堆叠Stacking"></a>堆叠Stacking</h3><table>
<thead>
<tr>
<th>属性</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>Aggregate by Source</td>
<td>那么角色可以对每个目标叠加三层效果</td>
</tr>
<tr>
<td>Aggregate by Target</td>
<td>那么就是不管多少人对目标叠加了多少层效果，目标身上只能叠加三层效果</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th>属性</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td><strong>StackLimitCount</strong></td>
<td>堆叠次数</td>
</tr>
<tr>
<td><strong>Stack Duration Refresh Polic</strong></td>
<td><code>Refresh on Successfull Application</code>： 叠加效果时，刷新持续时间，即使层数不增加也会更新。<br /><code>Never Refresh</code>： 即使叠加效果，也不会刷新。。</td>
</tr>
<tr>
<td><strong>Stack Period Reset Policy</strong></td>
<td><code>Refresh on Successfull Application</code>：叠加效果时，每次都会更新周期时间 Period<br /><code>Never Refresh</code>： 即使叠加效果，也不会刷新。</td>
</tr>
<tr>
<td><strong>Stack Expiration Policy</strong></td>
<td><code>Clear Entire Stack</code>:Duration结束时清楚所有层数<br /><code>Remove Single Stack And Refresh Duration</code>：Duration结束时减少一层，然后重新经历一个Duration，一直持续到层数减为0<br /><code>Refresh Duration</code>：Duration结束时再次刷新Duration，这相当于无限Duration，可以通过调用</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th>属性Overflow</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td><strong>OverflowEffects</strong></td>
<td>超过StackLimitCount数量的Effect被Apply时将会调用该OverflowEffects，可以设置多个</td>
</tr>
<tr>
<td><strong>DenyOverflowApplication</strong></td>
<td>对应于StackDurationRefreshPolicy，如果为True则多余的Apply不会刷新Duration</td>
</tr>
<tr>
<td><strong>ClearStackOnOverflow</strong></td>
<td>当DenyOverflowApplication为True是才有效，当Overflow时是否直接删除所有层数</td>
</tr>
</tbody></table>
<h2 id="叠加触发"><a href="#叠加触发" class="headerlink" title="叠加触发"></a>叠加触发</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">UFUNCTION</span>(BlueprintCallable) </span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ApplyEffectToTarget</span><span class="params">(AActor* TargetActor, TSubclassOf&lt;UGameplayEffect&gt; GameplayEffectClass)</span></span>;<span class="comment">//给与目标添加GameplayEffect</span></span><br></pre></td></tr></table></figure>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">AAuraCtestCharacter::ApplyEffectToTarget</span><span class="params">(AActor* TargetActor, TSubclassOf&lt;UGameplayEffect&gt; GameplayEffectClass)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">//获取角色能力组件</span></span><br><span class="line">	UAbilitySystemComponent* TargetASC = UAbilitySystemBlueprintLibrary::<span class="built_in">GetAbilitySystemComponent</span>(TargetActor);</span><br><span class="line">	<span class="comment">//生成游戏效果上下文</span></span><br><span class="line">	FGameplayEffectContextHandle EffectContextHandle = TargetASC-&gt;<span class="built_in">MakeEffectContext</span>();</span><br><span class="line">	<span class="comment">//设置游戏效果上下文的源对象</span></span><br><span class="line">	EffectContextHandle.<span class="built_in">AddSourceObject</span>(<span class="keyword">this</span>);</span><br><span class="line">	<span class="comment">//生成游戏效果规格</span></span><br><span class="line">	<span class="type">const</span> FGameplayEffectSpecHandle EffectSpecHandle = TargetASC-&gt;<span class="built_in">MakeOutgoingSpec</span>(GameplayEffectClass, <span class="number">1.f</span>, EffectContextHandle);</span><br><span class="line">	<span class="comment">//将游戏效果规格应用到目标对象上</span></span><br><span class="line">	TargetASC-&gt;<span class="built_in">ApplyGameplayEffectSpecToSelf</span>(*EffectSpecHandle.Data.<span class="built_in">Get</span>());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Gameplay-Effect-游戏效果"><a href="#Gameplay-Effect-游戏效果" class="headerlink" title="Gameplay Effect 游戏效果"></a>Gameplay Effect 游戏效果</h3><ul>
<li><p>GEComponents 这个组件主要是在GameplayEffect激活时，可以向目标添加的GameplayAbility</p>
<table>
<thead>
<tr>
<th>名称</th>
<th>效果</th>
</tr>
</thead>
<tbody><tr>
<td><strong>Abilities Gameplay Effect component</strong></td>
<td>这个组件主要是在GameplayEffect激活时，可以向目标添加的GameplayAbility</td>
</tr>
<tr>
<td><strong>Addtional Effects Gameplay Effect Component</strong></td>
<td>当此效果添加时或完成时，需要额外添加的效果。<br/>On Appliaciton Gameplay Effects 在添加此效果时，额外添加的效果<br/>On Complete Always 当此效果完成时，不管正常结束还是不正常结束时，添加的效果<br/>On Complete Normal 当此效果正常结束时，添加的额外的效果<br/>On Complete Prematurely 当此效果提前结束时，添加的额外的效果<br/></td>
</tr>
<tr>
<td><strong>Asset Tags Gameplay Effect Component</strong></td>
<td>在添加此GE时，需要额外处理的标签（添加 和 删除），这个标签将放置在GE上面，只是作为一个GE的标记</td>
</tr>
<tr>
<td><strong>Block Ability Tags Gameplay Component</strong></td>
<td>添加或删除能够阻挡技能的Tags的组件，这些Tags会在GE运行时添加到Actor身上，用于阻挡其它拥有此Tag的GE或者GA的激活。</td>
</tr>
<tr>
<td><strong>Chance to Apply Gameplay Effect Component</strong></td>
<td>当前GE应用到Actor身上的几率，0为百分之0几率，1为百分之百几率</td>
</tr>
<tr>
<td><strong>Custom Can Apply Gameplay Effect Component</strong></td>
<td>自定义能够应用GE的组件，可以自定义条件来设置应用是否成功。</td>
</tr>
<tr>
<td><strong>Gameplay Effect UIData Text Only</strong></td>
<td>用于配置GE的UI信息，这里只有一个简单的TEXT，有需要的可以派生UGameplayEffectUIData类去添加自己需要的数据信息</td>
</tr>
<tr>
<td><strong>Immunity Gameplay Effect Component</strong></td>
<td>配置角色免疫其它GE的条件</td>
</tr>
<tr>
<td><strong>Remove Other Gameplay Effect Component</strong></td>
<td>配置移除其它的GE，满足设置的标签或者资源满足条件的GE都会被移除掉</td>
</tr>
<tr>
<td><strong>Target Tag Requirements Gameplay Effect Component</strong></td>
<td>根据目标的Tag设置当前的GE的状态<br/>Appliaction 为GE添加到目标身上时Tag的状态<br/>Ongoing 为GE激活时Tag的状态<br/>Removal 为GE被删除时Tag的状态</td>
</tr>
<tr>
<td><strong>Target Tags Gameplay Effect Component</strong></td>
<td>添加此GE后，对Actor身上带有的Tag进行操作（添加或删除），这个会随着GE的添加修改，在GE失效时移除。非Instant使用</td>
</tr>
</tbody></table>
</li>
</ul>
<h3 id="Gameplay-Cues-游戏提示"><a href="#Gameplay-Cues-游戏提示" class="headerlink" title="Gameplay Cues  游戏提示"></a>Gameplay Cues  游戏提示</h3><h3 id="Stackong-堆叠"><a href="#Stackong-堆叠" class="headerlink" title="Stackong 堆叠"></a>Stackong 堆叠</h3><ul>
<li><p><strong>Stack Duration Refresh Policy</strong> 叠加效果时，是否更新持续时间 Duration<br>Refresh on Successfull Application： 叠加效果时，刷新持续时间，即使层数不增加也会更新。<br>Never Refresh： 即使叠加效果，也不会刷新。</p>
</li>
<li><p><strong>Stack Period Reset Policy</strong> 叠加效果时，是否更新周期时间 Period<br>Refresh on Successfull Application：叠加效果时，每次都会更新周期时间 Period<br>Never Refresh： 即使叠加效果，也不会刷新</p>
</li>
<li><p><strong>Stack Expiration Policy</strong></p>
<p>Clear Entire Stack:Duration结束时清楚所有层数<br>Remove Single Stack And Refresh Duration：Duration结束时减少一层，然后重新经历一个Duration，一直持续到层数减为0<br>Refresh Duration：Duration结束时再次刷新Duration，这相当于无限Duration，可以通过调用</p>
</li>
<li><p><strong>Overflow</strong></p>
<p>OverflowEffects：超过StackLimitCount数量的Effect被Apply时将会调用该OverflowEffects，可以设置多个<br>DenyOverflowApplication：对应于StackDurationRefreshPolicy，如果为True则多余的Apply不会刷新Duration<br>ClearStackOnOverflow：当DenyOverflowApplication为True是才有效，当Overflow时是否直接删除所有层数</p>
</li>
</ul>
<h1 id="GE-MMC"><a href="#GE-MMC" class="headerlink" title="GE-MMC"></a>GE-MMC</h1><ul>
<li>通过等级更新玩家属性,MMC在GE效果类修改数值里设置,效果为覆盖</li>
</ul>
<ol>
<li>首先，玩家角色的等级需要创建在PlayerState里面，如果玩家角色Actor被销毁掉，等级信息也能够被保存下来</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">UPROPERTY</span>(VisibleAnywhere, ReplicatedUsing=OnRep_Level)</span><br><span class="line">int32 Level;</span><br></pre></td></tr></table></figure>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">UFUNCTION</span>()</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">OnRep_Level</span><span class="params">(int32 OldLevel)</span></span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">APlayerStateBase::OnRep_Level</span><span class="params">(int32 OldLevel)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">// GAMEPLAYATTRIBUTE_REPNOTIFY(UAttributeSetBase, Level, OldLevel);</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//服务器同步</span></span><br><span class="line"><span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">GetLifetimeReplicatedProps</span><span class="params">(TArray&lt;FLifetimeProperty&gt;&amp; OutLifetimeProps)</span> <span class="type">const</span> <span class="keyword">override</span></span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//等级获取函数,声明在玩家状态里</span></span><br><span class="line"><span class="function">FORCEINLINE int32 <span class="title">GetPlayerLevel</span><span class="params">()</span> <span class="type">const</span> </span>&#123;<span class="keyword">return</span> Level;&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//DOREPLIFETIME</span></span><br><span class="line"><span class="comment">//DOREPLIFETIME_CONDITION</span></span><br><span class="line"><span class="comment">//DOREPLIFETIME_CONDITION_NOTIFY</span></span><br><span class="line"><span class="comment">//它们三种是一次递进的，</span></span><br><span class="line"><span class="comment">//第一种就是基础的注册宏，在服务器变化时，会同步所有的客户端，</span></span><br><span class="line"><span class="comment">//第二种增加了CONDITION 也就是条件，条件的参数有多种，按需设置</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">APlayerStateBase::GetLifetimeReplicatedProps</span><span class="params">(TArray&lt;FLifetimeProperty&gt;&amp; OutLifetimeProps)</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	Super::<span class="built_in">GetLifetimeReplicatedProps</span>(OutLifetimeProps);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">DOREPLIFETIME</span>(APlayerStateBase, Level);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//敌人等级	</span></span><br><span class="line"><span class="built_in">UPROPERTY</span>(EditAnywhere, BlueprintReadOnly, Category=<span class="string">&quot;Character Class Defaults&quot;</span>)</span><br><span class="line">int32 Level = <span class="number">1</span>;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>创建接口,用于获取等级的虚函数</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">virtual</span>  int32 <span class="title">GetPlayerLevel</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">int32 <span class="title">ICombatInterface::GetPlayerLevel</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>玩家继承接口并实现&#96;GetPlayerLevel()</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">virtual</span> int32 <span class="title">GetPlayerLevel</span><span class="params">()</span> <span class="keyword">override</span></span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">int32 <span class="title">AHeroCharacter::GetPlayerLevel</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">const</span> APlayerStateBase* PlayerStateBase = <span class="built_in">GetPlayerState</span>&lt;APlayerStateBase&gt;();</span><br><span class="line">	<span class="built_in">check</span>(PlayerStateBase); <span class="comment">//检测是否有效，无限会暂停游戏</span></span><br><span class="line">	<span class="keyword">return</span> PlayerStateBase-&gt;<span class="built_in">GetPlayerLevel</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>敌人实现</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">int32 <span class="title">AEnemyBase::GetPlayerLevel</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> Level;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>用于根据等级配置生命值和魔法值最大值</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Fill out your copyright notice in the Description page of Project Settings.</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> once</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;CoreMinimal.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;GameplayModMagnitudeCalculation.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;MMC_MaxHealth.generated.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">//MMC类(用于通过蓝图或本机代码执行自定义玩法效果修改器计算)</span></span><br><span class="line"><span class="built_in">UCLASS</span>()</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AURADEMO_API</span> UMMC_MaxHealth : <span class="keyword">public</span> UGameplayModMagnitudeCalculation</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">GENERATED_BODY</span>()</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="comment">//构造函数</span></span><br><span class="line">	<span class="built_in">UMMC_MaxHealth</span>();</span><br><span class="line">	<span class="comment">//重写自UGameplayModMagnitudeCalculation,返回计算后的数值</span></span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="type">float</span> <span class="title">CalculateBaseMagnitude_Implementation</span><span class="params">(<span class="type">const</span> FGameplayEffectSpec&amp; Spec)</span> <span class="type">const</span> <span class="keyword">override</span></span>;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="comment">//捕获Vigor属性</span></span><br><span class="line">	FGameplayEffectAttributeCaptureDefinition VigorDef;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Fill out your copyright notice in the Description page of Project Settings.</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;AbilitySystem/ModMagCalc/MMC_MaxHealth.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;AbilitySystem/AuraAttributeSet.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Interface/CombatInterface.h&quot;</span></span></span><br><span class="line"></span><br><span class="line">UMMC_MaxHealth::<span class="built_in">UMMC_MaxHealth</span>()</span><br><span class="line">&#123;</span><br><span class="line">	<span class="comment">// 捕获属性</span></span><br><span class="line">	VigorDef.AttributeToCapture = UAuraAttributeSet::<span class="built_in">GetVigorAttribute</span>(); <span class="comment">//设置需要获取的属性对象</span></span><br><span class="line">	<span class="comment">// 设置源对象 枚举选项，从哪里捕捉游戏效果的游戏属性</span></span><br><span class="line">	VigorDef.AttributeSource = EGameplayEffectAttributeCaptureSource::Target; <span class="comment">//设置拾取对象为GE的应用目标</span></span><br><span class="line">	<span class="comment">//快照模式：当 bSnapshot 设置为 true 时，表示在游戏效果应用时对目标对象的属性进行一次“快照”（即一次性捕获），并将该快照值用于整个游戏效果的持续期间。</span></span><br><span class="line">	<span class="comment">//动态更新：当 bSnapshot 设置为 false 时，表示在游戏效果持续期间，属性值会根据目标对象的实际变化动态更新。</span></span><br><span class="line">	VigorDef.bSnapshot = <span class="literal">false</span>; <span class="comment">//是否应该对属性进行快照</span></span><br><span class="line"></span><br><span class="line">	RelevantAttributesToCapture.<span class="built_in">Add</span>(VigorDef); <span class="comment">//添加到捕获属性数值，只有添加到列表，才会去获取属性值</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">float</span> <span class="title">UMMC_MaxHealth::CalculateBaseMagnitude_Implementation</span><span class="params">(<span class="type">const</span> FGameplayEffectSpec&amp; Spec)</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">//  从 source 和 target 获取 Tag</span></span><br><span class="line">	<span class="type">const</span> FGameplayTagContainer* SourceTags = Spec.CapturedSourceTags.<span class="built_in">GetAggregatedTags</span>();</span><br><span class="line">	<span class="type">const</span> FGameplayTagContainer* TargetTags = Spec.CapturedTargetTags.<span class="built_in">GetAggregatedTags</span>();</span><br><span class="line"></span><br><span class="line">	<span class="comment">//聚合器评估中使用的数据，从调用者/游戏代码中传递</span></span><br><span class="line">	FAggregatorEvaluateParameters EvaluateParameters;</span><br><span class="line">	EvaluateParameters.SourceTags = SourceTags;</span><br><span class="line">	EvaluateParameters.TargetTags = TargetTags;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//获取体力值</span></span><br><span class="line">	<span class="type">float</span> Vigor = <span class="number">0.f</span>;</span><br><span class="line">	<span class="comment">//在CalculateMagnitude调用期间获取属性大小的方便方法</span></span><br><span class="line">	<span class="built_in">GetCapturedAttributeMagnitude</span>(VigorDef, Spec, EvaluateParameters, Vigor);</span><br><span class="line">	Vigor = FMath::<span class="built_in">Max</span>&lt;<span class="type">float</span>&gt;(Vigor, <span class="number">0.f</span>);</span><br><span class="line"></span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 从GE获取上下文再获取对象</span></span><br><span class="line">	ICombatInterface* CombatInterface = <span class="built_in">Cast</span>&lt;ICombatInterface&gt;(Spec.<span class="built_in">GetContext</span>().<span class="built_in">GetSourceObject</span>());</span><br><span class="line">	<span class="comment">//获取等级</span></span><br><span class="line">	<span class="type">const</span> int32 Level = CombatInterface-&gt;<span class="built_in">GetPlayerLevel</span>();</span><br><span class="line"></span><br><span class="line">	<span class="comment">//计算最大血量</span></span><br><span class="line">	<span class="keyword">return</span> <span class="number">80.f</span> + Vigor * <span class="number">2.5f</span> + Level * <span class="number">10.f</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1 id="GAS系统组件事件和回调等"><a href="#GAS系统组件事件和回调等" class="headerlink" title="GAS系统组件事件和回调等"></a>GAS系统组件事件和回调等</h1><ul>
<li><p>添加TAG触发,返回TAG,用于处理捡到物品</p>
</li>
<li><p>添加GE触发,用于刷新血量? AbilitySystemComponent里写</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Fill out your copyright notice in the Description page of Project Settings.</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;AbilitySystem/AuraAbilitySystemComponent.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UAuraAbilitySystemComponent::AbilityActorInfoSet</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">//绑定委托? 当添加效果时调用</span></span><br><span class="line">	OnGameplayEffectAppliedDelegateToSelf.<span class="built_in">AddUObject</span>(<span class="keyword">this</span>, &amp;UAuraAbilitySystemComponent::ClientEffectApplied);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UAuraAbilitySystemComponent::ClientEffectApplied_Implementation</span><span class="params">(UAbilitySystemComponent* AbilitySystemComponent,</span></span></span><br><span class="line"><span class="params"><span class="function">	<span class="type">const</span> FGameplayEffectSpec&amp; EffectSpec, FActiveGameplayEffectHandle ActiveEffectHandle)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	FGameplayTagContainer TagContainer;</span><br><span class="line">	EffectSpec.<span class="built_in">GetAllAssetTags</span>(TagContainer);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//当添加效果时发送委托,参数为标签容器</span></span><br><span class="line">	EffectAssetTags.<span class="built_in">Broadcast</span>(TagContainer);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
<h1 id="GA-技能配置"><a href="#GA-技能配置" class="headerlink" title="GA 技能配置"></a>GA 技能配置</h1><h1 id="Tag标签配置"><a href="#Tag标签配置" class="headerlink" title="Tag标签配置"></a>Tag标签配置</h1><ul>
<li>Aura方案-结构体 UAssetManager在项目设置’’’资源管理器设置’</li>
<li>通过结构体获取单例<code>const FMyGameplayTags&amp; GameplayTags = FMyGameplayTags::Get();</code></li>
<li>副本:改增强输入系统单例</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Fill out your copyright notice in the Description page of Project Settings.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 版权归暮志未晚所有。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> once</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;CoreMinimal.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;GameplayTagContainer.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * GameplayTags 标签 单例模式</span></span><br><span class="line"><span class="comment"> * 内部包含原生的项目中使用的标签</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">FAuraGameplayTags</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">//静态函数,返回标签</span></span><br><span class="line">	<span class="function"><span class="type">static</span> <span class="type">const</span> FAuraGameplayTags&amp; <span class="title">Get</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> GameplayTags; &#125;</span><br><span class="line">	<span class="comment">////用于初始化内部的Tag标签</span></span><br><span class="line">	<span class="function"><span class="type">static</span> <span class="type">void</span> <span class="title">InitializeNativeGameplayTags</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//初始化角色属性GameplayTags</span></span><br><span class="line">	<span class="function"><span class="type">static</span> <span class="type">void</span> <span class="title">InitializeAttributeGameplayTags</span><span class="params">()</span></span>;</span><br><span class="line">	<span class="comment">//初始化输入GameplayTags</span></span><br><span class="line">	<span class="function"><span class="type">static</span> <span class="type">void</span> <span class="title">InitializeInputGameplayTags</span><span class="params">()</span></span>;</span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	 * Primary Attributes</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	FGameplayTag Attributes_Primary_Strength; <span class="comment">//力量</span></span><br><span class="line">	FGameplayTag Attributes_Primary_Intelligence; <span class="comment">//智力</span></span><br><span class="line">	FGameplayTag Attributes_Primary_Resilience; <span class="comment">//韧性</span></span><br><span class="line">	FGameplayTag Attributes_Primary_Vigor; <span class="comment">//体质</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	 * Secondary Attributes</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	FGameplayTag Attributes_Secondary_Armor; <span class="comment">//盔甲</span></span><br><span class="line">	FGameplayTag Attributes_Secondary_ArmorPenetration; <span class="comment">//盔甲穿透</span></span><br><span class="line">	FGameplayTag Attributes_Secondary_BlockChance; <span class="comment">//格挡</span></span><br><span class="line">	FGameplayTag Attributes_Secondary_CriticalHitChance; <span class="comment">//暴击</span></span><br><span class="line">	FGameplayTag Attributes_Secondary_CriticalHitDamage; <span class="comment">//暴击伤害</span></span><br><span class="line">	FGameplayTag Attributes_Secondary_CriticalHitResistance; <span class="comment">//暴击抗性</span></span><br><span class="line">	FGameplayTag Attributes_Secondary_HealthRegeneration; <span class="comment">//生命回复</span></span><br><span class="line">	FGameplayTag Attributes_Secondary_ManaRegeneration; <span class="comment">//法力回复</span></span><br><span class="line">	FGameplayTag Attributes_Secondary_MaxHealth; <span class="comment">//最大生命</span></span><br><span class="line">	FGameplayTag Attributes_Secondary_MaxMana; <span class="comment">//最大法力</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	 *Input</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	FGameplayTag InputTag_LMB; <span class="comment">//鼠标左键</span></span><br><span class="line">	FGameplayTag InputTag_RMB; <span class="comment">//鼠标右键</span></span><br><span class="line">	FGameplayTag InputTag_1; <span class="comment">//1键</span></span><br><span class="line">	FGameplayTag InputTag_2; <span class="comment">//2键</span></span><br><span class="line">	FGameplayTag InputTag_3; <span class="comment">//3键</span></span><br><span class="line">	FGameplayTag InputTag_4; <span class="comment">//4键</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="comment">//属性GameplayTags用于存储单例</span></span><br><span class="line">	<span class="type">static</span> FAuraGameplayTags GameplayTags;</span><br><span class="line">	</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Fill out your copyright notice in the Description page of Project Settings.</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;AbilitySystem/GameplayTags/AuraGameplayTags.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;GameplayTagsManager.h&quot;</span></span></span><br><span class="line"></span><br><span class="line">FAuraGameplayTags FAuraGameplayTags::GameplayTags;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">FAuraGameplayTags::InitializeNativeGameplayTags</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">InitializeAttributeGameplayTags</span>();</span><br><span class="line">	<span class="built_in">InitializeInputGameplayTags</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">FAuraGameplayTags::InitializeAttributeGameplayTags</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">		<span class="comment">/*</span></span><br><span class="line"><span class="comment">	 * Primary Attributes</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	GameplayTags.Attributes_Primary_Strength = UGameplayTagsManager::<span class="built_in">Get</span>().<span class="built_in">AddNativeGameplayTag</span>(</span><br><span class="line">		<span class="built_in">FName</span>(<span class="string">&quot;Attributes.Primary.Strength&quot;</span>),</span><br><span class="line">		<span class="built_in">FString</span>(<span class="string">&quot;Increases physical damage&quot;</span>)</span><br><span class="line">		);</span><br><span class="line"></span><br><span class="line">	GameplayTags.Attributes_Primary_Intelligence = UGameplayTagsManager::<span class="built_in">Get</span>().<span class="built_in">AddNativeGameplayTag</span>(</span><br><span class="line">		<span class="built_in">FName</span>(<span class="string">&quot;Attributes.Primary.Intelligence&quot;</span>),</span><br><span class="line">		<span class="built_in">FString</span>(<span class="string">&quot;Increases magical damage&quot;</span>)</span><br><span class="line">		);</span><br><span class="line"></span><br><span class="line">	GameplayTags.Attributes_Primary_Resilience = UGameplayTagsManager::<span class="built_in">Get</span>().<span class="built_in">AddNativeGameplayTag</span>(</span><br><span class="line">		<span class="built_in">FName</span>(<span class="string">&quot;Attributes.Primary.Resilience&quot;</span>),</span><br><span class="line">		<span class="built_in">FString</span>(<span class="string">&quot;Increases Armor and Armor Penetration&quot;</span>)</span><br><span class="line">		);</span><br><span class="line"></span><br><span class="line">	GameplayTags.Attributes_Primary_Vigor = UGameplayTagsManager::<span class="built_in">Get</span>().<span class="built_in">AddNativeGameplayTag</span>(</span><br><span class="line">		<span class="built_in">FName</span>(<span class="string">&quot;Attributes.Primary.Vigor&quot;</span>),</span><br><span class="line">		<span class="built_in">FString</span>(<span class="string">&quot;Increases Health&quot;</span>)</span><br><span class="line">		);</span><br><span class="line"></span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	 * Secondary Attributes</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	GameplayTags.Attributes_Secondary_Armor = UGameplayTagsManager::<span class="built_in">Get</span>().<span class="built_in">AddNativeGameplayTag</span>(</span><br><span class="line">		<span class="built_in">FName</span>(<span class="string">&quot;Attributes.Secondary.Armor&quot;</span>),</span><br><span class="line">		<span class="built_in">FString</span>(<span class="string">&quot;Reduces damage taken, improves Block Chance&quot;</span>)</span><br><span class="line">		);</span><br><span class="line"></span><br><span class="line">	GameplayTags.Attributes_Secondary_ArmorPenetration = UGameplayTagsManager::<span class="built_in">Get</span>().<span class="built_in">AddNativeGameplayTag</span>(</span><br><span class="line">		<span class="built_in">FName</span>(<span class="string">&quot;Attributes.Secondary.ArmorPenetration&quot;</span>),</span><br><span class="line">		<span class="built_in">FString</span>(<span class="string">&quot;Ignores Percentage of enemy Armor, increases Critical Hit Chance&quot;</span>)</span><br><span class="line">		);</span><br><span class="line"></span><br><span class="line">	GameplayTags.Attributes_Secondary_BlockChance = UGameplayTagsManager::<span class="built_in">Get</span>().<span class="built_in">AddNativeGameplayTag</span>(</span><br><span class="line">		<span class="built_in">FName</span>(<span class="string">&quot;Attributes.Secondary.BlockChance&quot;</span>),</span><br><span class="line">		<span class="built_in">FString</span>(<span class="string">&quot;Chance to cut incoming damage in half&quot;</span>)</span><br><span class="line">		);</span><br><span class="line"></span><br><span class="line">	GameplayTags.Attributes_Secondary_CriticalHitChance = UGameplayTagsManager::<span class="built_in">Get</span>().<span class="built_in">AddNativeGameplayTag</span>(</span><br><span class="line">		<span class="built_in">FName</span>(<span class="string">&quot;Attributes.Secondary.CriticalHitChance&quot;</span>),</span><br><span class="line">		<span class="built_in">FString</span>(<span class="string">&quot;Chance to double damage plus critical hit bonus&quot;</span>)</span><br><span class="line">		);</span><br><span class="line"></span><br><span class="line">	GameplayTags.Attributes_Secondary_CriticalHitDamage = UGameplayTagsManager::<span class="built_in">Get</span>().<span class="built_in">AddNativeGameplayTag</span>(</span><br><span class="line">		<span class="built_in">FName</span>(<span class="string">&quot;Attributes.Secondary.CriticalHitDamage&quot;</span>),</span><br><span class="line">		<span class="built_in">FString</span>(<span class="string">&quot;Bonus damage added when a critical hit is scored&quot;</span>)</span><br><span class="line">		);</span><br><span class="line"></span><br><span class="line">	GameplayTags.Attributes_Secondary_CriticalHitResistance = UGameplayTagsManager::<span class="built_in">Get</span>().<span class="built_in">AddNativeGameplayTag</span>(</span><br><span class="line">		<span class="built_in">FName</span>(<span class="string">&quot;Attributes.Secondary.CriticalHitResistance&quot;</span>),</span><br><span class="line">		<span class="built_in">FString</span>(<span class="string">&quot;Reduces Critical Hit Chance of attacking enemies&quot;</span>)</span><br><span class="line">		);</span><br><span class="line"></span><br><span class="line">	GameplayTags.Attributes_Secondary_HealthRegeneration = UGameplayTagsManager::<span class="built_in">Get</span>().<span class="built_in">AddNativeGameplayTag</span>(</span><br><span class="line">		<span class="built_in">FName</span>(<span class="string">&quot;Attributes.Secondary.HealthRegeneration&quot;</span>),</span><br><span class="line">		<span class="built_in">FString</span>(<span class="string">&quot;Amount of Health regenerated every 1 second&quot;</span>)</span><br><span class="line">		);</span><br><span class="line"></span><br><span class="line">	GameplayTags.Attributes_Secondary_ManaRegeneration = UGameplayTagsManager::<span class="built_in">Get</span>().<span class="built_in">AddNativeGameplayTag</span>(</span><br><span class="line">		<span class="built_in">FName</span>(<span class="string">&quot;Attributes.Secondary.ManaRegeneration&quot;</span>),</span><br><span class="line">		<span class="built_in">FString</span>(<span class="string">&quot;Amount of Mana regenerated every 1 second&quot;</span>)</span><br><span class="line">		);</span><br><span class="line"></span><br><span class="line">	GameplayTags.Attributes_Secondary_MaxHealth = UGameplayTagsManager::<span class="built_in">Get</span>().<span class="built_in">AddNativeGameplayTag</span>(</span><br><span class="line">		<span class="built_in">FName</span>(<span class="string">&quot;Attributes.Secondary.MaxHealth&quot;</span>),</span><br><span class="line">		<span class="built_in">FString</span>(<span class="string">&quot;Maximum amount of Health obtainable&quot;</span>)</span><br><span class="line">		);</span><br><span class="line"></span><br><span class="line">	GameplayTags.Attributes_Secondary_MaxMana = UGameplayTagsManager::<span class="built_in">Get</span>().<span class="built_in">AddNativeGameplayTag</span>(</span><br><span class="line">		<span class="built_in">FName</span>(<span class="string">&quot;Attributes.Secondary.MaxMana&quot;</span>),</span><br><span class="line">		<span class="built_in">FString</span>(<span class="string">&quot;Maximum amount of Mana obtainable&quot;</span>)</span><br><span class="line">		);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">FAuraGameplayTags::InitializeInputGameplayTags</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment"> * Input Tags</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">	GameplayTags.InputTag_LMB = UGameplayTagsManager::<span class="built_in">Get</span>()</span><br><span class="line">.<span class="built_in">AddNativeGameplayTag</span>(</span><br><span class="line">	<span class="built_in">FName</span>(<span class="string">&quot;Attributes.InputTag.LMB&quot;</span>),</span><br><span class="line">	<span class="built_in">FString</span>(<span class="string">&quot;鼠标左键&quot;</span>)</span><br><span class="line">	);</span><br><span class="line">	</span><br><span class="line">	GameplayTags.InputTag_RMB = UGameplayTagsManager::<span class="built_in">Get</span>()</span><br><span class="line">	.<span class="built_in">AddNativeGameplayTag</span>(</span><br><span class="line">		<span class="built_in">FName</span>(<span class="string">&quot;Attributes.InputTag.RMB&quot;</span>),</span><br><span class="line">		<span class="built_in">FString</span>(<span class="string">&quot;鼠标右键&quot;</span>)</span><br><span class="line">		);</span><br><span class="line">	</span><br><span class="line">	GameplayTags.InputTag_1 = UGameplayTagsManager::<span class="built_in">Get</span>()</span><br><span class="line">	.<span class="built_in">AddNativeGameplayTag</span>(</span><br><span class="line">		<span class="built_in">FName</span>(<span class="string">&quot;Attributes.InputTag.1&quot;</span>),</span><br><span class="line">		<span class="built_in">FString</span>(<span class="string">&quot;键盘1键&quot;</span>)</span><br><span class="line">		);</span><br><span class="line">	</span><br><span class="line">	GameplayTags.InputTag_2 = UGameplayTagsManager::<span class="built_in">Get</span>()</span><br><span class="line">	.<span class="built_in">AddNativeGameplayTag</span>(</span><br><span class="line">		<span class="built_in">FName</span>(<span class="string">&quot;Attributes.InputTag.2&quot;</span>),</span><br><span class="line">		<span class="built_in">FString</span>(<span class="string">&quot;键盘2键&quot;</span>)</span><br><span class="line">		);</span><br><span class="line">	</span><br><span class="line">	GameplayTags.InputTag_3 = UGameplayTagsManager::<span class="built_in">Get</span>()</span><br><span class="line">	.<span class="built_in">AddNativeGameplayTag</span>(</span><br><span class="line">		<span class="built_in">FName</span>(<span class="string">&quot;Attributes.InputTag.3&quot;</span>),</span><br><span class="line">		<span class="built_in">FString</span>(<span class="string">&quot;键盘3键&quot;</span>)</span><br><span class="line">		);</span><br><span class="line">	</span><br><span class="line">	GameplayTags.InputTag_4 = UGameplayTagsManager::<span class="built_in">Get</span>()</span><br><span class="line">	.<span class="built_in">AddNativeGameplayTag</span>(</span><br><span class="line">		<span class="built_in">FName</span>(<span class="string">&quot;Attributes.InputTag.4&quot;</span>),</span><br><span class="line">		<span class="built_in">FString</span>(<span class="string">&quot;键盘4键&quot;</span>)</span><br><span class="line">		);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Fill out your copyright notice in the Description page of Project Settings.</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> once</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;CoreMinimal.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Engine/AssetManager.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;AuraAssetManager.generated.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="built_in">UCLASS</span>()</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AURADEMO_API</span> UAuraAssetManager : <span class="keyword">public</span> UAssetManager</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">GENERATED_BODY</span>()</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">//获取资源管理器</span></span><br><span class="line">	<span class="function"><span class="type">static</span> UAuraAssetManager&amp; <span class="title">Get</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">StartInitialLoading</span><span class="params">()</span> <span class="keyword">override</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Fill out your copyright notice in the Description page of Project Settings.</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;AbilitySystem/GameplayTags/AuraAssetManager.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;AbilitySystem/GameplayTags/AuraGameplayTags.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function">UAuraAssetManager&amp; <span class="title">UAuraAssetManager::Get</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">check</span>(GEngine);</span><br><span class="line">	UAuraAssetManager* MyAssetManager = <span class="built_in">Cast</span>&lt;UAuraAssetManager&gt;(GEngine-&gt;AssetManager);</span><br><span class="line">	<span class="keyword">return</span> *MyAssetManager;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UAuraAssetManager::StartInitialLoading</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">//初始化gameplay tags</span></span><br><span class="line">	FAuraGameplayTags::<span class="built_in">InitializeNativeGameplayTags</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h1 id="声明"><a href="#声明" class="headerlink" title="声明"></a>声明</h1><h2 id="TAGS-声明"><a href="#TAGS-声明" class="headerlink" title="TAGS 声明"></a>TAGS 声明</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">UPROPERTY</span>(EditDefaultsOnly)</span><br><span class="line">FGameplayTag PassiveSpellTag; </span><br></pre></td></tr></table></figure>

<h1 id="AI行为树"><a href="#AI行为树" class="headerlink" title="AI行为树"></a>AI行为树</h1><ul>
<li><p>需要蓝图类:AI控制器,行为树,黑板,任务</p>
</li>
<li><p>添加导航区域</p>
</li>
<li><p>创建AI控制器</p>
</li>
<li><p>打开角色蓝图选择AI控制器</p>
</li>
<li><p>创建行为树</p>
</li>
<li><p>AI控制器执行行为树(开始执行非循环)</p>
</li>
<li><p>行为树添加序列执行</p>
</li>
<li><p>添加计时</p>
</li>
<li><p>添加移动至</p>
</li>
<li><p>添加倒计时</p>
</li>
<li><p>创建黑板(声明变量的)比如向量</p>
</li>
<li><p>创建任务(负责写逻辑)比如获取玩家位置,将黑板值设置为向量</p>
</li>
</ul>
<h1 id="UE开发测试"><a href="#UE开发测试" class="headerlink" title="UE开发测试"></a>UE开发测试</h1><h2 id="角色移动"><a href="#角色移动" class="headerlink" title="角色移动"></a>角色移动</h2><ul>
<li>基础第三人称蓝图设置<ul>
<li>角色移动节点:旋转朝向移动打开</li>
<li>弹簧臂组件:pawn控制旋转打开</li>
<li>玩家关闭使用控制器旋转yaw</li>
</ul>
</li>
<li>增强输入<ul>
<li>引入控制器调用事件,判断控制器,添加增强输入,添加输入映射上下文</li>
<li>移动:获取控制器旋转,获取向前向量,添加移动输入</li>
<li>鼠标:添加pawn输入,添加PAW输入</li>
</ul>
</li>
</ul>
<h2 id="模型资产"><a href="#模型资产" class="headerlink" title="模型资产"></a>模型资产</h2><ul>
<li>玩家</li>
<li>怪物</li>
<li>武器:剑,刀,枪—</li>
<li>子弹</li>
<li>树</li>
<li>草</li>
</ul>
<h1 id="能力系统"><a href="#能力系统" class="headerlink" title="能力系统"></a>能力系统</h1><ul>
<li>能力组件添加函数,用于通过数组学习技能</li>
<li>玩家组件添加能力数组属性,用于 设置玩家要学习的技能</li>
</ul>
<h2 id="配置增强输入"><a href="#配置增强输入" class="headerlink" title="配置增强输入"></a>配置增强输入</h2><p>+　创建DataAsset类,文件夹input,然后创建资产文件给控制器(控制器需要声明)</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">pragma</span> once</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;CoreMinimal.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;GameplayTagContainer.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Engine/DataAsset.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;InputConfig.generated.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="built_in">USTRUCT</span>(BlueprintType)</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">FInputActionStruct</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">GENERATED_BODY</span>()</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UPROPERTY</span>(EditDefaultsOnly)</span><br><span class="line">	<span class="type">const</span> <span class="keyword">class</span> <span class="title class_">UInputAction</span>* InputAction = <span class="literal">nullptr</span>;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UPROPERTY</span>(EditDefaultsOnly)</span><br><span class="line">	FGameplayTag InputTag = <span class="built_in">FGameplayTag</span>();</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">UCLASS</span>(BlueprintType,Blueprintable)</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AURADEMO_API</span> UInputConfig : <span class="keyword">public</span> UDataAsset</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">GENERATED_BODY</span>()</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">UPROPERTY</span>(EditDefaultsOnly, BlueprintReadOnly)</span><br><span class="line">	TArray&lt;FInputActionStruct&gt; AbilityInputActions;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="type">const</span> UInputAction* <span class="title">FindAbilityInputActionForTag</span><span class="params">(<span class="type">const</span> FGameplayTag&amp; InputTag, <span class="type">bool</span> bLogNotFound = <span class="literal">false</span>)</span> <span class="type">const</span></span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Input/InputConfig.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">const</span> UInputAction* <span class="title">UInputConfig::FindAbilityInputActionForTag</span><span class="params">(<span class="type">const</span> FGameplayTag&amp; InputTag, <span class="type">bool</span> bLogNotFound)</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">const</span> FInputActionStruct&amp; Action : AbilityInputActions)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span>(Action.InputAction &amp;&amp; Action.InputTag == InputTag)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">return</span> Action.InputAction;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>(bLogNotFound)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">UE_LOG</span>(LogTemp, Error, <span class="built_in">TEXT</span>(<span class="string">&quot;无法从InputConfig[%s]中找到InputTag[%s]对应的技能InputAction&quot;</span>), *<span class="built_in">GetNameSafe</span>(<span class="keyword">this</span>), *InputTag.<span class="built_in">ToString</span>());</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>增强输入系统基类,项目设置:默认组件输入</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">pragma</span> once</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;CoreMinimal.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;EnhancedInputComponent.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;InputConfig.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;InputComponentBase.generated.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">UCLASS</span>(ClassGroup=(Custom), meta=(BlueprintSpawnableComponent))</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AURADEMO_API</span> UInputComponentBase : <span class="keyword">public</span> UEnhancedInputComponent</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">GENERATED_BODY</span>()</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> UserClass, <span class="keyword">typename</span> PressedFuncType, <span class="keyword">typename</span> ReleasedFuncType, <span class="keyword">typename</span> HoldFuncType&gt;</span></span><br><span class="line"><span class="function">	<span class="type">void</span> <span class="title">BindAbilityAction</span><span class="params">(<span class="type">const</span> UInputConfig* InputConfig, UserClass* Object, PressedFuncType PressedFunc, ReleasedFuncType ReleasedFunc, HoldFuncType HoldFunc)</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Input/InputComponentBase.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Sets default values for this component&#x27;s properties</span></span><br><span class="line">UInputComponentBase::<span class="built_in">UInputComponentBase</span>()</span><br><span class="line">&#123;</span><br><span class="line">	<span class="comment">// Set this component to be initialized when the game starts, and to be ticked every frame.  You can turn these features</span></span><br><span class="line">	<span class="comment">// off to improve performance if you don&#x27;t need them.</span></span><br><span class="line">	PrimaryComponentTick.bCanEverTick = <span class="literal">true</span>;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">UserClass</span>, <span class="keyword">typename</span> PressedFuncType, <span class="keyword">typename</span> ReleasedFuncType, <span class="keyword">typename</span> HoldFuncType&gt;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UInputComponentBase::BindAbilityAction</span><span class="params">(<span class="type">const</span> UInputConfig* InputConfig, UserClass* Object,</span></span></span><br><span class="line"><span class="params"><span class="function">	PressedFuncType PressedFunc, ReleasedFuncType ReleasedFunc, HoldFuncType HoldFunc)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">check</span>(InputConfig);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(<span class="type">const</span> FInputActionStruct&amp; Action : InputConfig-&gt;AbilityInputActions)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span>(Action.InputAction &amp;&amp; Action.InputTag.<span class="built_in">IsValid</span>())</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span>(PressedFunc)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="built_in">BindAction</span>(Action.InputAction, ETriggerEvent::Started, Object, PressedFunc, Action.InputTag);</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">			<span class="keyword">if</span>(HoldFunc)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="built_in">BindAction</span>(Action.InputAction, ETriggerEvent::Triggered, Object, HoldFunc, Action.InputTag);</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(ReleasedFunc)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="built_in">BindAction</span>(Action.InputAction, ETriggerEvent::Completed, Object, ReleasedFunc, Action.InputTag);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="创建技能基类"><a href="#创建技能基类" class="headerlink" title="创建技能基类"></a>创建技能基类</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">pragma</span> once</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;CoreMinimal.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Abilities/GameplayAbility.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;GamePlayAbilityBase.generated.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="built_in">UCLASS</span>()</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AURADEMO_API</span> UGamePlayAbilityBase : <span class="keyword">public</span> UGameplayAbility</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">GENERATED_BODY</span>()</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">//技能输入Tag,通过这个tag触发对于技能 </span></span><br><span class="line">	<span class="built_in">UPROPERTY</span>(EditDefaultsOnly, Category=<span class="string">&quot;Input&quot;</span>)</span><br><span class="line">	FGameplayTag StartupInputTag;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="添加输入Tag-可以换其他方法"><a href="#添加输入Tag-可以换其他方法" class="headerlink" title="添加输入Tag,可以换其他方法"></a>添加输入Tag,可以换其他方法</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">FGameplayTag InputTag_LMB; <span class="comment">//鼠标左键</span></span><br><span class="line">FGameplayTag InputTag_RMB; <span class="comment">//鼠标右键</span></span><br><span class="line">FGameplayTag InputTag_1; <span class="comment">//1键</span></span><br><span class="line">FGameplayTag InputTag_2; <span class="comment">//2键</span></span><br><span class="line">FGameplayTag InputTag_3; <span class="comment">//3键</span></span><br><span class="line">FGameplayTag InputTag_4; <span class="comment">//4键</span></span><br></pre></td></tr></table></figure>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">FMyGameplayTags::InitializeInputGameplayTags</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	GameplayTags.InputTag_LMB = UGameplayTagsManager::<span class="built_in">Get</span>()</span><br><span class="line">	.<span class="built_in">AddNativeGameplayTag</span>(</span><br><span class="line">		<span class="built_in">FName</span>(<span class="string">&quot;Attributes.InputTag.LMB&quot;</span>),</span><br><span class="line">		<span class="built_in">FString</span>(<span class="string">&quot;鼠标左键&quot;</span>)</span><br><span class="line">		);</span><br><span class="line">	</span><br><span class="line">	GameplayTags.InputTag_RMB = UGameplayTagsManager::<span class="built_in">Get</span>()</span><br><span class="line">	.<span class="built_in">AddNativeGameplayTag</span>(</span><br><span class="line">		<span class="built_in">FName</span>(<span class="string">&quot;Attributes.InputTag.RMB&quot;</span>),</span><br><span class="line">		<span class="built_in">FString</span>(<span class="string">&quot;鼠标右键&quot;</span>)</span><br><span class="line">		);</span><br><span class="line">	</span><br><span class="line">	GameplayTags.InputTag_1 = UGameplayTagsManager::<span class="built_in">Get</span>()</span><br><span class="line">	.<span class="built_in">AddNativeGameplayTag</span>(</span><br><span class="line">		<span class="built_in">FName</span>(<span class="string">&quot;Attributes.InputTag.1&quot;</span>),</span><br><span class="line">		<span class="built_in">FString</span>(<span class="string">&quot;键盘1键&quot;</span>)</span><br><span class="line">		);</span><br><span class="line">	</span><br><span class="line">	GameplayTags.InputTag_2 = UGameplayTagsManager::<span class="built_in">Get</span>()</span><br><span class="line">	.<span class="built_in">AddNativeGameplayTag</span>(</span><br><span class="line">		<span class="built_in">FName</span>(<span class="string">&quot;Attributes.InputTag.2&quot;</span>),</span><br><span class="line">		<span class="built_in">FString</span>(<span class="string">&quot;键盘2键&quot;</span>)</span><br><span class="line">		);</span><br><span class="line">	</span><br><span class="line">	GameplayTags.InputTag_3 = UGameplayTagsManager::<span class="built_in">Get</span>()</span><br><span class="line">	.<span class="built_in">AddNativeGameplayTag</span>(</span><br><span class="line">		<span class="built_in">FName</span>(<span class="string">&quot;Attributes.InputTag.3&quot;</span>),</span><br><span class="line">		<span class="built_in">FString</span>(<span class="string">&quot;键盘3键&quot;</span>)</span><br><span class="line">		);</span><br><span class="line">	</span><br><span class="line">	GameplayTags.InputTag_4 = UGameplayTagsManager::<span class="built_in">Get</span>()</span><br><span class="line">	.<span class="built_in">AddNativeGameplayTag</span>(</span><br><span class="line">		<span class="built_in">FName</span>(<span class="string">&quot;Attributes.InputTag.4&quot;</span>),</span><br><span class="line">		<span class="built_in">FString</span>(<span class="string">&quot;键盘4键&quot;</span>)</span><br><span class="line">		);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="控制器调用"><a href="#控制器调用" class="headerlink" title="控制器调用"></a>控制器调用</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">UPROPERTY</span>(EditDefaultsOnly, Category=<span class="string">&quot;Input&quot;</span>)</span><br><span class="line">TObjectPtr&lt;UInputConfig&gt; InputConfig;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">AbilityInputTagPressed</span><span class="params">(FGameplayTag InputTag)</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">AbilityInputTagReleased</span><span class="params">(FGameplayTag InputTag)</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">AbilityInputTagHold</span><span class="params">(FGameplayTag InputTag)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//获取能力组件,后期调用技能</span></span><br><span class="line"><span class="built_in">UPROPERTY</span>()</span><br><span class="line">TObjectPtr&lt;UAuraAbilitySystemComponent&gt; AbilitySystemComponentBase;</span><br><span class="line"><span class="function">UAuraAbilitySystemComponent* <span class="title">GetASC</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">AAuraPlayerController::AbilityInputTagPressed</span><span class="params">(FGameplayTag InputTag)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	GEngine-&gt;<span class="built_in">AddOnScreenDebugMessage</span>(<span class="number">1</span>, <span class="number">3.f</span>, FColor::Red, *InputTag.<span class="built_in">ToString</span>());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">AAuraPlayerController::AbilityInputTagReleased</span><span class="params">(FGameplayTag InputTag)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	GEngine-&gt;<span class="built_in">AddOnScreenDebugMessage</span>(<span class="number">2</span>, <span class="number">3.f</span>, FColor::Blue, *InputTag.<span class="built_in">ToString</span>());</span><br><span class="line">	<span class="keyword">if</span>(<span class="built_in">GetASC</span>() == <span class="literal">nullptr</span>) <span class="keyword">return</span>;</span><br><span class="line">	<span class="built_in">GetASC</span>()-&gt;<span class="built_in">AbilityInputTagReleased</span>(InputTag);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">AAuraPlayerController::AbilityInputTagHold</span><span class="params">(FGameplayTag InputTag)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	GEngine-&gt;<span class="built_in">AddOnScreenDebugMessage</span>(<span class="number">3</span>, <span class="number">3.f</span>, FColor::Yellow, *InputTag.<span class="built_in">ToString</span>());</span><br><span class="line">	<span class="keyword">if</span>(<span class="built_in">GetASC</span>() == <span class="literal">nullptr</span>) <span class="keyword">return</span>;</span><br><span class="line">	<span class="built_in">GetASC</span>()-&gt;<span class="built_in">AbilityInputTagHold</span>(InputTag);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//获取能力组件</span></span><br><span class="line"><span class="function">UAuraAbilitySystemComponent* <span class="title">AAuraPlayerController::GetASC</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(AbilitySystemComponentBase == <span class="literal">nullptr</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		AbilitySystemComponentBase = <span class="built_in">Cast</span>&lt;UAuraAbilitySystemComponent&gt;(UAbilitySystemBlueprintLibrary::<span class="built_in">GetAbilitySystemComponent</span>(<span class="built_in">GetPawn</span>()));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> AbilitySystemComponentBase;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="能力组件"><a href="#能力组件" class="headerlink" title="能力组件"></a>能力组件</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//技能</span></span><br><span class="line"><span class="comment">//传入技能数组并学习</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">AddCharacterAbilities</span><span class="params">(<span class="type">const</span> TArray&lt;TSubclassOf&lt;UGameplayAbility&gt;&gt;&amp; StartupAbilities)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//激活事件</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">AbilityInputTagHold</span><span class="params">(<span class="type">const</span> FGameplayTag&amp; InputTag)</span></span>;</span><br><span class="line"><span class="comment">//取消事件</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">AbilityInputTagReleased</span><span class="params">(<span class="type">const</span> FGameplayTag&amp; InputTag)</span></span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">UAuraAbilitySystemComponent::AddCharacterAbilities</span><span class="params">(<span class="type">const</span> TArray&lt;TSubclassOf&lt;UGameplayAbility&gt;&gt;&amp; StartupAbilities)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">const</span> TSubclassOf&lt;UGameplayAbility&gt; AbilityClass : StartupAbilities)</span><br><span class="line">	&#123;</span><br><span class="line">		FGameplayAbilitySpec AbilitySpec = <span class="built_in">FGameplayAbilitySpec</span>(AbilityClass, <span class="number">1</span>);</span><br><span class="line">		<span class="keyword">if</span>(<span class="type">const</span> UGamePlayAbilityBase* AbilityBase = <span class="built_in">Cast</span>&lt;UGamePlayAbilityBase&gt;(AbilitySpec.Ability))</span><br><span class="line">		&#123;</span><br><span class="line">			AbilitySpec.DynamicAbilityTags.<span class="built_in">AddTag</span>(AbilityBase-&gt;StartupInputTag);</span><br><span class="line">			<span class="built_in">GiveAbility</span>(AbilitySpec); <span class="comment">//只应用不激活</span></span><br><span class="line">			<span class="comment">// GiveAbilityAndActivateOnce(AbilitySpec); //应用技能并激活一次</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UAuraAbilitySystemComponent::AbilityInputTagHold</span><span class="params">(<span class="type">const</span> FGameplayTag&amp; InputTag)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(!InputTag.<span class="built_in">IsValid</span>()) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">auto</span> AbilitySpec : <span class="built_in">GetActivatableAbilities</span>())</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span>(AbilitySpec.DynamicAbilityTags.<span class="built_in">HasTagExact</span>(InputTag))</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">AbilitySpecInputPressed</span>(AbilitySpec);</span><br><span class="line">			<span class="keyword">if</span>(!AbilitySpec.<span class="built_in">IsActive</span>())</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="built_in">TryActivateAbility</span>(AbilitySpec.Handle);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UAuraAbilitySystemComponent::AbilityInputTagReleased</span><span class="params">(<span class="type">const</span> FGameplayTag&amp; InputTag)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(!InputTag.<span class="built_in">IsValid</span>()) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">auto</span> AbilitySpec : <span class="built_in">GetActivatableAbilities</span>())</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span>(AbilitySpec.DynamicAbilityTags.<span class="built_in">HasTagExact</span>(InputTag))</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">AbilitySpecInputReleased</span>(AbilitySpec);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="https://luojiangbao015.github.io">John Doe</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="https://luojiangbao015.github.io/2024/03/30/ue5/%E5%8F%98%E9%87%8F/GAS%E7%B3%BB%E7%BB%9F/">https://luojiangbao015.github.io/2024/03/30/ue5/%E5%8F%98%E9%87%8F/GAS%E7%B3%BB%E7%BB%9F/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles on this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless otherwise stated.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/auraea/tags/%E5%AD%A6%E4%B9%A0/">学习</a><a class="post-meta__tags" href="/auraea/tags/%E5%8F%98%E9%87%8F/">变量</a></div><div class="post-share"><div class="social-share" data-image="/auraea/img/ww/D002.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/auraea/2024/03/30/ue5/%E5%8F%98%E9%87%8F/API/" title="ue5API"><img class="cover" src="/auraea/img/ww/D001.png" onerror="onerror=null;src='/auraea/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">Previous</div><div class="info-item-2">ue5API</div></div><div class="info-2"><div class="info-item-1">​                                                                                                                                                                                                                                                                                                                                                                                                                                                                         组件##...</div></div></div></a><a class="pagination-related" href="/auraea/2024/03/30/ue5/%E5%8F%98%E9%87%8F/%E6%A8%A1%E6%9D%BF/" title="ue5模板"><img class="cover" src="/auraea/img/ww/D003.png" onerror="onerror=null;src='/auraea/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">Next</div><div class="info-item-2">ue5模板</div></div><div class="info-2"><div class="info-item-1">\img\抽象工厂模式.png行为树怪物实时移动向玩家 </div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/auraea/2024/03/30/unity/%E6%80%AA%E7%89%A9%E8%B7%9F%E8%B8%AA%E7%8E%A9%E5%AE%B6/" title="怪物追玩家"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-03-30</div><div class="info-item-2">怪物追玩家</div></div><div class="info-2"><div class="info-item-1">怪物跟踪算法123456789101112void Update()    &#123;        if (player != null)          &#123;              // 计算怪物和玩家之间的方向向量              Vector2 向量= (玩家.position - transform.position).normalized;              // 移动怪物              transform.Translate(direction * 速度* Time.deltaTime);          &#125;      &#125; </div></div></div></a><a class="pagination-related" href="/auraea/2024/03/30/ue5/%E5%8F%98%E9%87%8F/AGS%E8%AF%BE%E7%A8%8B/" title="AGS课程笔记"><img class="cover" src="/auraea/img/ww/D004.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-03-30</div><div class="info-item-2">AGS课程笔记</div></div><div class="info-2"><div class="info-item-1">​                                                                                                                                                                                                                                                                                                                                                                                                                                                                       ...</div></div></div></a><a class="pagination-related" href="/auraea/2024/03/30/ue5/%E5%8F%98%E9%87%8F/API/" title="ue5API"><img class="cover" src="/auraea/img/ww/D001.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-03-30</div><div class="info-item-2">ue5API</div></div><div class="info-2"><div class="info-item-1">​                                                                                                                                                                                                                                                                                                                                                                                                                                                                         组件##...</div></div></div></a><a class="pagination-related" href="/auraea/2024/03/30/ue5/%E5%8F%98%E9%87%8F/%E6%A8%A1%E6%9D%BF/" title="ue5模板"><img class="cover" src="/auraea/img/ww/D003.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-03-30</div><div class="info-item-2">ue5模板</div></div><div class="info-2"><div class="info-item-1">\img\抽象工厂模式.png行为树怪物实时移动向玩家 </div></div></div></a><a class="pagination-related" href="/auraea/2025/03/14/cpp/cpp%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" title="cpp数据结构"><img class="cover" src="https://img2.imgtp.com/2024/03/29/CuFHenMA.webp" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-03-14</div><div class="info-item-2">cpp数据结构</div></div><div class="info-2"><div class="info-item-1">结构线性表   方法     初始化init()    头插insertAtHead(int vale)    尾插insertAtTail(int vale)    删除指定元素deletenode(int vale)    遍历输出printList()    析构LinkedList()    线性表数组1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192#include&lt;bits/stdc++.h&gt;using namespace std;const int N = 10;    //最大容量为10int res[N + 1];    //存储元素,下标从1开始int cnt = 0;    //数组指针，也表示当前元素数量//插入元素void...</div></div></div></a><a class="pagination-related" href="/auraea/2025/03/14/cpp/cpp%E6%A8%A1%E6%9D%BF/" title="cpp模板"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-03-14</div><div class="info-item-2">cpp模板</div></div><div class="info-2"><div class="info-item-1">Git 拉取 1git clone 链接  修改  添加 1git add .  检查 1git status  提交 1git commit -m &quot;input yours message&quot;  推送 1git push origin main  </div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/auraea/img/butterfly-icon.png" onerror="this.onerror=null;this.src='/auraea/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">John Doe</div><div class="author-info-description"></div><div class="site-data"><a href="/auraea/archives/"><div class="headline">Articles</div><div class="length-num">36</div></a><a href="/auraea/tags/"><div class="headline">Tags</div><div class="length-num">3</div></a><a href="/auraea/categories/"><div class="headline">Categories</div><div class="length-num">6</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Build-cs"><span class="toc-number">1.</span> <span class="toc-text">Build.cs</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%98%E6%96%B9Tga"><span class="toc-number">2.</span> <span class="toc-text">官方Tga</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#AttributeSet-%E5%B1%9E%E6%80%A7%E9%85%8D%E7%BD%AE"><span class="toc-number">3.</span> <span class="toc-text">AttributeSet 属性配置</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%9B%E5%BB%BAAttributeSet-%E7%B1%BB"><span class="toc-number">3.1.</span> <span class="toc-text">创建AttributeSet 类</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BA%90%E7%A0%81%E8%AF%B4%E6%98%8E"><span class="toc-number">3.1.1.</span> <span class="toc-text">源码说明</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9C%A8%E7%8E%A9%E5%AE%B6%E7%B1%BB%E4%B8%AD%E5%88%9D%E5%A7%8B%E5%8C%96"><span class="toc-number">3.2.</span> <span class="toc-text">在玩家类中初始化</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%9D%E5%A7%8B%E5%8C%96%E6%96%B9%E6%B3%95"><span class="toc-number">3.3.</span> <span class="toc-text">初始化方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#API"><span class="toc-number">3.4.</span> <span class="toc-text">API</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%99%9A%E5%87%BD%E6%95%B0"><span class="toc-number">3.4.1.</span> <span class="toc-text">虚函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B1%9E%E6%80%A7%E5%87%BD%E6%95%B0"><span class="toc-number">3.4.2.</span> <span class="toc-text">属性函数</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MVC"><span class="toc-number">4.</span> <span class="toc-text">MVC</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8E%A7%E5%88%B6%E5%B1%82"><span class="toc-number">4.1.</span> <span class="toc-text">控制层</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B4%BE%E7%94%9F%E5%AD%90%E7%B1%BBOverlay"><span class="toc-number">4.1.1.</span> <span class="toc-text">派生子类Overlay</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B4%BE%E7%94%9F%E5%AD%90%E7%B1%BBAttrib"><span class="toc-number">4.1.2.</span> <span class="toc-text">派生子类Attrib</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Widget%E4%BB%A3%E7%A0%81"><span class="toc-number">4.1.3.</span> <span class="toc-text">Widget代码</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HUD%E4%BB%A3%E7%A0%81"><span class="toc-number">4.2.</span> <span class="toc-text">HUD代码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8E%A7%E5%88%B6%E5%B1%82%E4%BB%A3%E7%A0%81"><span class="toc-number">4.3.</span> <span class="toc-text">控制层代码</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E7%B1%BB"><span class="toc-number">4.3.1.</span> <span class="toc-text">基类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%9F%E5%91%BD%E5%80%BC-%E9%AD%94%E6%B3%95%E5%80%BC%E5%AD%90%E7%B1%BB"><span class="toc-number">4.3.2.</span> <span class="toc-text">生命值&#x2F;魔法值子类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B1%9E%E6%80%A7%E9%9B%86"><span class="toc-number">4.3.3.</span> <span class="toc-text">属性集</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8E%A7%E5%88%B6%E5%B1%82%E5%87%BD%E6%95%B0%E5%BA%93%E4%BB%A3%E7%A0%81"><span class="toc-number">4.4.</span> <span class="toc-text">控制层函数库代码</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#GE-%E6%95%88%E6%9E%9C%E9%85%8D%E7%BD%AE"><span class="toc-number">5.</span> <span class="toc-text">GE 效果配置</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE"><span class="toc-number">5.1.</span> <span class="toc-text">配置</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8C%81%E7%BB%AD%E6%97%B6%E9%97%B4"><span class="toc-number">5.1.1.</span> <span class="toc-text">持续时间</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A0%86%E5%8F%A0Stacking"><span class="toc-number">5.1.2.</span> <span class="toc-text">堆叠Stacking</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%A0%E5%8A%A0%E8%A7%A6%E5%8F%91"><span class="toc-number">5.2.</span> <span class="toc-text">叠加触发</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Gameplay-Effect-%E6%B8%B8%E6%88%8F%E6%95%88%E6%9E%9C"><span class="toc-number">5.2.1.</span> <span class="toc-text">Gameplay Effect 游戏效果</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Gameplay-Cues-%E6%B8%B8%E6%88%8F%E6%8F%90%E7%A4%BA"><span class="toc-number">5.2.2.</span> <span class="toc-text">Gameplay Cues  游戏提示</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Stackong-%E5%A0%86%E5%8F%A0"><span class="toc-number">5.2.3.</span> <span class="toc-text">Stackong 堆叠</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#GE-MMC"><span class="toc-number">6.</span> <span class="toc-text">GE-MMC</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#GAS%E7%B3%BB%E7%BB%9F%E7%BB%84%E4%BB%B6%E4%BA%8B%E4%BB%B6%E5%92%8C%E5%9B%9E%E8%B0%83%E7%AD%89"><span class="toc-number">7.</span> <span class="toc-text">GAS系统组件事件和回调等</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#GA-%E6%8A%80%E8%83%BD%E9%85%8D%E7%BD%AE"><span class="toc-number">8.</span> <span class="toc-text">GA 技能配置</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Tag%E6%A0%87%E7%AD%BE%E9%85%8D%E7%BD%AE"><span class="toc-number">9.</span> <span class="toc-text">Tag标签配置</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%A3%B0%E6%98%8E"><span class="toc-number">10.</span> <span class="toc-text">声明</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#TAGS-%E5%A3%B0%E6%98%8E"><span class="toc-number">10.1.</span> <span class="toc-text">TAGS 声明</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#AI%E8%A1%8C%E4%B8%BA%E6%A0%91"><span class="toc-number">11.</span> <span class="toc-text">AI行为树</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#UE%E5%BC%80%E5%8F%91%E6%B5%8B%E8%AF%95"><span class="toc-number">12.</span> <span class="toc-text">UE开发测试</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%92%E8%89%B2%E7%A7%BB%E5%8A%A8"><span class="toc-number">12.1.</span> <span class="toc-text">角色移动</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A8%A1%E5%9E%8B%E8%B5%84%E4%BA%A7"><span class="toc-number">12.2.</span> <span class="toc-text">模型资产</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%83%BD%E5%8A%9B%E7%B3%BB%E7%BB%9F"><span class="toc-number">13.</span> <span class="toc-text">能力系统</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E5%A2%9E%E5%BC%BA%E8%BE%93%E5%85%A5"><span class="toc-number">13.1.</span> <span class="toc-text">配置增强输入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E6%8A%80%E8%83%BD%E5%9F%BA%E7%B1%BB"><span class="toc-number">13.2.</span> <span class="toc-text">创建技能基类</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0%E8%BE%93%E5%85%A5Tag-%E5%8F%AF%E4%BB%A5%E6%8D%A2%E5%85%B6%E4%BB%96%E6%96%B9%E6%B3%95"><span class="toc-number">13.3.</span> <span class="toc-text">添加输入Tag,可以换其他方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8E%A7%E5%88%B6%E5%99%A8%E8%B0%83%E7%94%A8"><span class="toc-number">13.4.</span> <span class="toc-text">控制器调用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%83%BD%E5%8A%9B%E7%BB%84%E4%BB%B6"><span class="toc-number">13.5.</span> <span class="toc-text">能力组件</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Posts</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/auraea/2025/03/14/%E6%B8%B8%E6%88%8F%E8%AE%BE%E8%AE%A1/%E6%B8%B8%E6%88%8F%E8%AE%BE%E8%AE%A1/" title="游戏设计"><img src="/auraea/img/ww/D003.png" onerror="this.onerror=null;this.src='/auraea/img/404.jpg'" alt="游戏设计"/></a><div class="content"><a class="title" href="/auraea/2025/03/14/%E6%B8%B8%E6%88%8F%E8%AE%BE%E8%AE%A1/%E6%B8%B8%E6%88%8F%E8%AE%BE%E8%AE%A1/" title="游戏设计">游戏设计</a><time datetime="2025-03-14T11:39:30.302Z" title="Created 2025-03-14 19:39:30">2025-03-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/auraea/2025/03/14/%E6%9D%82%E9%A1%B9/%E6%B8%B8%E6%88%8F%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/" title="游戏源码解析"><img src="/auraea/img/ww/D003.png" onerror="this.onerror=null;this.src='/auraea/img/404.jpg'" alt="游戏源码解析"/></a><div class="content"><a class="title" href="/auraea/2025/03/14/%E6%9D%82%E9%A1%B9/%E6%B8%B8%E6%88%8F%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/" title="游戏源码解析">游戏源码解析</a><time datetime="2025-03-14T11:39:30.299Z" title="Created 2025-03-14 19:39:30">2025-03-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/auraea/2025/03/14/%E6%9D%82%E9%A1%B9/%E5%B0%8F%E8%AF%B4/" title="怪物猎人伤害"><img src="/auraea/img/ww/D003.png" onerror="this.onerror=null;this.src='/auraea/img/404.jpg'" alt="怪物猎人伤害"/></a><div class="content"><a class="title" href="/auraea/2025/03/14/%E6%9D%82%E9%A1%B9/%E5%B0%8F%E8%AF%B4/" title="怪物猎人伤害">怪物猎人伤害</a><time datetime="2025-03-14T11:39:30.298Z" title="Created 2025-03-14 19:39:30">2025-03-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/auraea/2025/03/14/%E6%9D%82%E9%A1%B9/%E5%B0%8F%E8%AF%B4%20-%20%E5%89%AF%E6%9C%AC/" title="怪物猎人伤害"><img src="/auraea/img/ww/D003.png" onerror="this.onerror=null;this.src='/auraea/img/404.jpg'" alt="怪物猎人伤害"/></a><div class="content"><a class="title" href="/auraea/2025/03/14/%E6%9D%82%E9%A1%B9/%E5%B0%8F%E8%AF%B4%20-%20%E5%89%AF%E6%9C%AC/" title="怪物猎人伤害">怪物猎人伤害</a><time datetime="2025-03-14T11:39:30.296Z" title="Created 2025-03-14 19:39:30">2025-03-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/auraea/2025/03/14/%E6%9D%82%E9%A1%B9/%E4%BC%A4%E5%AE%B3%E8%AE%A1%E7%AE%97/" title="怪物猎人伤害"><img src="/auraea/img/ww/D003.png" onerror="this.onerror=null;this.src='/auraea/img/404.jpg'" alt="怪物猎人伤害"/></a><div class="content"><a class="title" href="/auraea/2025/03/14/%E6%9D%82%E9%A1%B9/%E4%BC%A4%E5%AE%B3%E8%AE%A1%E7%AE%97/" title="怪物猎人伤害">怪物猎人伤害</a><time datetime="2025-03-14T11:39:30.295Z" title="Created 2025-03-14 19:39:30">2025-03-14</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2025 By John Doe</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.3.5</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/auraea/js/utils.js"></script><script src="/auraea/js/main.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>